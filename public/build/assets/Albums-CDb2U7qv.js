import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as o}from"./index-BH53Isel.js";import{c as S}from"./ReactAppend-DTVVXReZ.js";import{B as D}from"./Base-1RG1ZM6q.js";import{C as Y}from"./CreateReactScript-BoGwggCx.js";import{T as M}from"./Table-DitbKwtZ.js";import{D as n}from"./DxButton-DV0H-ZcL.js";import{R as u}from"./ReactAppend-D7S498fx.js";import{S as d}from"./ProductCard-Ap6bpF1Q.js";import{P as R}from"./ProjectsRest-CAc2DcAm.js";import{M as E}from"./Modal-CIqmjseY.js";import{i as B}from"./tippy-react.esm-GxPckcbS.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";import"./Global-ErywZRdd.js";/* empty css              */import"./Logout-7s5dsuEK.js";import"./main-BvVILmTO.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./MenuItemContainer-C_dOKkRB.js";import"./index.esm-DAJ8Pwbk.js";import"./index-xsH4HHeE.js";/* empty css               */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./index-BrXtjC9y.js";const m=new R,F=({statuses:h=[]})=>{const i=o.useRef(),l=o.useRef(),x=o.useRef(),[s,w]=o.useState(null),[c,k]=o.useState(null),[p,f]=o.useState(""),b=async t=>{const{isConfirmed:a}=await d.fire({title:"Eliminar proyecto",text:"¿Estás seguro de eliminar este proyecto?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!a||!await m.delete(t)||$(i.current).dxDataGrid("instance").refresh()},g=async t=>{const a=await m.get(t);w(a.data),$(l.current).modal("show")},j=t=>{window.location.href=`/canvas/editor?project=${t}`},N=async t=>{k(t),f(t.name||""),$(x.current).modal("show")},y=async()=>{if(!c||!p.trim()){d.fire({title:"Error",text:"El nombre del proyecto no puede estar vacío",icon:"error"});return}try{await m.save({id:c.id,name:p.trim()})&&(d.fire({title:"Éxito",text:"Nombre del proyecto actualizado correctamente",icon:"success",timer:2e3}),$(x.current).modal("hide"),$(i.current).dxDataGrid("instance").refresh())}catch{d.fire({title:"Error",text:"No se pudo actualizar el nombre del proyecto",icon:"error"})}},v=t=>{const r={draft:{color:"#fbbf24",text:"Borrador"},completed:{color:"#10b981",text:"Completado"},exported:{color:"#3b82f6",text:"Exportado"},ordered:{color:"#8b5cf6",text:"Pedido realizado"}}[t]||{color:"#6b7280",text:"Desconocido"};return{backgroundColor:`${r.color}20`,color:r.color,text:r.text}},C=t=>t==="draft",P=m;return e.jsxs(e.Fragment,{children:[e.jsx(M,{gridRef:i,title:"Mis Proyectos",rest:P,toolBar:t=>{t.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(i.current).dxDataGrid("instance").refresh()}}),t.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Catálogo",onClick:()=>{window.location.href="/catalogo"}}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Proyecto",width:"300px",cellTemplate:(t,{data:a})=>{t.css("cursor","pointer"),t.on("click",()=>{g(a.id)}),u(t,e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"me-3",children:e.jsx("img",{src:a.thumbnail||"/assets/img/backgrounds/resources/default-image.png",alt:a.name,className:"rounded",style:{width:"50px",height:"50px",objectFit:"cover"},onError:r=>{r.target.src="/assets/img/backgrounds/resources/default-image.png"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 fw-bold",children:a.name||"Proyecto sin título"}),e.jsx("small",{className:"text-muted",children:a.description||"Sin descripción"})]})]}))}},{dataField:"created_at",caption:"Fecha Creación",dataType:"date",sortOrder:"desc",cellTemplate:(t,{data:a})=>{t.text(moment(a.created_at).format("DD/MM/YYYY HH:mm"))}},{dataField:"updated_at",caption:"Última Modificación",dataType:"date",cellTemplate:(t,{data:a})=>{t.text(moment(a.updated_at).format("DD/MM/YYYY HH:mm"))}},{dataField:"status",caption:"Estado",cellTemplate:(t,{data:a})=>{const r=v(a.status);u(t,e.jsx("span",{className:"badge rounded-pill px-3 py-2",style:{backgroundColor:r.backgroundColor,color:r.color,fontSize:"12px"},children:r.text}))}},{caption:"Acciones",cellTemplate:(t,{data:a})=>{const r=C(a.status);t.append(n({className:"btn btn-xs btn-light me-1",title:"Ver proyecto",icon:"fa fa-eye",onClick:()=>g(a.id)})),r?(t.append(n({className:"btn btn-xs btn-success me-1",title:"Ir al editor",icon:"fa fa-palette",onClick:()=>j(a.id)})),t.append(n({className:"btn btn-xs btn-primary me-1",title:"Editar nombre",icon:"fa fa-edit",onClick:()=>N(a)})),t.append(n({className:"btn btn-xs btn-danger",title:"Eliminar proyecto",icon:"fa fa-trash",onClick:()=>b(a.id)}))):u(t,e.jsx(B,{content:"Los proyectos finalizados no se pueden editar o eliminar",children:e.jsx("span",{className:"badge bg-secondary ms-2",children:"Finalizado"})}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(E,{modalRef:l,title:`Detalles del proyecto: ${(s==null?void 0:s.name)||"Sin título"}`,size:"lg",bodyStyle:{backgroundColor:"#ebeff2"},hideButtonSubmit:!0,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-3",children:e.jsx("h5",{className:"card-title mb-0",children:"Información del Proyecto"})}),e.jsx("div",{className:"card-body p-3",children:e.jsx("table",{className:"table table-borderless table-sm mb-0",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{style:{width:"140px"},children:"Nombre:"}),e.jsx("td",{children:(s==null?void 0:s.name)||"Sin título"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Descripción:"}),e.jsx("td",{children:(s==null?void 0:s.description)||"Sin descripción"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Estado:"}),e.jsx("td",{children:(()=>{const t=v(s==null?void 0:s.status);return e.jsx("span",{className:"badge rounded-pill px-3 py-2",style:{backgroundColor:t.backgroundColor,color:t.color},children:t.text})})()})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Creado:"}),e.jsx("td",{children:s?moment(s.created_at).format("DD/MM/YYYY HH:mm"):"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Modificado:"}),e.jsx("td",{children:s?moment(s.updated_at).format("DD/MM/YYYY HH:mm"):"-"})]})]})})})]}),(s==null?void 0:s.configuration)&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-3",children:e.jsx("h5",{className:"card-title mb-0",children:"Configuración"})}),e.jsx("div",{className:"card-body p-3",children:e.jsx("pre",{className:"bg-light p-3 rounded",style:{fontSize:"12px"},children:JSON.stringify(JSON.parse(s.configuration||"{}"),null,2)})})]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-3",children:e.jsx("h5",{className:"card-title mb-0",children:"Vista Previa"})}),e.jsx("div",{className:"card-body p-3 text-center",children:e.jsx("img",{src:(s==null?void 0:s.thumbnail)||"/assets/img/backgrounds/resources/default-image.png",alt:"Vista previa",className:"img-fluid rounded shadow",style:{maxHeight:"200px"},onError:t=>{t.target.src="/assets/img/backgrounds/resources/default-image.png"}})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-3",children:e.jsx("h5",{className:"card-title mb-0",children:"Acciones"})}),e.jsxs("div",{className:"card-body p-3 d-grid gap-2",children:[C(s==null?void 0:s.status)?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success",onClick:()=>j(s==null?void 0:s.id),children:[e.jsx("i",{className:"fa fa-palette me-2"}),"Ir al Editor"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>{$(l.current).modal("hide"),N(s)},children:[e.jsx("i",{className:"fa fa-edit me-2"}),"Editar Nombre"]}),e.jsxs("button",{className:"btn btn-danger",onClick:()=>{$(l.current).modal("hide"),b(s==null?void 0:s.id)},children:[e.jsx("i",{className:"fa fa-trash me-2"}),"Eliminar Proyecto"]})]}):e.jsxs("div",{className:"alert alert-info mb-0",children:[e.jsx("i",{className:"fa fa-info-circle me-2"}),"Este proyecto está finalizado y no se puede editar."]}),e.jsxs("a",{href:"/catalogo",className:"btn btn-success",children:[e.jsx("i",{className:"fa fa-plus me-2"}),"Ir a la web"]})]})]})]})]})}),e.jsxs(E,{modalRef:x,title:"Editar Nombre del Proyecto",size:"md",onClickSubmit:y,textSubmit:"Guardar Cambios",submitIcon:"fa fa-save",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"projectName",className:"form-label",children:["Nombre del Proyecto ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:"form-control",id:"projectName",value:p,onChange:t=>f(t.target.value),placeholder:"Ingresa el nombre del proyecto",maxLength:"255",onKeyPress:t=>{t.key==="Enter"&&y()}}),e.jsx("div",{className:"form-text",children:"Máximo 255 caracteres. Este nombre se mostrará en tu lista de proyectos."})]}),c&&e.jsx("div",{className:"alert alert-light",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("strong",{children:"Proyecto actual:"})," ",c.name||"Sin título",e.jsx("br",{}),e.jsx("strong",{children:"Creado:"})," ",moment(c.created_at).format("DD/MM/YYYY HH:mm")]})})]})]})};Y((h,i)=>{S.createRoot(h).render(e.jsx(D,{...i,title:"Mis Proyectos",children:e.jsx(F,{...i})}))});
