import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as c}from"./index-BH53Isel.js";import{c as j}from"./ReactAppend-DTVVXReZ.js";import{B as N}from"./Base-1RG1ZM6q.js";import{C as y}from"./CreateReactScript-BoGwggCx.js";import{T as C}from"./Table-DitbKwtZ.js";import{D as l}from"./DxButton-DV0H-ZcL.js";import{R as n}from"./ReactAppend-D7S498fx.js";import{S as v}from"./ProductCard-Ap6bpF1Q.js";import{P as w}from"./ProjectsRest-CtLDg8Bp.js";import{M as k}from"./Modal-CIqmjseY.js";import{i as E}from"./tippy-react.esm-GxPckcbS.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";import"./Global-ErywZRdd.js";/* empty css              */import"./Logout-7s5dsuEK.js";import"./main-BvVILmTO.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./MenuItemContainer-C_dOKkRB.js";import"./index.esm-DAJ8Pwbk.js";import"./index-xsH4HHeE.js";/* empty css               */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./BasicRest-b6WIUDlY.js";import"./index-Bx7_DjT0.js";import"./index-BrXtjC9y.js";const d=new w,D=({statuses:m=[]})=>{const i=c.useRef(),o=c.useRef(),[s,b]=c.useState(null),x=async t=>{const{isConfirmed:a}=await v.fire({title:"Eliminar proyecto",text:"¿Estás seguro de eliminar este proyecto?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!a||!await d.delete(t)||$(i.current).dxDataGrid("instance").refresh()},p=async t=>{const a=await d.get(t);b(a.data),$(o.current).modal("show")},h=t=>{window.location.href=`/canva2?project=${t}`},u=t=>{const r={draft:{color:"#fbbf24",text:"Borrador"},completed:{color:"#10b981",text:"Completado"},exported:{color:"#3b82f6",text:"Exportado"},ordered:{color:"#8b5cf6",text:"Pedido realizado"}}[t]||{color:"#6b7280",text:"Desconocido"};return{backgroundColor:`${r.color}20`,color:r.color,text:r.text}},f=t=>t==="draft",g=d;return e.jsxs(e.Fragment,{children:[e.jsx(C,{gridRef:i,title:"Mis Proyectos",rest:g,toolBar:t=>{t.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(i.current).dxDataGrid("instance").refresh()}}),t.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Catálogo",onClick:()=>{window.location.href="/catalago"}}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Proyecto",width:"300px",cellTemplate:(t,{data:a})=>{t.css("cursor","pointer"),t.on("click",()=>{p(a.id)}),n(t,e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"me-3",children:e.jsx("img",{src:a.thumbnail||"/assets/img/backgrounds/resources/default-image.png",alt:a.name,className:"rounded",style:{width:"50px",height:"50px",objectFit:"cover"},onError:r=>{r.target.src="/assets/img/backgrounds/resources/default-image.png"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 fw-bold",children:a.name||"Proyecto sin título"}),e.jsx("small",{className:"text-muted",children:a.description||"Sin descripción"})]})]}))}},{dataField:"created_at",caption:"Fecha Creación",dataType:"date",sortOrder:"desc",cellTemplate:(t,{data:a})=>{t.text(moment(a.created_at).format("DD/MM/YYYY HH:mm"))}},{dataField:"updated_at",caption:"Última Modificación",dataType:"date",cellTemplate:(t,{data:a})=>{t.text(moment(a.updated_at).format("DD/MM/YYYY HH:mm"))}},{dataField:"status",caption:"Estado",cellTemplate:(t,{data:a})=>{const r=u(a.status);n(t,e.jsx("span",{className:"badge rounded-pill px-3 py-2",style:{backgroundColor:r.backgroundColor,color:r.color,fontSize:"12px"},children:r.text}))}},{caption:"Acciones",cellTemplate:(t,{data:a})=>{const r=f(a.status);t.append(l({className:"btn btn-xs btn-light me-1",title:"Ver proyecto",icon:"fa fa-eye",onClick:()=>p(a.id)})),r?(t.append(l({className:"btn btn-xs btn-primary me-1",title:"Editar proyecto",icon:"fa fa-edit",onClick:()=>h(a.id)})),t.append(l({className:"btn btn-xs btn-danger",title:"Eliminar proyecto",icon:"fa fa-trash",onClick:()=>x(a.id)}))):n(t,e.jsx(E,{content:"Los proyectos finalizados no se pueden editar o eliminar",children:e.jsx("span",{className:"badge bg-secondary ms-2",children:"Finalizado"})}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(k,{modalRef:o,title:`Detalles del proyecto: ${(s==null?void 0:s.name)||"Sin título"}`,size:"lg",bodyStyle:{backgroundColor:"#ebeff2"},hideButtonSubmit:!0,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-3",children:e.jsx("h5",{className:"card-title mb-0",children:"Información del Proyecto"})}),e.jsx("div",{className:"card-body p-3",children:e.jsx("table",{className:"table table-borderless table-sm mb-0",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{style:{width:"140px"},children:"Nombre:"}),e.jsx("td",{children:(s==null?void 0:s.name)||"Sin título"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Descripción:"}),e.jsx("td",{children:(s==null?void 0:s.description)||"Sin descripción"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Estado:"}),e.jsx("td",{children:(()=>{const t=u(s==null?void 0:s.status);return e.jsx("span",{className:"badge rounded-pill px-3 py-2",style:{backgroundColor:t.backgroundColor,color:t.color},children:t.text})})()})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Creado:"}),e.jsx("td",{children:s?moment(s.created_at).format("DD/MM/YYYY HH:mm"):"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Modificado:"}),e.jsx("td",{children:s?moment(s.updated_at).format("DD/MM/YYYY HH:mm"):"-"})]})]})})})]}),(s==null?void 0:s.configuration)&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-3",children:e.jsx("h5",{className:"card-title mb-0",children:"Configuración"})}),e.jsx("div",{className:"card-body p-3",children:e.jsx("pre",{className:"bg-light p-3 rounded",style:{fontSize:"12px"},children:JSON.stringify(JSON.parse(s.configuration||"{}"),null,2)})})]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-3",children:e.jsx("h5",{className:"card-title mb-0",children:"Vista Previa"})}),e.jsx("div",{className:"card-body p-3 text-center",children:e.jsx("img",{src:(s==null?void 0:s.thumbnail)||"/assets/img/backgrounds/resources/default-image.png",alt:"Vista previa",className:"img-fluid rounded shadow",style:{maxHeight:"200px"},onError:t=>{t.target.src="/assets/img/backgrounds/resources/default-image.png"}})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-3",children:e.jsx("h5",{className:"card-title mb-0",children:"Acciones"})}),e.jsxs("div",{className:"card-body p-3 d-grid gap-2",children:[f(s==null?void 0:s.status)?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>h(s==null?void 0:s.id),children:[e.jsx("i",{className:"fa fa-edit me-2"}),"Continuar Editando"]}),e.jsxs("button",{className:"btn btn-danger",onClick:()=>{$(o.current).modal("hide"),x(s==null?void 0:s.id)},children:[e.jsx("i",{className:"fa fa-trash me-2"}),"Eliminar Proyecto"]})]}):e.jsxs("div",{className:"alert alert-info mb-0",children:[e.jsx("i",{className:"fa fa-info-circle me-2"}),"Este proyecto está finalizado y no se puede editar."]}),e.jsxs("a",{href:"/catalogo",className:"btn btn-success",children:[e.jsx("i",{className:"fa fa-plus me-2"}),"Ir a la web"]})]})]})]})]})})]})};y((m,i)=>{j.createRoot(m).render(e.jsx(N,{...i,title:"Mis Proyectos",children:e.jsx(D,{...i})}))});
