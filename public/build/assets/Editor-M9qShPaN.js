const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-CHaihsQY.js","assets/index-BH53Isel.js","assets/index-yBjzXJbu.js","assets/preload-helper-BfFHrpNk.js","assets/typeof-QjJsDpFa.js"])))=>i.map(i=>d[i]);
import{_ as Eo}from"./preload-helper-BfFHrpNk.js";import{j as l}from"./AboutSimple-Cf8x2fCZ.js";import{R as fe,r as y}from"./index-BH53Isel.js";import{b as Sn,c as Io,a as No,d as Do,T as Tr,l as we,i as ua,e as ga,D as Ao,H as Po,B as tr,F as ko,U as jo,R as Ro,E as En}from"./EditableCell-3YaYDQ5F.js";import{h as In}from"./thumbnailGenerator-B4goYG9Y.js";import{a as To,b as lt,_ as H}from"./objectWithoutPropertiesLoose-CoVnHxV7.js";import{h as Nn}from"./hoist-non-react-statics.cjs-kbdZbs82.js";import{r as Bo,R as Oo}from"./index-rimy3MAc.js";import{c as ae}from"./createLucideIcon-Cy5Ya80P.js";import{I as it,C as Mo}from"./image-cwhXnF8c.js";import"./EditorLayout-B4bUL1bb.js";import"./jspdf.es.min-CHaihsQY.js";import{t as Me,T as Lo}from"./index-CMHsc23u.js";import{m as Dn}from"./main-BvVILmTO.js";import{X as Fo}from"./x-DBMwyD6F.js";import{P as Go}from"./palette-DV_Vpyg9.js";import{M as An}from"./minus-jyhodMPN.js";import{P as Pn}from"./plus-Bot15Khs.js";import{C as Uo}from"./chevron-down-DS-mdh9v.js";import{B as zo}from"./V1Edit-B6cwZy1S.js";import{G as At}from"./Global-ErywZRdd.js";import{S as $o,F as Ho}from"./save-BfW-kI1U.js";import{C as Wo}from"./clock-BTrEpQej.js";import{C as pa}from"./check-DQ7QoS0v.js";import{L as Vo}from"./loader-circle-CrvBvIt1.js";import{T as fa}from"./trash-2-DK1wnsDn.js";import{B as $t}from"./dom-to-image-more.min-Cey65QPP.js";import{C as qo}from"./chevron-left-B2s3ZsB7.js";import{C as Ko}from"./circle-check-big-D6DM3vPb.js";import"./index-yBjzXJbu.js";import"./objectSpread2-8ZRf701l.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./sparkles-DeLUn6av.js";import"./sliders-vertical-C5ts4taK.js";import"./settings-BSPs3Zt8.js";import"./chevron-up-D78jyEhP.js";import"./index-BSWw-p5k.js";import"./EditorMain-_pvTHO57.js";import"./upload-qgEr5bIl.js";import"./index-fNjTmf9T.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./PaymentModal-Bxx5p2o_.js";import"./index-Chjiymov.js";import"./chevron-right-Ckt5D2ka.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=ae("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=ae("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=ae("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=ae("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=ae("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=ae("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=ae("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=ae("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=ae("Heading1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=ae("Heading2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=ae("Heading3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=ae("Heading4",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17 10v4h4",key:"13sv97"}],["path",{d:"M21 10v8",key:"1kdml4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=ae("Highlighter",[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=ae("IndentDecrease",[["polyline",{points:"7 8 3 12 7 16",key:"2j60jr"}],["line",{x1:"21",x2:"11",y1:"12",y2:"12",key:"1fxxak"}],["line",{x1:"21",x2:"11",y1:"6",y2:"6",key:"asgu94"}],["line",{x1:"21",x2:"11",y1:"18",y2:"18",key:"13dsj7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=ae("IndentIncrease",[["polyline",{points:"3 8 7 12 3 16",key:"f3rxhf"}],["line",{x1:"21",x2:"11",y1:"12",y2:"12",key:"1fxxak"}],["line",{x1:"21",x2:"11",y1:"6",y2:"6",key:"asgu94"}],["line",{x1:"21",x2:"11",y1:"18",y2:"18",key:"13dsj7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=ae("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ui=ae("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=ae("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pi=ae("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=ae("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=ae("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=ae("PaintBucket",[["path",{d:"m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z",key:"irua1i"}],["path",{d:"m5 2 5 5",key:"1lls2c"}],["path",{d:"M2 13h15",key:"1hkzvu"}],["path",{d:"M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z",key:"xk76lq"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=ae("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=ae("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=ae("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=ae("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=ae("Strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=ae("Subscript",[["path",{d:"m4 5 8 8",key:"1eunvl"}],["path",{d:"m12 5-8 8",key:"1ah0jp"}],["path",{d:"M20 19h-4c0-1.5.44-2 1.5-2.5S20 15.33 20 14c0-.47-.17-.93-.48-1.29a2.11 2.11 0 0 0-2.62-.44c-.42.24-.74.62-.9 1.07",key:"e8ta8j"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=ae("Superscript",[["path",{d:"m4 19 8-8",key:"hr47gm"}],["path",{d:"m12 19-8-8",key:"1dhhmo"}],["path",{d:"M20 12h-4c0-1.5.442-2 1.5-2.5S20 8.334 20 7.002c0-.472-.17-.93-.484-1.29a2.105 2.105 0 0 0-2.617-.436c-.42.239-.738.614-.899 1.06",key:"1dfcux"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=ae("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=ae("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=ae("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=ae("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);function va(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,To(e,r)}var ha=fe.createContext(null);function Ni(e){e()}var ba=Ni,Di=function(r){return ba=r},Ai=function(){return ba};function Pi(){var e=Ai(),r=null,t=null;return{clear:function(){r=null,t=null},notify:function(){e(function(){for(var a=r;a;)a.callback(),a=a.next})},get:function(){for(var a=[],o=r;o;)a.push(o),o=o.next;return a},subscribe:function(a){var o=!0,i=t={callback:a,next:null,prev:t};return i.prev?i.prev.next=i:r=i,function(){!o||r===null||(o=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:r=i.next)}}}}var jn={notify:function(){},get:function(){return[]}};function xa(e,r){var t,n=jn;function a(d){return c(),n.subscribe(d)}function o(){n.notify()}function i(){f.onStateChange&&f.onStateChange()}function s(){return!!t}function c(){t||(t=r?r.addNestedSub(i):e.subscribe(i),n=Pi())}function g(){t&&(t(),t=void 0,n.clear(),n=jn)}var f={addNestedSub:a,notifyNestedSubs:o,handleChangeWrapper:i,isSubscribed:s,trySubscribe:c,tryUnsubscribe:g,getListeners:function(){return n}};return f}var ya=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?y.useLayoutEffect:y.useEffect;function ki(e){var r=e.store,t=e.context,n=e.children,a=y.useMemo(function(){var s=xa(r);return{store:r,subscription:s}},[r]),o=y.useMemo(function(){return r.getState()},[r]);ya(function(){var s=a.subscription;return s.onStateChange=s.notifyNestedSubs,s.trySubscribe(),o!==r.getState()&&s.notifyNestedSubs(),function(){s.tryUnsubscribe(),s.onStateChange=null}},[a,o]);var i=t||ha;return fe.createElement(i.Provider,{value:a},n)}var Pt={exports:{}},de={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rn;function ji(){if(Rn)return de;Rn=1;var e=60103,r=60106,t=60107,n=60108,a=60114,o=60109,i=60110,s=60112,c=60113,g=60120,f=60115,d=60116,u=60121,m=60122,p=60117,w=60129,h=60131;if(typeof Symbol=="function"&&Symbol.for){var C=Symbol.for;e=C("react.element"),r=C("react.portal"),t=C("react.fragment"),n=C("react.strict_mode"),a=C("react.profiler"),o=C("react.provider"),i=C("react.context"),s=C("react.forward_ref"),c=C("react.suspense"),g=C("react.suspense_list"),f=C("react.memo"),d=C("react.lazy"),u=C("react.block"),m=C("react.server.block"),p=C("react.fundamental"),w=C("react.debug_trace_mode"),h=C("react.legacy_hidden")}function I(T){if(typeof T=="object"&&T!==null){var $=T.$$typeof;switch($){case e:switch(T=T.type,T){case t:case a:case n:case c:case g:return T;default:switch(T=T&&T.$$typeof,T){case i:case s:case d:case f:case o:return T;default:return $}}case r:return $}}}var P=o,N=e,M=s,B=t,z=d,_=f,V=r,ee=a,K=n,le=c;return de.ContextConsumer=i,de.ContextProvider=P,de.Element=N,de.ForwardRef=M,de.Fragment=B,de.Lazy=z,de.Memo=_,de.Portal=V,de.Profiler=ee,de.StrictMode=K,de.Suspense=le,de.isAsyncMode=function(){return!1},de.isConcurrentMode=function(){return!1},de.isContextConsumer=function(T){return I(T)===i},de.isContextProvider=function(T){return I(T)===o},de.isElement=function(T){return typeof T=="object"&&T!==null&&T.$$typeof===e},de.isForwardRef=function(T){return I(T)===s},de.isFragment=function(T){return I(T)===t},de.isLazy=function(T){return I(T)===d},de.isMemo=function(T){return I(T)===f},de.isPortal=function(T){return I(T)===r},de.isProfiler=function(T){return I(T)===a},de.isStrictMode=function(T){return I(T)===n},de.isSuspense=function(T){return I(T)===c},de.isValidElementType=function(T){return typeof T=="string"||typeof T=="function"||T===t||T===a||T===w||T===n||T===c||T===g||T===h||typeof T=="object"&&T!==null&&(T.$$typeof===d||T.$$typeof===f||T.$$typeof===o||T.$$typeof===i||T.$$typeof===s||T.$$typeof===p||T.$$typeof===u||T[0]===m)},de.typeOf=I,de}var Tn;function Ri(){return Tn||(Tn=1,Pt.exports=ji()),Pt.exports}var Ti=Ri(),Bi=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],Oi=["reactReduxForwardedRef"],Mi=[],Li=[null,null];function Fi(e,r){var t=e[1];return[r.payload,t+1]}function Bn(e,r,t){ya(function(){return e.apply(void 0,r)},t)}function Gi(e,r,t,n,a,o,i){e.current=n,r.current=a,t.current=!1,o.current&&(o.current=null,i())}function Ui(e,r,t,n,a,o,i,s,c,g){if(e){var f=!1,d=null,u=function(){if(!f){var w=r.getState(),h,C;try{h=n(w,a.current)}catch(I){C=I,d=I}C||(d=null),h===o.current?i.current||c():(o.current=h,s.current=h,i.current=!0,g({type:"STORE_UPDATED",payload:{error:C}}))}};t.onStateChange=u,t.trySubscribe(),u();var m=function(){if(f=!0,t.tryUnsubscribe(),t.onStateChange=null,d)throw d};return m}}var zi=function(){return[null,0]};function $i(e,r){r===void 0&&(r={});var t=r,n=t.getDisplayName,a=n===void 0?function(P){return"ConnectAdvanced("+P+")"}:n,o=t.methodName,i=o===void 0?"connectAdvanced":o,s=t.renderCountProp,c=s===void 0?void 0:s,g=t.shouldHandleStateChanges,f=g===void 0?!0:g,d=t.storeKey,u=d===void 0?"store":d;t.withRef;var m=t.forwardRef,p=m===void 0?!1:m,w=t.context,h=w===void 0?ha:w,C=lt(t,Bi),I=h;return function(N){var M=N.displayName||N.name||"Component",B=a(M),z=H({},C,{getDisplayName:a,methodName:i,renderCountProp:c,shouldHandleStateChanges:f,storeKey:u,displayName:B,wrappedComponentName:M,WrappedComponent:N}),_=C.pure;function V($){return e($.dispatch,z)}var ee=_?y.useMemo:function($){return $()};function K($){var ge=y.useMemo(function(){var He=$.reactReduxForwardedRef,be=lt($,Oi);return[$.context,He,be]},[$]),k=ge[0],X=ge[1],ce=ge[2],J=y.useMemo(function(){return k&&k.Consumer&&Ti.isContextConsumer(fe.createElement(k.Consumer,null))?k:I},[k,I]),oe=y.useContext(J),me=!!$.store&&!!$.store.getState&&!!$.store.dispatch;oe&&oe.store;var he=me?$.store:oe.store,ve=y.useMemo(function(){return V(he)},[he]),Y=y.useMemo(function(){if(!f)return Li;var He=xa(he,me?null:oe.subscription),be=He.notifyNestedSubs.bind(He);return[He,be]},[he,me,oe]),Ne=Y[0],Se=Y[1],De=y.useMemo(function(){return me?oe:H({},oe,{subscription:Ne})},[me,oe,Ne]),$e=y.useReducer(Fi,Mi,zi),Xe=$e[0],Ge=Xe[0],Re=$e[1];if(Ge&&Ge.error)throw Ge.error;var Je=y.useRef(),Qe=y.useRef(ce),We=y.useRef(),Ze=y.useRef(!1),_e=ee(function(){return We.current&&ce===Qe.current?We.current:ve(he.getState(),ce)},[he,Ge,ce]);Bn(Gi,[Qe,Je,Ze,ce,_e,We,Se]),Bn(Ui,[f,he,Ne,ve,Qe,Je,Ze,We,Se,Re],[he,Ne,ve]);var Ve=y.useMemo(function(){return fe.createElement(N,H({},_e,{ref:X}))},[X,N,_e]),pr=y.useMemo(function(){return f?fe.createElement(J.Provider,{value:De},Ve):Ve},[J,Ve,De]);return pr}var le=_?fe.memo(K):K;if(le.WrappedComponent=N,le.displayName=K.displayName=B,p){var T=fe.forwardRef(function(ge,k){return fe.createElement(le,H({},ge,{reactReduxForwardedRef:k}))});return T.displayName=B,T.WrappedComponent=N,Nn(T,N)}return Nn(le,N)}}function On(e,r){return e===r?e!==0||r!==0||1/e===1/r:e!==e&&r!==r}function kt(e,r){if(On(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(var a=0;a<t.length;a++)if(!Object.prototype.hasOwnProperty.call(r,t[a])||!On(e[t[a]],r[t[a]]))return!1;return!0}function Hi(e,r){var t={},n=function(i){var s=e[i];typeof s=="function"&&(t[i]=function(){return r(s.apply(void 0,arguments))})};for(var a in e)n(a);return t}function Jt(e){return function(t,n){var a=e(t,n);function o(){return a}return o.dependsOnOwnProps=!1,o}}function Mn(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function wa(e,r){return function(n,a){a.displayName;var o=function(s,c){return o.dependsOnOwnProps?o.mapToProps(s,c):o.mapToProps(s)};return o.dependsOnOwnProps=!0,o.mapToProps=function(s,c){o.mapToProps=e,o.dependsOnOwnProps=Mn(e);var g=o(s,c);return typeof g=="function"&&(o.mapToProps=g,o.dependsOnOwnProps=Mn(g),g=o(s,c)),g},o}}function Wi(e){return typeof e=="function"?wa(e):void 0}function Vi(e){return e?void 0:Jt(function(r){return{dispatch:r}})}function qi(e){return e&&typeof e=="object"?Jt(function(r){return Hi(e,r)}):void 0}const Ki=[Wi,Vi,qi];function Yi(e){return typeof e=="function"?wa(e):void 0}function Xi(e){return e?void 0:Jt(function(){return{}})}const Ji=[Yi,Xi];function Qi(e,r,t){return H({},t,e,r)}function Zi(e){return function(t,n){n.displayName;var a=n.pure,o=n.areMergedPropsEqual,i=!1,s;return function(g,f,d){var u=e(g,f,d);return i?(!a||!o(u,s))&&(s=u):(i=!0,s=u),s}}}function _i(e){return typeof e=="function"?Zi(e):void 0}function es(e){return e?void 0:function(){return Qi}}const rs=[_i,es];var ts=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function ns(e,r,t,n){return function(o,i){return t(e(o,i),r(n,i),i)}}function as(e,r,t,n,a){var o=a.areStatesEqual,i=a.areOwnPropsEqual,s=a.areStatePropsEqual,c=!1,g,f,d,u,m;function p(P,N){return g=P,f=N,d=e(g,f),u=r(n,f),m=t(d,u,f),c=!0,m}function w(){return d=e(g,f),r.dependsOnOwnProps&&(u=r(n,f)),m=t(d,u,f),m}function h(){return e.dependsOnOwnProps&&(d=e(g,f)),r.dependsOnOwnProps&&(u=r(n,f)),m=t(d,u,f),m}function C(){var P=e(g,f),N=!s(P,d);return d=P,N&&(m=t(d,u,f)),m}function I(P,N){var M=!i(N,f),B=!o(P,g,N,f);return g=P,f=N,M&&B?w():M?h():B?C():m}return function(N,M){return c?I(N,M):p(N,M)}}function os(e,r){var t=r.initMapStateToProps,n=r.initMapDispatchToProps,a=r.initMergeProps,o=lt(r,ts),i=t(e,o),s=n(e,o),c=a(e,o),g=o.pure?as:ns;return g(i,s,c,e,o)}var is=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function jt(e,r,t){for(var n=r.length-1;n>=0;n--){var a=r[n](e);if(a)return a}return function(o,i){throw new Error("Invalid value of type "+typeof e+" for "+t+" argument when connecting component "+i.wrappedComponentName+".")}}function ss(e,r){return e===r}function ls(e){var r=e===void 0?{}:e,t=r.connectHOC,n=t===void 0?$i:t,a=r.mapStateToPropsFactories,o=a===void 0?Ji:a,i=r.mapDispatchToPropsFactories,s=i===void 0?Ki:i,c=r.mergePropsFactories,g=c===void 0?rs:c,f=r.selectorFactory,d=f===void 0?os:f;return function(m,p,w,h){h===void 0&&(h={});var C=h,I=C.pure,P=I===void 0?!0:I,N=C.areStatesEqual,M=N===void 0?ss:N,B=C.areOwnPropsEqual,z=B===void 0?kt:B,_=C.areStatePropsEqual,V=_===void 0?kt:_,ee=C.areMergedPropsEqual,K=ee===void 0?kt:ee,le=lt(C,is),T=jt(m,o,"mapStateToProps"),$=jt(p,s,"mapDispatchToProps"),ge=jt(w,g,"mergeProps");return n(d,H({methodName:"connect",getDisplayName:function(X){return"Connect("+X+")"},shouldHandleStateChanges:!!m,initMapStateToProps:T,initMapDispatchToProps:$,initMergeProps:ge,pure:P,areStatesEqual:M,areOwnPropsEqual:z,areStatePropsEqual:V,areMergedPropsEqual:K},le))}}const Ca=ls();Di(Bo.unstable_batchedUpdates);function cs(e,r){if(e.length!==r.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==r[t])return!1;return!0}function Sa(e,r){var t=y.useState(function(){return{inputs:r,result:e()}})[0],n=y.useRef(!0),a=y.useRef(t),o=n.current||!!(r&&a.current.inputs&&cs(r,a.current.inputs)),i=o?a.current:{inputs:r,result:e()};return y.useEffect(function(){n.current=!1,a.current=i},[i]),i.result}function ds(e,r){return Sa(function(){return e},r)}var se=Sa,G=ds,us="Invariant failed";function gs(e,r){throw new Error(us)}var ze=function(r){var t=r.top,n=r.right,a=r.bottom,o=r.left,i=n-o,s=a-t,c={top:t,right:n,bottom:a,left:o,width:i,height:s,x:o,y:t,center:{x:(n+o)/2,y:(a+t)/2}};return c},Qt=function(r,t){return{top:r.top-t.top,left:r.left-t.left,bottom:r.bottom+t.bottom,right:r.right+t.right}},Ln=function(r,t){return{top:r.top+t.top,left:r.left+t.left,bottom:r.bottom-t.bottom,right:r.right-t.right}},ps=function(r,t){return{top:r.top+t.y,left:r.left+t.x,bottom:r.bottom+t.y,right:r.right+t.x}},Rt={top:0,right:0,bottom:0,left:0},Zt=function(r){var t=r.borderBox,n=r.margin,a=n===void 0?Rt:n,o=r.border,i=o===void 0?Rt:o,s=r.padding,c=s===void 0?Rt:s,g=ze(Qt(t,a)),f=ze(Ln(t,i)),d=ze(Ln(f,c));return{marginBox:g,borderBox:ze(t),paddingBox:f,contentBox:d,margin:a,border:i,padding:c}},Oe=function(r){var t=r.slice(0,-2),n=r.slice(-2);if(n!=="px")return 0;var a=Number(t);return isNaN(a)&&gs(),a},fs=function(){return{x:window.pageXOffset,y:window.pageYOffset}},ct=function(r,t){var n=r.borderBox,a=r.border,o=r.margin,i=r.padding,s=ps(n,t);return Zt({borderBox:s,border:a,margin:o,padding:i})},dt=function(r,t){return t===void 0&&(t=fs()),ct(r,t)},Ea=function(r,t){var n={top:Oe(t.marginTop),right:Oe(t.marginRight),bottom:Oe(t.marginBottom),left:Oe(t.marginLeft)},a={top:Oe(t.paddingTop),right:Oe(t.paddingRight),bottom:Oe(t.paddingBottom),left:Oe(t.paddingLeft)},o={top:Oe(t.borderTopWidth),right:Oe(t.borderRightWidth),bottom:Oe(t.borderBottomWidth),left:Oe(t.borderLeftWidth)};return Zt({borderBox:r,margin:n,padding:a,border:o})},Ia=function(r){var t=r.getBoundingClientRect(),n=window.getComputedStyle(r);return Ea(t,n)},Fn=Number.isNaN||function(r){return typeof r=="number"&&r!==r};function ms(e,r){return!!(e===r||Fn(e)&&Fn(r))}function vs(e,r){if(e.length!==r.length)return!1;for(var t=0;t<e.length;t++)if(!ms(e[t],r[t]))return!1;return!0}function xe(e,r){r===void 0&&(r=vs);var t,n=[],a,o=!1;function i(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];return o&&t===this&&r(s,n)||(a=e.apply(this,s),o=!0,t=this,n=s),a}return i}var Mr=function(r){var t=[],n=null,a=function(){for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];t=s,!n&&(n=requestAnimationFrame(function(){n=null,r.apply(void 0,t)}))};return a.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},a};function Na(e,r){}Na.bind(null,"warn");Na.bind(null,"error");function nr(){}function hs(e,r){return H({},e,{},r)}function Le(e,r,t){var n=r.map(function(a){var o=hs(t,a.options);return e.addEventListener(a.eventName,a.fn,o),function(){e.removeEventListener(a.eventName,a.fn,o)}});return function(){n.forEach(function(o){o()})}}var bs="Invariant failed";function ut(e){this.message=e}ut.prototype.toString=function(){return this.message};function j(e,r){throw new ut(bs)}var xs=function(e){va(r,e);function r(){for(var n,a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,n.callbacks=null,n.unbind=nr,n.onWindowError=function(s){var c=n.getCallbacks();c.isDragging()&&c.tryAbort();var g=s.error;g instanceof ut&&s.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(s){n.callbacks=s},n}var t=r.prototype;return t.componentDidMount=function(){this.unbind=Le(window,[{eventName:"error",fn:this.onWindowError}])},t.componentDidCatch=function(a){if(a instanceof ut){this.setState({});return}throw a},t.componentWillUnmount=function(){this.unbind()},t.render=function(){return this.props.children(this.setCallbacks)},r}(fe.Component),ys=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,gt=function(r){return r+1},ws=function(r){return`
  You have lifted an item in position `+gt(r.source.index)+`
`},Da=function(r,t){var n=r.droppableId===t.droppableId,a=gt(r.index),o=gt(t.index);return n?`
      You have moved the item from position `+a+`
      to position `+o+`
    `:`
    You have moved the item from position `+a+`
    in list `+r.droppableId+`
    to list `+t.droppableId+`
    in position `+o+`
  `},Aa=function(r,t,n){var a=t.droppableId===n.droppableId;return a?`
      The item `+r+`
      has been combined with `+n.draggableId:`
      The item `+r+`
      in list `+t.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},Cs=function(r){var t=r.destination;if(t)return Da(r.source,t);var n=r.combine;return n?Aa(r.draggableId,r.source,n):"You are over an area that cannot be dropped on"},Gn=function(r){return`
  The item has returned to its starting position
  of `+gt(r.index)+`
`},Ss=function(r){if(r.reason==="CANCEL")return`
      Movement cancelled.
      `+Gn(r.source)+`
    `;var t=r.destination,n=r.combine;return t?`
      You have dropped the item.
      `+Da(r.source,t)+`
    `:n?`
      You have dropped the item.
      `+Aa(r.draggableId,r.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+Gn(r.source)+`
  `},st={dragHandleUsageInstructions:ys,onDragStart:ws,onDragUpdate:Cs,onDragEnd:Ss},ye={x:0,y:0},Ce=function(r,t){return{x:r.x+t.x,y:r.y+t.y}},Pe=function(r,t){return{x:r.x-t.x,y:r.y-t.y}},ar=function(r,t){return r.x===t.x&&r.y===t.y},Sr=function(r){return{x:r.x!==0?-r.x:0,y:r.y!==0?-r.y:0}},gr=function(r,t,n){var a;return n===void 0&&(n=0),a={},a[r]=t,a[r==="x"?"y":"x"]=n,a},Lr=function(r,t){return Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2))},Un=function(r,t){return Math.min.apply(Math,t.map(function(n){return Lr(r,n)}))},Pa=function(r){return function(t){return{x:r(t.x),y:r(t.y)}}},Es=function(e,r){var t=ze({top:Math.max(r.top,e.top),right:Math.min(r.right,e.right),bottom:Math.min(r.bottom,e.bottom),left:Math.max(r.left,e.left)});return t.width<=0||t.height<=0?null:t},zr=function(r,t){return{top:r.top+t.y,left:r.left+t.x,bottom:r.bottom+t.y,right:r.right+t.x}},zn=function(r){return[{x:r.left,y:r.top},{x:r.right,y:r.top},{x:r.left,y:r.bottom},{x:r.right,y:r.bottom}]},Is={top:0,right:0,bottom:0,left:0},Ns=function(r,t){return t?zr(r,t.scroll.diff.displacement):r},Ds=function(r,t,n){if(n&&n.increasedBy){var a;return H({},r,(a={},a[t.end]=r[t.end]+n.increasedBy[t.line],a))}return r},As=function(r,t){return t&&t.shouldClipSubject?Es(t.pageMarginBox,r):ze(r)},yr=function(e){var r=e.page,t=e.withPlaceholder,n=e.axis,a=e.frame,o=Ns(r.marginBox,a),i=Ds(o,n,t),s=As(i,a);return{page:r,withPlaceholder:t,active:s}},_t=function(e,r){e.frame||j();var t=e.frame,n=Pe(r,t.scroll.initial),a=Sr(n),o=H({},t,{scroll:{initial:t.scroll.initial,current:r,diff:{value:n,displacement:a},max:t.scroll.max}}),i=yr({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:o}),s=H({},e,{frame:o,subject:i});return s};function pt(e){return Object.values?Object.values(e):Object.keys(e).map(function(r){return e[r]})}function en(e,r){if(e.findIndex)return e.findIndex(r);for(var t=0;t<e.length;t++)if(r(e[t]))return t;return-1}function sr(e,r){if(e.find)return e.find(r);var t=en(e,r);if(t!==-1)return e[t]}function ka(e){return Array.prototype.slice.call(e)}var ja=xe(function(e){return e.reduce(function(r,t){return r[t.descriptor.id]=t,r},{})}),Ra=xe(function(e){return e.reduce(function(r,t){return r[t.descriptor.id]=t,r},{})}),ht=xe(function(e){return pt(e)}),Ps=xe(function(e){return pt(e)}),Er=xe(function(e,r){var t=Ps(r).filter(function(n){return e===n.descriptor.droppableId}).sort(function(n,a){return n.descriptor.index-a.descriptor.index});return t});function rn(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function bt(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var xt=xe(function(e,r){return r.filter(function(t){return t.descriptor.id!==e.descriptor.id})}),ks=function(e){var r=e.isMovingForward,t=e.draggable,n=e.destination,a=e.insideDestination,o=e.previousImpact;if(!n.isCombineEnabled)return null;var i=rn(o);if(!i)return null;function s(w){var h={type:"COMBINE",combine:{draggableId:w,droppableId:n.descriptor.id}};return H({},o,{at:h})}var c=o.displaced.all,g=c.length?c[0]:null;if(r)return g?s(g):null;var f=xt(t,a);if(!g){if(!f.length)return null;var d=f[f.length-1];return s(d.descriptor.id)}var u=en(f,function(w){return w.descriptor.id===g});u===-1&&j();var m=u-1;if(m<0)return null;var p=f[m];return s(p.descriptor.id)},Ir=function(e,r){return e.descriptor.droppableId===r.descriptor.id},Ta={point:ye,value:0},Fr={invisible:{},visible:{},all:[]},js={displaced:Fr,displacedBy:Ta,at:null},Fe=function(e,r){return function(t){return e<=t&&t<=r}},Ba=function(e){var r=Fe(e.top,e.bottom),t=Fe(e.left,e.right);return function(n){var a=r(n.top)&&r(n.bottom)&&t(n.left)&&t(n.right);if(a)return!0;var o=r(n.top)||r(n.bottom),i=t(n.left)||t(n.right),s=o&&i;if(s)return!0;var c=n.top<e.top&&n.bottom>e.bottom,g=n.left<e.left&&n.right>e.right,f=c&&g;if(f)return!0;var d=c&&i||g&&o;return d}},Rs=function(e){var r=Fe(e.top,e.bottom),t=Fe(e.left,e.right);return function(n){var a=r(n.top)&&r(n.bottom)&&t(n.left)&&t(n.right);return a}},tn={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Oa={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},Ts=function(e){return function(r){var t=Fe(r.top,r.bottom),n=Fe(r.left,r.right);return function(a){return e===tn?t(a.top)&&t(a.bottom):n(a.left)&&n(a.right)}}},Bs=function(r,t){var n=t.frame?t.frame.scroll.diff.displacement:ye;return zr(r,n)},Os=function(r,t,n){return t.subject.active?n(t.subject.active)(r):!1},Ms=function(r,t,n){return n(t)(r)},nn=function(r){var t=r.target,n=r.destination,a=r.viewport,o=r.withDroppableDisplacement,i=r.isVisibleThroughFrameFn,s=o?Bs(t,n):t;return Os(s,n,i)&&Ms(s,a,i)},Ls=function(r){return nn(H({},r,{isVisibleThroughFrameFn:Ba}))},Ma=function(r){return nn(H({},r,{isVisibleThroughFrameFn:Rs}))},Fs=function(r){return nn(H({},r,{isVisibleThroughFrameFn:Ts(r.destination.axis)}))},Gs=function(r,t,n){if(typeof n=="boolean")return n;if(!t)return!0;var a=t.invisible,o=t.visible;if(a[r])return!1;var i=o[r];return i?i.shouldAnimate:!0};function Us(e,r){var t=e.page.marginBox,n={top:r.point.y,right:0,bottom:0,left:r.point.x};return ze(Qt(t,n))}function Gr(e){var r=e.afterDragging,t=e.destination,n=e.displacedBy,a=e.viewport,o=e.forceShouldAnimate,i=e.last;return r.reduce(function(c,g){var f=Us(g,n),d=g.descriptor.id;c.all.push(d);var u=Ls({target:f,destination:t,viewport:a,withDroppableDisplacement:!0});if(!u)return c.invisible[g.descriptor.id]=!0,c;var m=Gs(d,i,o),p={draggableId:d,shouldAnimate:m};return c.visible[d]=p,c},{all:[],visible:{},invisible:{}})}function zs(e,r){if(!e.length)return 0;var t=e[e.length-1].descriptor.index;return r.inHomeList?t:t+1}function $n(e){var r=e.insideDestination,t=e.inHomeList,n=e.displacedBy,a=e.destination,o=zs(r,{inHomeList:t});return{displaced:Fr,displacedBy:n,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:o}}}}function ft(e){var r=e.draggable,t=e.insideDestination,n=e.destination,a=e.viewport,o=e.displacedBy,i=e.last,s=e.index,c=e.forceShouldAnimate,g=Ir(r,n);if(s==null)return $n({insideDestination:t,inHomeList:g,displacedBy:o,destination:n});var f=sr(t,function(w){return w.descriptor.index===s});if(!f)return $n({insideDestination:t,inHomeList:g,displacedBy:o,destination:n});var d=xt(r,t),u=t.indexOf(f),m=d.slice(u),p=Gr({afterDragging:m,destination:n,displacedBy:o,last:i,viewport:a.frame,forceShouldAnimate:c});return{displaced:p,displacedBy:o,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:s}}}}function ir(e,r){return!!r.effected[e]}var $s=function(e){var r=e.isMovingForward,t=e.destination,n=e.draggables,a=e.combine,o=e.afterCritical;if(!t.isCombineEnabled)return null;var i=a.draggableId,s=n[i],c=s.descriptor.index,g=ir(i,o);return g?r?c:c-1:r?c+1:c},Hs=function(e){var r=e.isMovingForward,t=e.isInHomeList,n=e.insideDestination,a=e.location;if(!n.length)return null;var o=a.index,i=r?o+1:o-1,s=n[0].descriptor.index,c=n[n.length-1].descriptor.index,g=t?c:c+1;return i<s||i>g?null:i},Ws=function(e){var r=e.isMovingForward,t=e.isInHomeList,n=e.draggable,a=e.draggables,o=e.destination,i=e.insideDestination,s=e.previousImpact,c=e.viewport,g=e.afterCritical,f=s.at;if(f||j(),f.type==="REORDER"){var d=Hs({isMovingForward:r,isInHomeList:t,location:f.destination,insideDestination:i});return d==null?null:ft({draggable:n,insideDestination:i,destination:o,viewport:c,last:s.displaced,displacedBy:s.displacedBy,index:d})}var u=$s({isMovingForward:r,destination:o,displaced:s.displaced,draggables:a,combine:f.combine,afterCritical:g});return u==null?null:ft({draggable:n,insideDestination:i,destination:o,viewport:c,last:s.displaced,displacedBy:s.displacedBy,index:u})},Vs=function(e){var r=e.displaced,t=e.afterCritical,n=e.combineWith,a=e.displacedBy,o=!!(r.visible[n]||r.invisible[n]);return ir(n,t)?o?ye:Sr(a.point):o?a.point:ye},qs=function(e){var r=e.afterCritical,t=e.impact,n=e.draggables,a=bt(t);a||j();var o=a.draggableId,i=n[o].page.borderBox.center,s=Vs({displaced:t.displaced,afterCritical:r,combineWith:o,displacedBy:t.displacedBy});return Ce(i,s)},La=function(r,t){return t.margin[r.start]+t.borderBox[r.size]/2},Ks=function(r,t){return t.margin[r.end]+t.borderBox[r.size]/2},an=function(r,t,n){return t[r.crossAxisStart]+n.margin[r.crossAxisStart]+n.borderBox[r.crossAxisSize]/2},Hn=function(r){var t=r.axis,n=r.moveRelativeTo,a=r.isMoving;return gr(t.line,n.marginBox[t.end]+La(t,a),an(t,n.marginBox,a))},Wn=function(r){var t=r.axis,n=r.moveRelativeTo,a=r.isMoving;return gr(t.line,n.marginBox[t.start]-Ks(t,a),an(t,n.marginBox,a))},Ys=function(r){var t=r.axis,n=r.moveInto,a=r.isMoving;return gr(t.line,n.contentBox[t.start]+La(t,a),an(t,n.contentBox,a))},Xs=function(e){var r=e.impact,t=e.draggable,n=e.draggables,a=e.droppable,o=e.afterCritical,i=Er(a.descriptor.id,n),s=t.page,c=a.axis;if(!i.length)return Ys({axis:c,moveInto:a.page,isMoving:s});var g=r.displaced,f=r.displacedBy,d=g.all[0];if(d){var u=n[d];if(ir(d,o))return Wn({axis:c,moveRelativeTo:u.page,isMoving:s});var m=ct(u.page,f.point);return Wn({axis:c,moveRelativeTo:m,isMoving:s})}var p=i[i.length-1];if(p.descriptor.id===t.descriptor.id)return s.borderBox.center;if(ir(p.descriptor.id,o)){var w=ct(p.page,Sr(o.displacedBy.point));return Hn({axis:c,moveRelativeTo:w,isMoving:s})}return Hn({axis:c,moveRelativeTo:p.page,isMoving:s})},Ht=function(e,r){var t=e.frame;return t?Ce(r,t.scroll.diff.displacement):r},Js=function(r){var t=r.impact,n=r.draggable,a=r.droppable,o=r.draggables,i=r.afterCritical,s=n.page.borderBox.center,c=t.at;return!a||!c?s:c.type==="REORDER"?Xs({impact:t,draggable:n,draggables:o,droppable:a,afterCritical:i}):qs({impact:t,draggables:o,afterCritical:i})},yt=function(e){var r=Js(e),t=e.droppable,n=t?Ht(t,r):r;return n},Fa=function(e,r){var t=Pe(r,e.scroll.initial),n=Sr(t),a=ze({top:r.y,bottom:r.y+e.frame.height,left:r.x,right:r.x+e.frame.width}),o={frame:a,scroll:{initial:e.scroll.initial,max:e.scroll.max,current:r,diff:{value:t,displacement:n}}};return o};function Vn(e,r){return e.map(function(t){return r[t]})}function Qs(e,r){for(var t=0;t<r.length;t++){var n=r[t].visible[e];if(n)return n}return null}var Zs=function(e){var r=e.impact,t=e.viewport,n=e.destination,a=e.draggables,o=e.maxScrollChange,i=Fa(t,Ce(t.scroll.current,o)),s=n.frame?_t(n,Ce(n.frame.scroll.current,o)):n,c=r.displaced,g=Gr({afterDragging:Vn(c.all,a),destination:n,displacedBy:r.displacedBy,viewport:i.frame,last:c,forceShouldAnimate:!1}),f=Gr({afterDragging:Vn(c.all,a),destination:s,displacedBy:r.displacedBy,viewport:t.frame,last:c,forceShouldAnimate:!1}),d={},u={},m=[c,g,f];c.all.forEach(function(w){var h=Qs(w,m);if(h){u[w]=h;return}d[w]=!0});var p=H({},r,{displaced:{all:c.all,invisible:d,visible:u}});return p},_s=function(e,r){return Ce(e.scroll.diff.displacement,r)},on=function(e){var r=e.pageBorderBoxCenter,t=e.draggable,n=e.viewport,a=_s(n,r),o=Pe(a,t.page.borderBox.center);return Ce(t.client.borderBox.center,o)},Ga=function(e){var r=e.draggable,t=e.destination,n=e.newPageBorderBoxCenter,a=e.viewport,o=e.withDroppableDisplacement,i=e.onlyOnMainAxis,s=i===void 0?!1:i,c=Pe(n,r.page.borderBox.center),g=zr(r.page.borderBox,c),f={target:g,destination:t,withDroppableDisplacement:o,viewport:a};return s?Fs(f):Ma(f)},el=function(e){var r=e.isMovingForward,t=e.draggable,n=e.destination,a=e.draggables,o=e.previousImpact,i=e.viewport,s=e.previousPageBorderBoxCenter,c=e.previousClientSelection,g=e.afterCritical;if(!n.isEnabled)return null;var f=Er(n.descriptor.id,a),d=Ir(t,n),u=ks({isMovingForward:r,draggable:t,destination:n,insideDestination:f,previousImpact:o})||Ws({isMovingForward:r,isInHomeList:d,draggable:t,draggables:a,destination:n,insideDestination:f,previousImpact:o,viewport:i,afterCritical:g});if(!u)return null;var m=yt({impact:u,draggable:t,droppable:n,draggables:a,afterCritical:g}),p=Ga({draggable:t,destination:n,newPageBorderBoxCenter:m,viewport:i.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(p){var w=on({pageBorderBoxCenter:m,draggable:t,viewport:i});return{clientSelection:w,impact:u,scrollJumpRequest:null}}var h=Pe(m,s),C=Zs({impact:u,viewport:i,destination:n,draggables:a,maxScrollChange:h});return{clientSelection:c,impact:C,scrollJumpRequest:h}},Ie=function(r){var t=r.subject.active;return t||j(),t},rl=function(e){var r=e.isMovingForward,t=e.pageBorderBoxCenter,n=e.source,a=e.droppables,o=e.viewport,i=n.subject.active;if(!i)return null;var s=n.axis,c=Fe(i[s.start],i[s.end]),g=ht(a).filter(function(d){return d!==n}).filter(function(d){return d.isEnabled}).filter(function(d){return!!d.subject.active}).filter(function(d){return Ba(o.frame)(Ie(d))}).filter(function(d){var u=Ie(d);return r?i[s.crossAxisEnd]<u[s.crossAxisEnd]:u[s.crossAxisStart]<i[s.crossAxisStart]}).filter(function(d){var u=Ie(d),m=Fe(u[s.start],u[s.end]);return c(u[s.start])||c(u[s.end])||m(i[s.start])||m(i[s.end])}).sort(function(d,u){var m=Ie(d)[s.crossAxisStart],p=Ie(u)[s.crossAxisStart];return r?m-p:p-m}).filter(function(d,u,m){return Ie(d)[s.crossAxisStart]===Ie(m[0])[s.crossAxisStart]});if(!g.length)return null;if(g.length===1)return g[0];var f=g.filter(function(d){var u=Fe(Ie(d)[s.start],Ie(d)[s.end]);return u(t[s.line])});return f.length===1?f[0]:f.length>1?f.sort(function(d,u){return Ie(d)[s.start]-Ie(u)[s.start]})[0]:g.sort(function(d,u){var m=Un(t,zn(Ie(d))),p=Un(t,zn(Ie(u)));return m!==p?m-p:Ie(d)[s.start]-Ie(u)[s.start]})[0]},qn=function(r,t){var n=r.page.borderBox.center;return ir(r.descriptor.id,t)?Pe(n,t.displacedBy.point):n},tl=function(r,t){var n=r.page.borderBox;return ir(r.descriptor.id,t)?zr(n,Sr(t.displacedBy.point)):n},nl=function(e){var r=e.pageBorderBoxCenter,t=e.viewport,n=e.destination,a=e.insideDestination,o=e.afterCritical,i=a.filter(function(s){return Ma({target:tl(s,o),destination:n,viewport:t.frame,withDroppableDisplacement:!0})}).sort(function(s,c){var g=Lr(r,Ht(n,qn(s,o))),f=Lr(r,Ht(n,qn(c,o)));return g<f?-1:f<g?1:s.descriptor.index-c.descriptor.index});return i[0]||null},$r=xe(function(r,t){var n=t[r.line];return{value:n,point:gr(r.line,n)}}),al=function(r,t,n){var a=r.axis;if(r.descriptor.mode==="virtual")return gr(a.line,t[a.line]);var o=r.subject.page.contentBox[a.size],i=Er(r.descriptor.id,n),s=i.reduce(function(f,d){return f+d.client.marginBox[a.size]},0),c=s+t[a.line],g=c-o;return g<=0?null:gr(a.line,g)},Ua=function(r,t){return H({},r,{scroll:H({},r.scroll,{max:t})})},za=function(r,t,n){var a=r.frame;Ir(t,r)&&j(),r.subject.withPlaceholder&&j();var o=$r(r.axis,t.displaceBy).point,i=al(r,o,n),s={placeholderSize:o,increasedBy:i,oldFrameMaxScroll:r.frame?r.frame.scroll.max:null};if(!a){var c=yr({page:r.subject.page,withPlaceholder:s,axis:r.axis,frame:r.frame});return H({},r,{subject:c})}var g=i?Ce(a.scroll.max,i):a.scroll.max,f=Ua(a,g),d=yr({page:r.subject.page,withPlaceholder:s,axis:r.axis,frame:f});return H({},r,{subject:d,frame:f})},ol=function(r){var t=r.subject.withPlaceholder;t||j();var n=r.frame;if(!n){var a=yr({page:r.subject.page,axis:r.axis,frame:null,withPlaceholder:null});return H({},r,{subject:a})}var o=t.oldFrameMaxScroll;o||j();var i=Ua(n,o),s=yr({page:r.subject.page,axis:r.axis,frame:i,withPlaceholder:null});return H({},r,{subject:s,frame:i})},il=function(e){var r=e.previousPageBorderBoxCenter,t=e.moveRelativeTo,n=e.insideDestination,a=e.draggable,o=e.draggables,i=e.destination,s=e.viewport,c=e.afterCritical;if(!t){if(n.length)return null;var g={displaced:Fr,displacedBy:Ta,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:0}}},f=yt({impact:g,draggable:a,droppable:i,draggables:o,afterCritical:c}),d=Ir(a,i)?i:za(i,a,o),u=Ga({draggable:a,destination:d,newPageBorderBoxCenter:f,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return u?g:null}var m=r[i.axis.line]<=t.page.borderBox.center[i.axis.line],p=function(){var h=t.descriptor.index;return t.descriptor.id===a.descriptor.id||m?h:h+1}(),w=$r(i.axis,a.displaceBy);return ft({draggable:a,insideDestination:n,destination:i,viewport:s,displacedBy:w,last:Fr,index:p})},sl=function(e){var r=e.isMovingForward,t=e.previousPageBorderBoxCenter,n=e.draggable,a=e.isOver,o=e.draggables,i=e.droppables,s=e.viewport,c=e.afterCritical,g=rl({isMovingForward:r,pageBorderBoxCenter:t,source:a,droppables:i,viewport:s});if(!g)return null;var f=Er(g.descriptor.id,o),d=nl({pageBorderBoxCenter:t,viewport:s,destination:g,insideDestination:f,afterCritical:c}),u=il({previousPageBorderBoxCenter:t,destination:g,draggable:n,draggables:o,moveRelativeTo:d,insideDestination:f,viewport:s,afterCritical:c});if(!u)return null;var m=yt({impact:u,draggable:n,droppable:g,draggables:o,afterCritical:c}),p=on({pageBorderBoxCenter:m,draggable:n,viewport:s});return{clientSelection:p,impact:u,scrollJumpRequest:null}},ke=function(e){var r=e.at;return r?r.type==="REORDER"?r.destination.droppableId:r.combine.droppableId:null},ll=function(r,t){var n=ke(r);return n?t[n]:null},cl=function(e){var r=e.state,t=e.type,n=ll(r.impact,r.dimensions.droppables),a=!!n,o=r.dimensions.droppables[r.critical.droppable.id],i=n||o,s=i.axis.direction,c=s==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||s==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(c&&!a)return null;var g=t==="MOVE_DOWN"||t==="MOVE_RIGHT",f=r.dimensions.draggables[r.critical.draggable.id],d=r.current.page.borderBoxCenter,u=r.dimensions,m=u.draggables,p=u.droppables;return c?el({isMovingForward:g,previousPageBorderBoxCenter:d,draggable:f,destination:i,draggables:m,viewport:r.viewport,previousClientSelection:r.current.client.selection,previousImpact:r.impact,afterCritical:r.afterCritical}):sl({isMovingForward:g,previousPageBorderBoxCenter:d,draggable:f,isOver:i,draggables:m,droppables:p,viewport:r.viewport,afterCritical:r.afterCritical})};function ur(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function $a(e){var r=Fe(e.top,e.bottom),t=Fe(e.left,e.right);return function(a){return r(a.y)&&t(a.x)}}function dl(e,r){return e.left<r.right&&e.right>r.left&&e.top<r.bottom&&e.bottom>r.top}function ul(e){var r=e.pageBorderBox,t=e.draggable,n=e.candidates,a=t.page.borderBox.center,o=n.map(function(i){var s=i.axis,c=gr(i.axis.line,r.center[s.line],i.page.borderBox.center[s.crossAxisLine]);return{id:i.descriptor.id,distance:Lr(a,c)}}).sort(function(i,s){return s.distance-i.distance});return o[0]?o[0].id:null}function gl(e){var r=e.pageBorderBox,t=e.draggable,n=e.droppables,a=ht(n).filter(function(o){if(!o.isEnabled)return!1;var i=o.subject.active;if(!i||!dl(r,i))return!1;if($a(i)(r.center))return!0;var s=o.axis,c=i.center[s.crossAxisLine],g=r[s.crossAxisStart],f=r[s.crossAxisEnd],d=Fe(i[s.crossAxisStart],i[s.crossAxisEnd]),u=d(g),m=d(f);return!u&&!m?!0:u?g<c:f>c});return a.length?a.length===1?a[0].descriptor.id:ul({pageBorderBox:r,draggable:t,candidates:a}):null}var Ha=function(r,t){return ze(zr(r,t))},pl=function(e,r){var t=e.frame;return t?Ha(r,t.scroll.diff.value):r};function Wa(e){var r=e.displaced,t=e.id;return!!(r.visible[t]||r.invisible[t])}function fl(e){var r=e.draggable,t=e.closest,n=e.inHomeList;return t?n&&t.descriptor.index>r.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var ml=function(e){var r=e.pageBorderBoxWithDroppableScroll,t=e.draggable,n=e.destination,a=e.insideDestination,o=e.last,i=e.viewport,s=e.afterCritical,c=n.axis,g=$r(n.axis,t.displaceBy),f=g.value,d=r[c.start],u=r[c.end],m=xt(t,a),p=sr(m,function(h){var C=h.descriptor.id,I=h.page.borderBox.center[c.line],P=ir(C,s),N=Wa({displaced:o,id:C});return P?N?u<=I:d<I-f:N?u<=I+f:d<I}),w=fl({draggable:t,closest:p,inHomeList:Ir(t,n)});return ft({draggable:t,insideDestination:a,destination:n,viewport:i,last:o,displacedBy:g,index:w})},vl=4,hl=function(e){var r=e.draggable,t=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,a=e.destination,o=e.insideDestination,i=e.afterCritical;if(!a.isCombineEnabled)return null;var s=a.axis,c=$r(a.axis,r.displaceBy),g=c.value,f=t[s.start],d=t[s.end],u=xt(r,o),m=sr(u,function(w){var h=w.descriptor.id,C=w.page.borderBox,I=C[s.size],P=I/vl,N=ir(h,i),M=Wa({displaced:n.displaced,id:h});return N?M?d>C[s.start]+P&&d<C[s.end]-P:f>C[s.start]-g+P&&f<C[s.end]-g-P:M?d>C[s.start]+g+P&&d<C[s.end]+g-P:f>C[s.start]+P&&f<C[s.end]-P});if(!m)return null;var p={displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:a.descriptor.id}}};return p},Va=function(e){var r=e.pageOffset,t=e.draggable,n=e.draggables,a=e.droppables,o=e.previousImpact,i=e.viewport,s=e.afterCritical,c=Ha(t.page.borderBox,r),g=gl({pageBorderBox:c,draggable:t,droppables:a});if(!g)return js;var f=a[g],d=Er(f.descriptor.id,n),u=pl(f,c);return hl({pageBorderBoxWithDroppableScroll:u,draggable:t,previousImpact:o,destination:f,insideDestination:d,afterCritical:s})||ml({pageBorderBoxWithDroppableScroll:u,draggable:t,destination:f,insideDestination:d,last:o.displaced,viewport:i,afterCritical:s})},sn=function(e,r){var t;return H({},e,(t={},t[r.descriptor.id]=r,t))},bl=function(r){var t=r.previousImpact,n=r.impact,a=r.droppables,o=ke(t),i=ke(n);if(!o||o===i)return a;var s=a[o];if(!s.subject.withPlaceholder)return a;var c=ol(s);return sn(a,c)},xl=function(e){var r=e.draggable,t=e.draggables,n=e.droppables,a=e.previousImpact,o=e.impact,i=bl({previousImpact:a,impact:o,droppables:n}),s=ke(o);if(!s)return i;var c=n[s];if(Ir(r,c)||c.subject.withPlaceholder)return i;var g=za(c,r,t);return sn(i,g)},Br=function(e){var r=e.state,t=e.clientSelection,n=e.dimensions,a=e.viewport,o=e.impact,i=e.scrollJumpRequest,s=a||r.viewport,c=n||r.dimensions,g=t||r.current.client.selection,f=Pe(g,r.initial.client.selection),d={offset:f,selection:g,borderBoxCenter:Ce(r.initial.client.borderBoxCenter,f)},u={selection:Ce(d.selection,s.scroll.current),borderBoxCenter:Ce(d.borderBoxCenter,s.scroll.current),offset:Ce(d.offset,s.scroll.diff.value)},m={client:d,page:u};if(r.phase==="COLLECTING")return H({phase:"COLLECTING"},r,{dimensions:c,viewport:s,current:m});var p=c.draggables[r.critical.draggable.id],w=o||Va({pageOffset:u.offset,draggable:p,draggables:c.draggables,droppables:c.droppables,previousImpact:r.impact,viewport:s,afterCritical:r.afterCritical}),h=xl({draggable:p,impact:w,previousImpact:r.impact,draggables:c.draggables,droppables:c.droppables}),C=H({},r,{current:m,dimensions:{draggables:c.draggables,droppables:h},impact:w,viewport:s,scrollJumpRequest:i||null,forceShouldAnimate:i?!1:null});return C};function yl(e,r){return e.map(function(t){return r[t]})}var qa=function(e){var r=e.impact,t=e.viewport,n=e.draggables,a=e.destination,o=e.forceShouldAnimate,i=r.displaced,s=yl(i.all,n),c=Gr({afterDragging:s,destination:a,displacedBy:r.displacedBy,viewport:t.frame,forceShouldAnimate:o,last:i});return H({},r,{displaced:c})},Ka=function(e){var r=e.impact,t=e.draggable,n=e.droppable,a=e.draggables,o=e.viewport,i=e.afterCritical,s=yt({impact:r,draggable:t,draggables:a,droppable:n,afterCritical:i});return on({pageBorderBoxCenter:s,draggable:t,viewport:o})},Ya=function(e){var r=e.state,t=e.dimensions,n=e.viewport;r.movementMode!=="SNAP"&&j();var a=r.impact,o=n||r.viewport,i=t||r.dimensions,s=i.draggables,c=i.droppables,g=s[r.critical.draggable.id],f=ke(a);f||j();var d=c[f],u=qa({impact:a,viewport:o,destination:d,draggables:s}),m=Ka({impact:u,draggable:g,droppable:d,draggables:s,viewport:o,afterCritical:r.afterCritical});return Br({impact:u,clientSelection:m,state:r,dimensions:i,viewport:o})},wl=function(e){return{index:e.index,droppableId:e.droppableId}},Xa=function(e){var r=e.draggable,t=e.home,n=e.draggables,a=e.viewport,o=$r(t.axis,r.displaceBy),i=Er(t.descriptor.id,n),s=i.indexOf(r);s===-1&&j();var c=i.slice(s+1),g=c.reduce(function(m,p){return m[p.descriptor.id]=!0,m},{}),f={inVirtualList:t.descriptor.mode==="virtual",displacedBy:o,effected:g},d=Gr({afterDragging:c,destination:t,displacedBy:o,last:null,viewport:a.frame,forceShouldAnimate:!1}),u={displaced:d,displacedBy:o,at:{type:"REORDER",destination:wl(r.descriptor)}};return{impact:u,afterCritical:f}},Cl=function(e,r){return{draggables:e.draggables,droppables:sn(e.droppables,r)}},Sl=function(e){var r=e.draggable,t=e.offset,n=e.initialWindowScroll,a=ct(r.client,t),o=dt(a,n),i=H({},r,{placeholder:H({},r.placeholder,{client:a}),client:a,page:o});return i},El=function(e){var r=e.frame;return r||j(),r},Il=function(e){var r=e.additions,t=e.updatedDroppables,n=e.viewport,a=n.scroll.diff.value;return r.map(function(o){var i=o.descriptor.droppableId,s=t[i],c=El(s),g=c.scroll.diff.value,f=Ce(a,g),d=Sl({draggable:o,offset:f,initialWindowScroll:n.scroll.initial});return d})},Nl=function(e){var r=e.state,t=e.published,n=t.modified.map(function(P){var N=r.dimensions.droppables[P.droppableId],M=_t(N,P.scroll);return M}),a=H({},r.dimensions.droppables,{},ja(n)),o=Ra(Il({additions:t.additions,updatedDroppables:a,viewport:r.viewport})),i=H({},r.dimensions.draggables,{},o);t.removals.forEach(function(P){delete i[P]});var s={droppables:a,draggables:i},c=ke(r.impact),g=c?s.droppables[c]:null,f=s.draggables[r.critical.draggable.id],d=s.droppables[r.critical.droppable.id],u=Xa({draggable:f,home:d,draggables:i,viewport:r.viewport}),m=u.impact,p=u.afterCritical,w=g&&g.isCombineEnabled?r.impact:m,h=Va({pageOffset:r.current.page.offset,draggable:s.draggables[r.critical.draggable.id],draggables:s.draggables,droppables:s.droppables,previousImpact:w,viewport:r.viewport,afterCritical:p}),C=H({phase:"DRAGGING"},r,{phase:"DRAGGING",impact:h,onLiftImpact:m,dimensions:s,afterCritical:p,forceShouldAnimate:!1});if(r.phase==="COLLECTING")return C;var I=H({phase:"DROP_PENDING"},C,{phase:"DROP_PENDING",reason:r.reason,isWaiting:!1});return I},Wt=function(r){return r.movementMode==="SNAP"},Tt=function(r,t,n){var a=Cl(r.dimensions,t);return!Wt(r)||n?Br({state:r,dimensions:a}):Ya({state:r,dimensions:a})};function Bt(e){return e.isDragging&&e.movementMode==="SNAP"?H({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var Kn={phase:"IDLE",completed:null,shouldFlush:!1},Dl=function(e,r){if(e===void 0&&(e=Kn),r.type==="FLUSH")return H({},Kn,{shouldFlush:!0});if(r.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&j();var t=r.payload,n=t.critical,a=t.clientSelection,o=t.viewport,i=t.dimensions,s=t.movementMode,c=i.draggables[n.draggable.id],g=i.droppables[n.droppable.id],f={selection:a,borderBoxCenter:c.client.borderBox.center,offset:ye},d={client:f,page:{selection:Ce(f.selection,o.scroll.initial),borderBoxCenter:Ce(f.selection,o.scroll.initial),offset:Ce(f.selection,o.scroll.diff.value)}},u=ht(i.droppables).every(function(Re){return!Re.isFixedOnPage}),m=Xa({draggable:c,home:g,draggables:i.draggables,viewport:o}),p=m.impact,w=m.afterCritical,h={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:s,dimensions:i,initial:d,current:d,isWindowScrollAllowed:u,impact:p,afterCritical:w,onLiftImpact:p,viewport:o,scrollJumpRequest:null,forceShouldAnimate:null};return h}if(r.type==="COLLECTION_STARTING"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&j();var C=H({phase:"COLLECTING"},e,{phase:"COLLECTING"});return C}if(r.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||j(),Nl({state:e,published:r.payload});if(r.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;ur(e)||j();var I=r.payload.client;return ar(I,e.current.client.selection)?e:Br({state:e,clientSelection:I,impact:Wt(e)?e.impact:null})}if(r.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return Bt(e);ur(e)||j();var P=r.payload,N=P.id,M=P.newScroll,B=e.dimensions.droppables[N];if(!B)return e;var z=_t(B,M);return Tt(e,z,!1)}if(r.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;ur(e)||j();var _=r.payload,V=_.id,ee=_.isEnabled,K=e.dimensions.droppables[V];K||j(),K.isEnabled===ee&&j();var le=H({},K,{isEnabled:ee});return Tt(e,le,!0)}if(r.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;ur(e)||j();var T=r.payload,$=T.id,ge=T.isCombineEnabled,k=e.dimensions.droppables[$];k||j(),k.isCombineEnabled===ge&&j();var X=H({},k,{isCombineEnabled:ge});return Tt(e,X,!0)}if(r.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;ur(e)||j(),e.isWindowScrollAllowed||j();var ce=r.payload.newScroll;if(ar(e.viewport.scroll.current,ce))return Bt(e);var J=Fa(e.viewport,ce);return Wt(e)?Ya({state:e,viewport:J}):Br({state:e,viewport:J})}if(r.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!ur(e))return e;var oe=r.payload.maxScroll;if(ar(oe,e.viewport.scroll.max))return e;var me=H({},e.viewport,{scroll:H({},e.viewport.scroll,{max:oe})});return H({phase:"DRAGGING"},e,{viewport:me})}if(r.type==="MOVE_UP"||r.type==="MOVE_DOWN"||r.type==="MOVE_LEFT"||r.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&j();var he=cl({state:e,type:r.type});return he?Br({state:e,impact:he.impact,clientSelection:he.clientSelection,scrollJumpRequest:he.scrollJumpRequest}):e}if(r.type==="DROP_PENDING"){var ve=r.payload.reason;e.phase!=="COLLECTING"&&j();var Y=H({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:ve});return Y}if(r.type==="DROP_ANIMATE"){var Ne=r.payload,Se=Ne.completed,De=Ne.dropDuration,$e=Ne.newHomeClientOffset;e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||j();var Xe={phase:"DROP_ANIMATING",completed:Se,dropDuration:De,newHomeClientOffset:$e,dimensions:e.dimensions};return Xe}if(r.type==="DROP_COMPLETE"){var Ge=r.payload.completed;return{phase:"IDLE",completed:Ge,shouldFlush:!1}}return e},Al=function(r){return{type:"BEFORE_INITIAL_CAPTURE",payload:r}},Pl=function(r){return{type:"LIFT",payload:r}},kl=function(r){return{type:"INITIAL_PUBLISH",payload:r}},jl=function(r){return{type:"PUBLISH_WHILE_DRAGGING",payload:r}},Rl=function(){return{type:"COLLECTION_STARTING",payload:null}},Tl=function(r){return{type:"UPDATE_DROPPABLE_SCROLL",payload:r}},Bl=function(r){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:r}},Ol=function(r){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:r}},Ja=function(r){return{type:"MOVE",payload:r}},Ml=function(r){return{type:"MOVE_BY_WINDOW_SCROLL",payload:r}},Ll=function(r){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:r}},Fl=function(){return{type:"MOVE_UP",payload:null}},Gl=function(){return{type:"MOVE_DOWN",payload:null}},Ul=function(){return{type:"MOVE_RIGHT",payload:null}},zl=function(){return{type:"MOVE_LEFT",payload:null}},ln=function(){return{type:"FLUSH",payload:null}},$l=function(r){return{type:"DROP_ANIMATE",payload:r}},cn=function(r){return{type:"DROP_COMPLETE",payload:r}},Qa=function(r){return{type:"DROP",payload:r}},Hl=function(r){return{type:"DROP_PENDING",payload:r}},Za=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},Wl=function(e){return function(r){var t=r.getState,n=r.dispatch;return function(a){return function(o){if(o.type!=="LIFT"){a(o);return}var i=o.payload,s=i.id,c=i.clientSelection,g=i.movementMode,f=t();f.phase==="DROP_ANIMATING"&&n(cn({completed:f.completed})),t().phase!=="IDLE"&&j(),n(ln()),n(Al({draggableId:s,movementMode:g}));var d={shouldPublishImmediately:g==="SNAP"},u={draggableId:s,scrollOptions:d},m=e.startPublishing(u),p=m.critical,w=m.dimensions,h=m.viewport;n(kl({critical:p,dimensions:w,clientSelection:c,movementMode:g,viewport:h}))}}}},Vl=function(e){return function(){return function(r){return function(t){t.type==="INITIAL_PUBLISH"&&e.dragging(),t.type==="DROP_ANIMATE"&&e.dropping(t.payload.completed.result.reason),(t.type==="FLUSH"||t.type==="DROP_COMPLETE")&&e.resting(),r(t)}}}},dn={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},Ur={opacity:{drop:0,combining:.7},scale:{drop:.75}},un={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},dr=un.outOfTheWay+"s "+dn.outOfTheWay,Or={fluid:"opacity "+dr,snap:"transform "+dr+", opacity "+dr,drop:function(r){var t=r+"s "+dn.drop;return"transform "+t+", opacity "+t},outOfTheWay:"transform "+dr,placeholder:"height "+dr+", width "+dr+", margin "+dr},Yn=function(r){return ar(r,ye)?null:"translate("+r.x+"px, "+r.y+"px)"},Vt={moveTo:Yn,drop:function(r,t){var n=Yn(r);return n?t?n+" scale("+Ur.scale.drop+")":n:null}},qt=un.minDropTime,_a=un.maxDropTime,ql=_a-qt,Xn=1500,Kl=.6,Yl=function(e){var r=e.current,t=e.destination,n=e.reason,a=Lr(r,t);if(a<=0)return qt;if(a>=Xn)return _a;var o=a/Xn,i=qt+ql*o,s=n==="CANCEL"?i*Kl:i;return Number(s.toFixed(2))},Xl=function(e){var r=e.impact,t=e.draggable,n=e.dimensions,a=e.viewport,o=e.afterCritical,i=n.draggables,s=n.droppables,c=ke(r),g=c?s[c]:null,f=s[t.descriptor.droppableId],d=Ka({impact:r,draggable:t,draggables:i,afterCritical:o,droppable:g||f,viewport:a}),u=Pe(d,t.client.borderBox.center);return u},Jl=function(e){var r=e.draggables,t=e.reason,n=e.lastImpact,a=e.home,o=e.viewport,i=e.onLiftImpact;if(!n.at||t!=="DROP"){var s=qa({draggables:r,impact:i,destination:a,viewport:o,forceShouldAnimate:!0});return{impact:s,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var c=H({},n,{displaced:Fr});return{impact:c,didDropInsideDroppable:!0}},Ql=function(e){var r=e.getState,t=e.dispatch;return function(n){return function(a){if(a.type!=="DROP"){n(a);return}var o=r(),i=a.payload.reason;if(o.phase==="COLLECTING"){t(Hl({reason:i}));return}if(o.phase!=="IDLE"){var s=o.phase==="DROP_PENDING"&&o.isWaiting;s&&j(),o.phase==="DRAGGING"||o.phase==="DROP_PENDING"||j();var c=o.critical,g=o.dimensions,f=g.draggables[o.critical.draggable.id],d=Jl({reason:i,lastImpact:o.impact,afterCritical:o.afterCritical,onLiftImpact:o.onLiftImpact,home:o.dimensions.droppables[o.critical.droppable.id],viewport:o.viewport,draggables:o.dimensions.draggables}),u=d.impact,m=d.didDropInsideDroppable,p=m?rn(u):null,w=m?bt(u):null,h={index:c.draggable.index,droppableId:c.droppable.id},C={draggableId:f.descriptor.id,type:f.descriptor.type,source:h,reason:i,mode:o.movementMode,destination:p,combine:w},I=Xl({impact:u,draggable:f,dimensions:g,viewport:o.viewport,afterCritical:o.afterCritical}),P={critical:o.critical,afterCritical:o.afterCritical,result:C,impact:u},N=!ar(o.current.client.offset,I)||!!C.combine;if(!N){t(cn({completed:P}));return}var M=Yl({current:o.current.client.offset,destination:I,reason:i}),B={newHomeClientOffset:I,dropDuration:M,completed:P};t($l(B))}}}},eo=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function Zl(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(t){t.target!==window&&t.target!==window.document||e()}}}function _l(e){var r=e.onWindowScroll;function t(){r(eo())}var n=Mr(t),a=Zl(n),o=nr;function i(){return o!==nr}function s(){i()&&j(),o=Le(window,[a])}function c(){i()||j(),n.cancel(),o(),o=nr}return{start:s,stop:c,isActive:i}}var ec=function(r){return r.type==="DROP_COMPLETE"||r.type==="DROP_ANIMATE"||r.type==="FLUSH"},rc=function(e){var r=_l({onWindowScroll:function(n){e.dispatch(Ml({newScroll:n}))}});return function(t){return function(n){!r.isActive()&&n.type==="INITIAL_PUBLISH"&&r.start(),r.isActive()&&ec(n)&&r.stop(),t(n)}}},tc=function(e){var r=!1,t=!1,n=setTimeout(function(){t=!0}),a=function(i){r||t||(r=!0,e(i),clearTimeout(n))};return a.wasCalled=function(){return r},a},nc=function(){var e=[],r=function(o){var i=en(e,function(g){return g.timerId===o});i===-1&&j();var s=e.splice(i,1),c=s[0];c.callback()},t=function(o){var i=setTimeout(function(){return r(i)}),s={timerId:i,callback:o};e.push(s)},n=function(){if(e.length){var o=[].concat(e);e.length=0,o.forEach(function(i){clearTimeout(i.timerId),i.callback()})}};return{add:t,flush:n}},ac=function(r,t){return r==null&&t==null?!0:r==null||t==null?!1:r.droppableId===t.droppableId&&r.index===t.index},oc=function(r,t){return r==null&&t==null?!0:r==null||t==null?!1:r.draggableId===t.draggableId&&r.droppableId===t.droppableId},ic=function(r,t){if(r===t)return!0;var n=r.draggable.id===t.draggable.id&&r.draggable.droppableId===t.draggable.droppableId&&r.draggable.type===t.draggable.type&&r.draggable.index===t.draggable.index,a=r.droppable.id===t.droppable.id&&r.droppable.type===t.droppable.type;return n&&a},kr=function(r,t){t()},tt=function(r,t){return{draggableId:r.draggable.id,type:r.droppable.type,source:{droppableId:r.droppable.id,index:r.draggable.index},mode:t}},Ot=function(r,t,n,a){if(!r){n(a(t));return}var o=tc(n),i={announce:o};r(t,i),o.wasCalled()||n(a(t))},sc=function(e,r){var t=nc(),n=null,a=function(u,m){n&&j(),kr("onBeforeCapture",function(){var p=e().onBeforeCapture;if(p){var w={draggableId:u,mode:m};p(w)}})},o=function(u,m){n&&j(),kr("onBeforeDragStart",function(){var p=e().onBeforeDragStart;p&&p(tt(u,m))})},i=function(u,m){n&&j();var p=tt(u,m);n={mode:m,lastCritical:u,lastLocation:p.source,lastCombine:null},t.add(function(){kr("onDragStart",function(){return Ot(e().onDragStart,p,r,st.onDragStart)})})},s=function(u,m){var p=rn(m),w=bt(m);n||j();var h=!ic(u,n.lastCritical);h&&(n.lastCritical=u);var C=!ac(n.lastLocation,p);C&&(n.lastLocation=p);var I=!oc(n.lastCombine,w);if(I&&(n.lastCombine=w),!(!h&&!C&&!I)){var P=H({},tt(u,n.mode),{combine:w,destination:p});t.add(function(){kr("onDragUpdate",function(){return Ot(e().onDragUpdate,P,r,st.onDragUpdate)})})}},c=function(){n||j(),t.flush()},g=function(u){n||j(),n=null,kr("onDragEnd",function(){return Ot(e().onDragEnd,u,r,st.onDragEnd)})},f=function(){if(n){var u=H({},tt(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});g(u)}};return{beforeCapture:a,beforeStart:o,start:i,update:s,flush:c,drop:g,abort:f}},lc=function(e,r){var t=sc(e,r);return function(n){return function(a){return function(o){if(o.type==="BEFORE_INITIAL_CAPTURE"){t.beforeCapture(o.payload.draggableId,o.payload.movementMode);return}if(o.type==="INITIAL_PUBLISH"){var i=o.payload.critical;t.beforeStart(i,o.payload.movementMode),a(o),t.start(i,o.payload.movementMode);return}if(o.type==="DROP_COMPLETE"){var s=o.payload.completed.result;t.flush(),a(o),t.drop(s);return}if(a(o),o.type==="FLUSH"){t.abort();return}var c=n.getState();c.phase==="DRAGGING"&&t.update(c.critical,c.impact)}}}},cc=function(e){return function(r){return function(t){if(t.type!=="DROP_ANIMATION_FINISHED"){r(t);return}var n=e.getState();n.phase!=="DROP_ANIMATING"&&j(),e.dispatch(cn({completed:n.completed}))}}},dc=function(e){var r=null,t=null;function n(){t&&(cancelAnimationFrame(t),t=null),r&&(r(),r=null)}return function(a){return function(o){if((o.type==="FLUSH"||o.type==="DROP_COMPLETE"||o.type==="DROP_ANIMATION_FINISHED")&&n(),a(o),o.type==="DROP_ANIMATE"){var i={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var c=e.getState();c.phase==="DROP_ANIMATING"&&e.dispatch(Za())}};t=requestAnimationFrame(function(){t=null,r=Le(window,[i])})}}}},uc=function(e){return function(){return function(r){return function(t){(t.type==="DROP_COMPLETE"||t.type==="FLUSH"||t.type==="DROP_ANIMATE")&&e.stopPublishing(),r(t)}}}},gc=function(e){var r=!1;return function(){return function(t){return function(n){if(n.type==="INITIAL_PUBLISH"){r=!0,e.tryRecordFocus(n.payload.critical.draggable.id),t(n),e.tryRestoreFocusRecorded();return}if(t(n),!!r){if(n.type==="FLUSH"){r=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){r=!1;var a=n.payload.completed.result;a.combine&&e.tryShiftRecord(a.draggableId,a.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}},pc=function(r){return r.type==="DROP_COMPLETE"||r.type==="DROP_ANIMATE"||r.type==="FLUSH"},fc=function(e){return function(r){return function(t){return function(n){if(pc(n)){e.stop(),t(n);return}if(n.type==="INITIAL_PUBLISH"){t(n);var a=r.getState();a.phase!=="DRAGGING"&&j(),e.start(a);return}t(n),e.scroll(r.getState())}}}},mc=function(e){return function(r){return function(t){if(r(t),t.type==="PUBLISH_WHILE_DRAGGING"){var n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(Qa({reason:n.reason})))}}}},vc=No,hc=function(e){var r=e.dimensionMarshal,t=e.focusMarshal,n=e.styleMarshal,a=e.getResponders,o=e.announce,i=e.autoScroller;return Io(Dl,vc(Do(Vl(n),uc(r),Wl(r),Ql,cc,dc,mc,fc(i),rc,gc(t),lc(a,o))))},Mt=function(){return{additions:{},removals:{},modified:{}}};function bc(e){var r=e.registry,t=e.callbacks,n=Mt(),a=null,o=function(){a||(t.collectionStarting(),a=requestAnimationFrame(function(){a=null;var f=n,d=f.additions,u=f.removals,m=f.modified,p=Object.keys(d).map(function(C){return r.draggable.getById(C).getDimension(ye)}).sort(function(C,I){return C.descriptor.index-I.descriptor.index}),w=Object.keys(m).map(function(C){var I=r.droppable.getById(C),P=I.callbacks.getScrollWhileDragging();return{droppableId:C,scroll:P}}),h={additions:p,removals:Object.keys(u),modified:w};n=Mt(),t.publish(h)}))},i=function(f){var d=f.descriptor.id;n.additions[d]=f,n.modified[f.descriptor.droppableId]=!0,n.removals[d]&&delete n.removals[d],o()},s=function(f){var d=f.descriptor;n.removals[d.id]=!0,n.modified[d.droppableId]=!0,n.additions[d.id]&&delete n.additions[d.id],o()},c=function(){a&&(cancelAnimationFrame(a),a=null,n=Mt())};return{add:i,remove:s,stop:c}}var ro=function(e){var r=e.scrollHeight,t=e.scrollWidth,n=e.height,a=e.width,o=Pe({x:t,y:r},{x:a,y:n}),i={x:Math.max(0,o.x),y:Math.max(0,o.y)};return i},to=function(){var e=document.documentElement;return e||j(),e},no=function(){var e=to(),r=ro({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight});return r},xc=function(){var e=eo(),r=no(),t=e.y,n=e.x,a=to(),o=a.clientWidth,i=a.clientHeight,s=n+o,c=t+i,g=ze({top:t,left:n,right:s,bottom:c}),f={frame:g,scroll:{initial:e,current:e,max:r,diff:{value:ye,displacement:ye}}};return f},yc=function(e){var r=e.critical,t=e.scrollOptions,n=e.registry,a=xc(),o=a.scroll.current,i=r.droppable,s=n.droppable.getAllByType(i.type).map(function(d){return d.callbacks.getDimensionAndWatchScroll(o,t)}),c=n.draggable.getAllByType(r.draggable.type).map(function(d){return d.getDimension(o)}),g={draggables:Ra(c),droppables:ja(s)},f={dimensions:g,critical:r,viewport:a};return f};function Jn(e,r,t){if(t.descriptor.id===r.id||t.descriptor.type!==r.type)return!1;var n=e.droppable.getById(t.descriptor.droppableId);return n.descriptor.mode==="virtual"}var wc=function(e,r){var t=null,n=bc({callbacks:{publish:r.publishWhileDragging,collectionStarting:r.collectionStarting},registry:e}),a=function(m,p){e.droppable.exists(m)||j(),t&&r.updateDroppableIsEnabled({id:m,isEnabled:p})},o=function(m,p){t&&(e.droppable.exists(m)||j(),r.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:p}))},i=function(m,p){t&&(e.droppable.exists(m)||j(),r.updateDroppableScroll({id:m,newScroll:p}))},s=function(m,p){t&&e.droppable.getById(m).callbacks.scroll(p)},c=function(){if(t){n.stop();var m=t.critical.droppable;e.droppable.getAllByType(m.type).forEach(function(p){return p.callbacks.dragStopped()}),t.unsubscribe(),t=null}},g=function(m){t||j();var p=t.critical.draggable;m.type==="ADDITION"&&Jn(e,p,m.value)&&n.add(m.value),m.type==="REMOVAL"&&Jn(e,p,m.value)&&n.remove(m.value)},f=function(m){t&&j();var p=e.draggable.getById(m.draggableId),w=e.droppable.getById(p.descriptor.droppableId),h={draggable:p.descriptor,droppable:w.descriptor},C=e.subscribe(g);return t={critical:h,unsubscribe:C},yc({critical:h,registry:e,scrollOptions:m.scrollOptions})},d={updateDroppableIsEnabled:a,updateDroppableIsCombineEnabled:o,scrollDroppable:s,updateDroppableScroll:i,startPublishing:f,stopPublishing:c};return d},ao=function(e,r){return e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===r?!1:e.completed.result.reason==="DROP"},Cc=function(e){window.scrollBy(e.x,e.y)},Sc=xe(function(e){return ht(e).filter(function(r){return!(!r.isEnabled||!r.frame)})}),Ec=function(r,t){var n=sr(Sc(t),function(a){return a.frame||j(),$a(a.frame.pageMarginBox)(r)});return n},Ic=function(e){var r=e.center,t=e.destination,n=e.droppables;if(t){var a=n[t];return a.frame?a:null}var o=Ec(r,n);return o},or={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(r){return Math.pow(r,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},Nc=function(e,r){var t=e[r.size]*or.startFromPercentage,n=e[r.size]*or.maxScrollAtPercentage,a={startScrollingFrom:t,maxScrollValueAt:n};return a},oo=function(e){var r=e.startOfRange,t=e.endOfRange,n=e.current,a=t-r;if(a===0)return 0;var o=n-r,i=o/a;return i},gn=1,Dc=function(e,r){if(e>r.startScrollingFrom)return 0;if(e<=r.maxScrollValueAt)return or.maxPixelScroll;if(e===r.startScrollingFrom)return gn;var t=oo({startOfRange:r.maxScrollValueAt,endOfRange:r.startScrollingFrom,current:e}),n=1-t,a=or.maxPixelScroll*or.ease(n);return Math.ceil(a)},Qn=or.durationDampening.accelerateAt,Zn=or.durationDampening.stopDampeningAt,Ac=function(e,r){var t=r,n=Zn,a=Date.now(),o=a-t;if(o>=Zn)return e;if(o<Qn)return gn;var i=oo({startOfRange:Qn,endOfRange:n,current:o}),s=e*or.ease(i);return Math.ceil(s)},_n=function(e){var r=e.distanceToEdge,t=e.thresholds,n=e.dragStartTime,a=e.shouldUseTimeDampening,o=Dc(r,t);return o===0?0:a?Math.max(Ac(o,n),gn):o},ea=function(e){var r=e.container,t=e.distanceToEdges,n=e.dragStartTime,a=e.axis,o=e.shouldUseTimeDampening,i=Nc(r,a),s=t[a.end]<t[a.start];return s?_n({distanceToEdge:t[a.end],thresholds:i,dragStartTime:n,shouldUseTimeDampening:o}):-1*_n({distanceToEdge:t[a.start],thresholds:i,dragStartTime:n,shouldUseTimeDampening:o})},Pc=function(e){var r=e.container,t=e.subject,n=e.proposedScroll,a=t.height>r.height,o=t.width>r.width;return!o&&!a?n:o&&a?null:{x:o?0:n.x,y:a?0:n.y}},kc=Pa(function(e){return e===0?0:e}),io=function(e){var r=e.dragStartTime,t=e.container,n=e.subject,a=e.center,o=e.shouldUseTimeDampening,i={top:a.y-t.top,right:t.right-a.x,bottom:t.bottom-a.y,left:a.x-t.left},s=ea({container:t,distanceToEdges:i,dragStartTime:r,axis:tn,shouldUseTimeDampening:o}),c=ea({container:t,distanceToEdges:i,dragStartTime:r,axis:Oa,shouldUseTimeDampening:o}),g=kc({x:c,y:s});if(ar(g,ye))return null;var f=Pc({container:t,subject:n,proposedScroll:g});return f?ar(f,ye)?null:f:null},jc=Pa(function(e){return e===0?0:e>0?1:-1}),pn=function(){var e=function(t,n){return t<0?t:t>n?t-n:0};return function(r){var t=r.current,n=r.max,a=r.change,o=Ce(t,a),i={x:e(o.x,n.x),y:e(o.y,n.y)};return ar(i,ye)?null:i}}(),so=function(r){var t=r.max,n=r.current,a=r.change,o={x:Math.max(n.x,t.x),y:Math.max(n.y,t.y)},i=jc(a),s=pn({max:o,current:n,change:i});return!s||i.x!==0&&s.x===0||i.y!==0&&s.y===0},fn=function(r,t){return so({current:r.scroll.current,max:r.scroll.max,change:t})},Rc=function(r,t){if(!fn(r,t))return null;var n=r.scroll.max,a=r.scroll.current;return pn({current:a,max:n,change:t})},mn=function(r,t){var n=r.frame;return n?so({current:n.scroll.current,max:n.scroll.max,change:t}):!1},Tc=function(r,t){var n=r.frame;return!n||!mn(r,t)?null:pn({current:n.scroll.current,max:n.scroll.max,change:t})},Bc=function(e){var r=e.viewport,t=e.subject,n=e.center,a=e.dragStartTime,o=e.shouldUseTimeDampening,i=io({dragStartTime:a,container:r.frame,subject:t,center:n,shouldUseTimeDampening:o});return i&&fn(r,i)?i:null},Oc=function(e){var r=e.droppable,t=e.subject,n=e.center,a=e.dragStartTime,o=e.shouldUseTimeDampening,i=r.frame;if(!i)return null;var s=io({dragStartTime:a,container:i.pageMarginBox,subject:t,center:n,shouldUseTimeDampening:o});return s&&mn(r,s)?s:null},ra=function(e){var r=e.state,t=e.dragStartTime,n=e.shouldUseTimeDampening,a=e.scrollWindow,o=e.scrollDroppable,i=r.current.page.borderBoxCenter,s=r.dimensions.draggables[r.critical.draggable.id],c=s.page.marginBox;if(r.isWindowScrollAllowed){var g=r.viewport,f=Bc({dragStartTime:t,viewport:g,subject:c,center:i,shouldUseTimeDampening:n});if(f){a(f);return}}var d=Ic({center:i,destination:ke(r.impact),droppables:r.dimensions.droppables});if(d){var u=Oc({dragStartTime:t,droppable:d,subject:c,center:i,shouldUseTimeDampening:n});u&&o(d.descriptor.id,u)}},Mc=function(e){var r=e.scrollWindow,t=e.scrollDroppable,n=Mr(r),a=Mr(t),o=null,i=function(f){o||j();var d=o,u=d.shouldUseTimeDampening,m=d.dragStartTime;ra({state:f,scrollWindow:n,scrollDroppable:a,dragStartTime:m,shouldUseTimeDampening:u})},s=function(f){o&&j();var d=Date.now(),u=!1,m=function(){u=!0};ra({state:f,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m}),o={dragStartTime:d,shouldUseTimeDampening:u},u&&i(f)},c=function(){o&&(n.cancel(),a.cancel(),o=null)};return{start:s,stop:c,scroll:i}},Lc=function(e){var r=e.move,t=e.scrollDroppable,n=e.scrollWindow,a=function(g,f){var d=Ce(g.current.client.selection,f);r({client:d})},o=function(g,f){if(!mn(g,f))return f;var d=Tc(g,f);if(!d)return t(g.descriptor.id,f),null;var u=Pe(f,d);t(g.descriptor.id,u);var m=Pe(f,u);return m},i=function(g,f,d){if(!g||!fn(f,d))return d;var u=Rc(f,d);if(!u)return n(d),null;var m=Pe(d,u);n(m);var p=Pe(d,m);return p},s=function(g){var f=g.scrollJumpRequest;if(f){var d=ke(g.impact);d||j();var u=o(g.dimensions.droppables[d],f);if(u){var m=g.viewport,p=i(g.isWindowScrollAllowed,m,u);p&&a(g,p)}}};return s},Fc=function(e){var r=e.scrollDroppable,t=e.scrollWindow,n=e.move,a=Mc({scrollWindow:t,scrollDroppable:r}),o=Lc({move:n,scrollWindow:t,scrollDroppable:r}),i=function(g){if(g.phase==="DRAGGING"){if(g.movementMode==="FLUID"){a.scroll(g);return}g.scrollJumpRequest&&o(g)}},s={scroll:i,start:a.start,stop:a.stop};return s},wr="data-rbd",Cr=function(){var e=wr+"-drag-handle";return{base:e,draggableId:e+"-draggable-id",contextId:e+"-context-id"}}(),Kt=function(){var e=wr+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Gc=function(){var e=wr+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),ta={contextId:wr+"-scroll-container-context-id"},Uc=function(r){return function(t){return"["+t+'="'+r+'"]'}},jr=function(r,t){return r.map(function(n){var a=n.styles[t];return a?n.selector+" { "+a+" }":""}).join(" ")},zc="pointer-events: none;",$c=function(e){var r=Uc(e),t=function(){var s=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:r(Cr.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:s,dragging:zc,dropAnimating:s}}}(),n=function(){var s=`
      transition: `+Or.outOfTheWay+`;
    `;return{selector:r(Kt.contextId),styles:{dragging:s,dropAnimating:s,userCancel:s}}}(),a={selector:r(Gc.contextId),styles:{always:"overflow-anchor: none;"}},o={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},i=[n,t,a,o];return{always:jr(i,"always"),resting:jr(i,"resting"),dragging:jr(i,"dragging"),dropAnimating:jr(i,"dropAnimating"),userCancel:jr(i,"userCancel")}},je=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?y.useLayoutEffect:y.useEffect,Lt=function(){var r=document.querySelector("head");return r||j(),r},na=function(r){var t=document.createElement("style");return r&&t.setAttribute("nonce",r),t.type="text/css",t};function Hc(e,r){var t=se(function(){return $c(e)},[e]),n=y.useRef(null),a=y.useRef(null),o=G(xe(function(d){var u=a.current;u||j(),u.textContent=d}),[]),i=G(function(d){var u=n.current;u||j(),u.textContent=d},[]);je(function(){!n.current&&!a.current||j();var d=na(r),u=na(r);return n.current=d,a.current=u,d.setAttribute(wr+"-always",e),u.setAttribute(wr+"-dynamic",e),Lt().appendChild(d),Lt().appendChild(u),i(t.always),o(t.resting),function(){var m=function(w){var h=w.current;h||j(),Lt().removeChild(h),w.current=null};m(n),m(a)}},[r,i,o,t.always,t.resting,e]);var s=G(function(){return o(t.dragging)},[o,t.dragging]),c=G(function(d){if(d==="DROP"){o(t.dropAnimating);return}o(t.userCancel)},[o,t.dropAnimating,t.userCancel]),g=G(function(){a.current&&o(t.resting)},[o,t.resting]),f=se(function(){return{dragging:s,dropping:c,resting:g}},[s,c,g]);return f}var lo=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function wt(e){return e instanceof lo(e).HTMLElement}function Wc(e,r){var t="["+Cr.contextId+'="'+e+'"]',n=ka(document.querySelectorAll(t));if(!n.length)return null;var a=sr(n,function(o){return o.getAttribute(Cr.draggableId)===r});return!a||!wt(a)?null:a}function Vc(e){var r=y.useRef({}),t=y.useRef(null),n=y.useRef(null),a=y.useRef(!1),o=G(function(u,m){var p={id:u,focus:m};return r.current[u]=p,function(){var h=r.current,C=h[u];C!==p&&delete h[u]}},[]),i=G(function(u){var m=Wc(e,u);m&&m!==document.activeElement&&m.focus()},[e]),s=G(function(u,m){t.current===u&&(t.current=m)},[]),c=G(function(){n.current||a.current&&(n.current=requestAnimationFrame(function(){n.current=null;var u=t.current;u&&i(u)}))},[i]),g=G(function(u){t.current=null;var m=document.activeElement;m&&m.getAttribute(Cr.draggableId)===u&&(t.current=u)},[]);je(function(){return a.current=!0,function(){a.current=!1;var u=n.current;u&&cancelAnimationFrame(u)}},[]);var f=se(function(){return{register:o,tryRecordFocus:g,tryRestoreFocusRecorded:c,tryShiftRecord:s}},[o,g,c,s]);return f}function qc(){var e={draggables:{},droppables:{}},r=[];function t(d){return r.push(d),function(){var m=r.indexOf(d);m!==-1&&r.splice(m,1)}}function n(d){r.length&&r.forEach(function(u){return u(d)})}function a(d){return e.draggables[d]||null}function o(d){var u=a(d);return u||j(),u}var i={register:function(u){e.draggables[u.descriptor.id]=u,n({type:"ADDITION",value:u})},update:function(u,m){var p=e.draggables[m.descriptor.id];p&&p.uniqueId===u.uniqueId&&(delete e.draggables[m.descriptor.id],e.draggables[u.descriptor.id]=u)},unregister:function(u){var m=u.descriptor.id,p=a(m);p&&u.uniqueId===p.uniqueId&&(delete e.draggables[m],n({type:"REMOVAL",value:u}))},getById:o,findById:a,exists:function(u){return!!a(u)},getAllByType:function(u){return pt(e.draggables).filter(function(m){return m.descriptor.type===u})}};function s(d){return e.droppables[d]||null}function c(d){var u=s(d);return u||j(),u}var g={register:function(u){e.droppables[u.descriptor.id]=u},unregister:function(u){var m=s(u.descriptor.id);m&&u.uniqueId===m.uniqueId&&delete e.droppables[u.descriptor.id]},getById:c,findById:s,exists:function(u){return!!s(u)},getAllByType:function(u){return pt(e.droppables).filter(function(m){return m.descriptor.type===u})}};function f(){e.draggables={},e.droppables={},r.length=0}return{draggable:i,droppable:g,subscribe:t,clean:f}}function Kc(){var e=se(qc,[]);return y.useEffect(function(){return function(){requestAnimationFrame(e.clean)}},[e]),e}var vn=fe.createContext(null),mt=function(){var e=document.body;return e||j(),e},Yc={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},Xc=function(r){return"rbd-announcement-"+r};function Jc(e){var r=se(function(){return Xc(e)},[e]),t=y.useRef(null);y.useEffect(function(){var o=document.createElement("div");return t.current=o,o.id=r,o.setAttribute("aria-live","assertive"),o.setAttribute("aria-atomic","true"),H(o.style,Yc),mt().appendChild(o),function(){setTimeout(function(){var c=mt();c.contains(o)&&c.removeChild(o),o===t.current&&(t.current=null)})}},[r]);var n=G(function(a){var o=t.current;if(o){o.textContent=a;return}},[]);return n}var Qc=0,Zc={separator:"::"};function hn(e,r){return r===void 0&&(r=Zc),se(function(){return""+e+r.separator+Qc++},[r.separator,e])}function _c(e){var r=e.contextId,t=e.uniqueId;return"rbd-hidden-text-"+r+"-"+t}function ed(e){var r=e.contextId,t=e.text,n=hn("hidden-text",{separator:"-"}),a=se(function(){return _c({contextId:r,uniqueId:n})},[n,r]);return y.useEffect(function(){var i=document.createElement("div");return i.id=a,i.textContent=t,i.style.display="none",mt().appendChild(i),function(){var c=mt();c.contains(i)&&c.removeChild(i)}},[a,t]),a}var Ct=fe.createContext(null);function co(e){var r=y.useRef(e);return y.useEffect(function(){r.current=e}),r}function rd(){var e=null;function r(){return!!e}function t(i){return i===e}function n(i){e&&j();var s={abandon:i};return e=s,s}function a(){e||j(),e=null}function o(){e&&(e.abandon(),a())}return{isClaimed:r,isActive:t,claim:n,release:a,tryAbandon:o}}var td=9,nd=13,bn=27,uo=32,ad=33,od=34,id=35,sd=36,ld=37,cd=38,dd=39,ud=40,nt,gd=(nt={},nt[nd]=!0,nt[td]=!0,nt),go=function(e){gd[e.keyCode]&&e.preventDefault()},St=function(){var e="visibilitychange";if(typeof document>"u")return e;var r=[e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],t=sr(r,function(n){return"on"+n in document});return t||e}(),po=0,aa=5;function pd(e,r){return Math.abs(r.x-e.x)>=aa||Math.abs(r.y-e.y)>=aa}var oa={type:"IDLE"};function fd(e){var r=e.cancel,t=e.completed,n=e.getPhase,a=e.setPhase;return[{eventName:"mousemove",fn:function(i){var s=i.button,c=i.clientX,g=i.clientY;if(s===po){var f={x:c,y:g},d=n();if(d.type==="DRAGGING"){i.preventDefault(),d.actions.move(f);return}d.type!=="PENDING"&&j();var u=d.point;if(pd(u,f)){i.preventDefault();var m=d.actions.fluidLift(f);a({type:"DRAGGING",actions:m})}}}},{eventName:"mouseup",fn:function(i){var s=n();if(s.type!=="DRAGGING"){r();return}i.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:function(i){n().type==="DRAGGING"&&i.preventDefault(),r()}},{eventName:"keydown",fn:function(i){var s=n();if(s.type==="PENDING"){r();return}if(i.keyCode===bn){i.preventDefault(),r();return}go(i)}},{eventName:"resize",fn:r},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&r()}},{eventName:"webkitmouseforcedown",fn:function(i){var s=n();if(s.type==="IDLE"&&j(),s.actions.shouldRespectForcePress()){r();return}i.preventDefault()}},{eventName:St,fn:r}]}function md(e){var r=y.useRef(oa),t=y.useRef(nr),n=se(function(){return{eventName:"mousedown",fn:function(d){if(!d.defaultPrevented&&d.button===po&&!(d.ctrlKey||d.metaKey||d.shiftKey||d.altKey)){var u=e.findClosestDraggableId(d);if(u){var m=e.tryGetLock(u,i,{sourceEvent:d});if(m){d.preventDefault();var p={x:d.clientX,y:d.clientY};t.current(),g(m,p)}}}}}},[e]),a=se(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(d){if(!d.defaultPrevented){var u=e.findClosestDraggableId(d);if(u){var m=e.findOptionsForDraggable(u);m&&(m.shouldRespectForcePress||e.canGetLock(u)&&d.preventDefault())}}}}},[e]),o=G(function(){var d={passive:!1,capture:!0};t.current=Le(window,[a,n],d)},[a,n]),i=G(function(){var f=r.current;f.type!=="IDLE"&&(r.current=oa,t.current(),o())},[o]),s=G(function(){var f=r.current;i(),f.type==="DRAGGING"&&f.actions.cancel({shouldBlockNextClick:!0}),f.type==="PENDING"&&f.actions.abort()},[i]),c=G(function(){var d={capture:!0,passive:!1},u=fd({cancel:s,completed:i,getPhase:function(){return r.current},setPhase:function(p){r.current=p}});t.current=Le(window,u,d)},[s,i]),g=G(function(d,u){r.current.type!=="IDLE"&&j(),r.current={type:"PENDING",point:u,actions:d},c()},[c]);je(function(){return o(),function(){t.current()}},[o])}var xr;function vd(){}var hd=(xr={},xr[od]=!0,xr[ad]=!0,xr[sd]=!0,xr[id]=!0,xr);function bd(e,r){function t(){r(),e.cancel()}function n(){r(),e.drop()}return[{eventName:"keydown",fn:function(o){if(o.keyCode===bn){o.preventDefault(),t();return}if(o.keyCode===uo){o.preventDefault(),n();return}if(o.keyCode===ud){o.preventDefault(),e.moveDown();return}if(o.keyCode===cd){o.preventDefault(),e.moveUp();return}if(o.keyCode===dd){o.preventDefault(),e.moveRight();return}if(o.keyCode===ld){o.preventDefault(),e.moveLeft();return}if(hd[o.keyCode]){o.preventDefault();return}go(o)}},{eventName:"mousedown",fn:t},{eventName:"mouseup",fn:t},{eventName:"click",fn:t},{eventName:"touchstart",fn:t},{eventName:"resize",fn:t},{eventName:"wheel",fn:t,options:{passive:!0}},{eventName:St,fn:t}]}function xd(e){var r=y.useRef(vd),t=se(function(){return{eventName:"keydown",fn:function(o){if(o.defaultPrevented||o.keyCode!==uo)return;var i=e.findClosestDraggableId(o);if(!i)return;var s=e.tryGetLock(i,f,{sourceEvent:o});if(!s)return;o.preventDefault();var c=!0,g=s.snapLift();r.current();function f(){c||j(),c=!1,r.current(),n()}r.current=Le(window,bd(g,f),{capture:!0,passive:!1})}}},[e]),n=G(function(){var o={passive:!1,capture:!0};r.current=Le(window,[t],o)},[t]);je(function(){return n(),function(){r.current()}},[n])}var Ft={type:"IDLE"},yd=120,wd=.15;function Cd(e){var r=e.cancel,t=e.getPhase;return[{eventName:"orientationchange",fn:r},{eventName:"resize",fn:r},{eventName:"contextmenu",fn:function(a){a.preventDefault()}},{eventName:"keydown",fn:function(a){if(t().type!=="DRAGGING"){r();return}a.keyCode===bn&&a.preventDefault(),r()}},{eventName:St,fn:r}]}function Sd(e){var r=e.cancel,t=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(o){var i=n();if(i.type!=="DRAGGING"){r();return}i.hasMoved=!0;var s=o.touches[0],c=s.clientX,g=s.clientY,f={x:c,y:g};o.preventDefault(),i.actions.move(f)}},{eventName:"touchend",fn:function(o){var i=n();if(i.type!=="DRAGGING"){r();return}o.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:function(o){if(n().type!=="DRAGGING"){r();return}o.preventDefault(),r()}},{eventName:"touchforcechange",fn:function(o){var i=n();i.type==="IDLE"&&j();var s=o.touches[0];if(s){var c=s.force>=wd;if(c){var g=i.actions.shouldRespectForcePress();if(i.type==="PENDING"){g&&r();return}if(g){if(i.hasMoved){o.preventDefault();return}r();return}o.preventDefault()}}}},{eventName:St,fn:r}]}function Ed(e){var r=y.useRef(Ft),t=y.useRef(nr),n=G(function(){return r.current},[]),a=G(function(m){r.current=m},[]),o=se(function(){return{eventName:"touchstart",fn:function(m){if(!m.defaultPrevented){var p=e.findClosestDraggableId(m);if(p){var w=e.tryGetLock(p,s,{sourceEvent:m});if(w){var h=m.touches[0],C=h.clientX,I=h.clientY,P={x:C,y:I};t.current(),d(w,P)}}}}}},[e]),i=G(function(){var m={capture:!0,passive:!1};t.current=Le(window,[o],m)},[o]),s=G(function(){var u=r.current;u.type!=="IDLE"&&(u.type==="PENDING"&&clearTimeout(u.longPressTimerId),a(Ft),t.current(),i())},[i,a]),c=G(function(){var u=r.current;s(),u.type==="DRAGGING"&&u.actions.cancel({shouldBlockNextClick:!0}),u.type==="PENDING"&&u.actions.abort()},[s]),g=G(function(){var m={capture:!0,passive:!1},p={cancel:c,completed:s,getPhase:n},w=Le(window,Sd(p),m),h=Le(window,Cd(p),m);t.current=function(){w(),h()}},[c,n,s]),f=G(function(){var m=n();m.type!=="PENDING"&&j();var p=m.actions.fluidLift(m.point);a({type:"DRAGGING",actions:p,hasMoved:!1})},[n,a]),d=G(function(m,p){n().type!=="IDLE"&&j();var w=setTimeout(f,yd);a({type:"PENDING",point:p,actions:m,longPressTimerId:w}),g()},[g,n,a,f]);je(function(){return i(),function(){t.current();var p=n();p.type==="PENDING"&&(clearTimeout(p.longPressTimerId),a(Ft))}},[n,i,a]),je(function(){var m=Le(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return m},[])}var Id={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function fo(e,r){if(r==null)return!1;var t=!!Id[r.tagName.toLowerCase()];if(t)return!0;var n=r.getAttribute("contenteditable");return n==="true"||n===""?!0:r===e?!1:fo(e,r.parentElement)}function Nd(e,r){var t=r.target;return wt(t)?fo(e,t):!1}var Dd=function(e){return ze(e.getBoundingClientRect()).center};function Ad(e){return e instanceof lo(e).Element}var Pd=function(){var e="matches";if(typeof document>"u")return e;var r=[e,"msMatchesSelector","webkitMatchesSelector"],t=sr(r,function(n){return n in Element.prototype});return t||e}();function mo(e,r){return e==null?null:e[Pd](r)?e:mo(e.parentElement,r)}function kd(e,r){return e.closest?e.closest(r):mo(e,r)}function jd(e){return"["+Cr.contextId+'="'+e+'"]'}function Rd(e,r){var t=r.target;if(!Ad(t))return null;var n=jd(e),a=kd(t,n);return!a||!wt(a)?null:a}function Td(e,r){var t=Rd(e,r);return t?t.getAttribute(Cr.draggableId):null}function Bd(e,r){var t="["+Kt.contextId+'="'+e+'"]',n=ka(document.querySelectorAll(t)),a=sr(n,function(o){return o.getAttribute(Kt.id)===r});return!a||!wt(a)?null:a}function Od(e){e.preventDefault()}function at(e){var r=e.expected,t=e.phase,n=e.isLockActive;return e.shouldWarn,!(!n()||r!==t)}function vo(e){var r=e.lockAPI,t=e.store,n=e.registry,a=e.draggableId;if(r.isClaimed())return!1;var o=n.draggable.findById(a);return!(!o||!o.options.isEnabled||!ao(t.getState(),a))}function Md(e){var r=e.lockAPI,t=e.contextId,n=e.store,a=e.registry,o=e.draggableId,i=e.forceSensorStop,s=e.sourceEvent,c=vo({lockAPI:r,store:n,registry:a,draggableId:o});if(!c)return null;var g=a.draggable.getById(o),f=Bd(t,g.descriptor.id);if(!f||s&&!g.options.canDragInteractiveElements&&Nd(f,s))return null;var d=r.claim(i||nr),u="PRE_DRAG";function m(){return g.options.shouldRespectForcePress}function p(){return r.isActive(d)}function w(B,z){at({expected:B,phase:u,isLockActive:p,shouldWarn:!0})&&n.dispatch(z())}var h=w.bind(null,"DRAGGING");function C(B){function z(){r.release(),u="COMPLETED"}u!=="PRE_DRAG"&&(z(),u!=="PRE_DRAG"&&j()),n.dispatch(Pl(B.liftActionArgs)),u="DRAGGING";function _(V,ee){if(ee===void 0&&(ee={shouldBlockNextClick:!1}),B.cleanup(),ee.shouldBlockNextClick){var K=Le(window,[{eventName:"click",fn:Od,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(K)}z(),n.dispatch(Qa({reason:V}))}return H({isActive:function(){return at({expected:"DRAGGING",phase:u,isLockActive:p,shouldWarn:!1})},shouldRespectForcePress:m,drop:function(ee){return _("DROP",ee)},cancel:function(ee){return _("CANCEL",ee)}},B.actions)}function I(B){var z=Mr(function(V){h(function(){return Ja({client:V})})}),_=C({liftActionArgs:{id:o,clientSelection:B,movementMode:"FLUID"},cleanup:function(){return z.cancel()},actions:{move:z}});return H({},_,{move:z})}function P(){var B={moveUp:function(){return h(Fl)},moveRight:function(){return h(Ul)},moveDown:function(){return h(Gl)},moveLeft:function(){return h(zl)}};return C({liftActionArgs:{id:o,clientSelection:Dd(f),movementMode:"SNAP"},cleanup:nr,actions:B})}function N(){var B=at({expected:"PRE_DRAG",phase:u,isLockActive:p,shouldWarn:!0});B&&r.release()}var M={isActive:function(){return at({expected:"PRE_DRAG",phase:u,isLockActive:p,shouldWarn:!1})},shouldRespectForcePress:m,fluidLift:I,snapLift:P,abort:N};return M}var Ld=[md,xd,Ed];function Fd(e){var r=e.contextId,t=e.store,n=e.registry,a=e.customSensors,o=e.enableDefaultSensors,i=[].concat(o?Ld:[],a||[]),s=y.useState(function(){return rd()})[0],c=G(function(I,P){I.isDragging&&!P.isDragging&&s.tryAbandon()},[s]);je(function(){var I=t.getState(),P=t.subscribe(function(){var N=t.getState();c(I,N),I=N});return P},[s,t,c]),je(function(){return s.tryAbandon},[s.tryAbandon]);for(var g=G(function(C){return vo({lockAPI:s,registry:n,store:t,draggableId:C})},[s,n,t]),f=G(function(C,I,P){return Md({lockAPI:s,registry:n,contextId:r,store:t,draggableId:C,forceSensorStop:I,sourceEvent:P&&P.sourceEvent?P.sourceEvent:null})},[r,s,n,t]),d=G(function(C){return Td(r,C)},[r]),u=G(function(C){var I=n.draggable.findById(C);return I?I.options:null},[n.draggable]),m=G(function(){s.isClaimed()&&(s.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(ln()))},[s,t]),p=G(s.isClaimed,[s]),w=se(function(){return{canGetLock:g,tryGetLock:f,findClosestDraggableId:d,findOptionsForDraggable:u,tryReleaseLock:m,isLockClaimed:p}},[g,f,d,u,m,p]),h=0;h<i.length;h++)i[h](w)}var Gd=function(r){return{onBeforeCapture:r.onBeforeCapture,onBeforeDragStart:r.onBeforeDragStart,onDragStart:r.onDragStart,onDragEnd:r.onDragEnd,onDragUpdate:r.onDragUpdate}};function Rr(e){return e.current||j(),e.current}function Ud(e){var r=e.contextId,t=e.setCallbacks,n=e.sensors,a=e.nonce,o=e.dragHandleUsageInstructions,i=y.useRef(null),s=co(e),c=G(function(){return Gd(s.current)},[s]),g=Jc(r),f=ed({contextId:r,text:o}),d=Hc(r,a),u=G(function(V){Rr(i).dispatch(V)},[]),m=se(function(){return Sn({publishWhileDragging:jl,updateDroppableScroll:Tl,updateDroppableIsEnabled:Bl,updateDroppableIsCombineEnabled:Ol,collectionStarting:Rl},u)},[u]),p=Kc(),w=se(function(){return wc(p,m)},[p,m]),h=se(function(){return Fc(H({scrollWindow:Cc,scrollDroppable:w.scrollDroppable},Sn({move:Ja},u)))},[w.scrollDroppable,u]),C=Vc(r),I=se(function(){return hc({announce:g,autoScroller:h,dimensionMarshal:w,focusMarshal:C,getResponders:c,styleMarshal:d})},[g,h,w,C,c,d]);i.current=I;var P=G(function(){var V=Rr(i),ee=V.getState();ee.phase!=="IDLE"&&V.dispatch(ln())},[]),N=G(function(){var V=Rr(i).getState();return V.isDragging||V.phase==="DROP_ANIMATING"},[]),M=se(function(){return{isDragging:N,tryAbort:P}},[N,P]);t(M);var B=G(function(V){return ao(Rr(i).getState(),V)},[]),z=G(function(){return ur(Rr(i).getState())},[]),_=se(function(){return{marshal:w,focus:C,contextId:r,canLift:B,isMovementAllowed:z,dragHandleUsageInstructionsId:f,registry:p}},[r,w,f,C,B,z,p]);return Fd({contextId:r,store:I,registry:p,customSensors:n,enableDefaultSensors:e.enableDefaultSensors!==!1}),y.useEffect(function(){return P},[P]),fe.createElement(Ct.Provider,{value:_},fe.createElement(ki,{context:vn,store:I},e.children))}var zd=0;function $d(){return se(function(){return""+zd++},[])}function Hd(e){var r=$d(),t=e.dragHandleUsageInstructions||st.dragHandleUsageInstructions;return fe.createElement(xs,null,function(n){return fe.createElement(Ud,{nonce:e.nonce,contextId:r,setCallbacks:n,dragHandleUsageInstructions:t,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)})}var ho=function(r){return function(t){return r===t}},Wd=ho("scroll"),Vd=ho("auto"),ia=function(r,t){return t(r.overflowX)||t(r.overflowY)},qd=function(r){var t=window.getComputedStyle(r),n={overflowX:t.overflowX,overflowY:t.overflowY};return ia(n,Wd)||ia(n,Vd)},Kd=function(){return!1},Yd=function e(r){return r==null?null:r===document.body?Kd()?r:null:r===document.documentElement?null:qd(r)?r:e(r.parentElement)},Yt=function(e){return{x:e.scrollLeft,y:e.scrollTop}},Xd=function e(r){if(!r)return!1;var t=window.getComputedStyle(r);return t.position==="fixed"?!0:e(r.parentElement)},Jd=function(e){var r=Yd(e),t=Xd(e);return{closestScrollable:r,isFixedOnPage:t}},Qd=function(e){var r=e.descriptor,t=e.isEnabled,n=e.isCombineEnabled,a=e.isFixedOnPage,o=e.direction,i=e.client,s=e.page,c=e.closest,g=function(){if(!c)return null;var m=c.scrollSize,p=c.client,w=ro({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:p.paddingBox.height,width:p.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:p,scrollSize:m,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:w,diff:{value:ye,displacement:ye}}}}(),f=o==="vertical"?tn:Oa,d=yr({page:s,withPlaceholder:null,axis:f,frame:g}),u={descriptor:r,isCombineEnabled:n,isFixedOnPage:a,axis:f,isEnabled:t,client:i,page:s,frame:g,subject:d};return u},Zd=function(r,t){var n=Ia(r);if(!t||r!==t)return n;var a=n.paddingBox.top-t.scrollTop,o=n.paddingBox.left-t.scrollLeft,i=a+t.scrollHeight,s=o+t.scrollWidth,c={top:a,right:s,bottom:i,left:o},g=Qt(c,n.border),f=Zt({borderBox:g,margin:n.margin,border:n.border,padding:n.padding});return f},_d=function(e){var r=e.ref,t=e.descriptor,n=e.env,a=e.windowScroll,o=e.direction,i=e.isDropDisabled,s=e.isCombineEnabled,c=e.shouldClipSubject,g=n.closestScrollable,f=Zd(r,g),d=dt(f,a),u=function(){if(!g)return null;var p=Ia(g),w={scrollHeight:g.scrollHeight,scrollWidth:g.scrollWidth};return{client:p,page:dt(p,a),scroll:Yt(g),scrollSize:w,shouldClipSubject:c}}(),m=Qd({descriptor:t,isEnabled:!i,isCombineEnabled:s,isFixedOnPage:n.isFixedOnPage,direction:o,client:f,page:d,closest:u});return m},eu={passive:!1},ru={passive:!0},sa=function(e){return e.shouldPublishImmediately?eu:ru};function vt(e){var r=y.useContext(e);return r||j(),r}var ot=function(r){return r&&r.env.closestScrollable||null};function tu(e){var r=y.useRef(null),t=vt(Ct),n=hn("droppable"),a=t.registry,o=t.marshal,i=co(e),s=se(function(){return{id:e.droppableId,type:e.type,mode:e.mode}},[e.droppableId,e.mode,e.type]),c=y.useRef(s),g=se(function(){return xe(function(N,M){r.current||j();var B={x:N,y:M};o.updateDroppableScroll(s.id,B)})},[s.id,o]),f=G(function(){var N=r.current;return!N||!N.env.closestScrollable?ye:Yt(N.env.closestScrollable)},[]),d=G(function(){var N=f();g(N.x,N.y)},[f,g]),u=se(function(){return Mr(d)},[d]),m=G(function(){var N=r.current,M=ot(N);N&&M||j();var B=N.scrollOptions;if(B.shouldPublishImmediately){d();return}u()},[u,d]),p=G(function(N,M){r.current&&j();var B=i.current,z=B.getDroppableRef();z||j();var _=Jd(z),V={ref:z,descriptor:s,env:_,scrollOptions:M};r.current=V;var ee=_d({ref:z,descriptor:s,env:_,windowScroll:N,direction:B.direction,isDropDisabled:B.isDropDisabled,isCombineEnabled:B.isCombineEnabled,shouldClipSubject:!B.ignoreContainerClipping}),K=_.closestScrollable;return K&&(K.setAttribute(ta.contextId,t.contextId),K.addEventListener("scroll",m,sa(V.scrollOptions))),ee},[t.contextId,s,m,i]),w=G(function(){var N=r.current,M=ot(N);return N&&M||j(),Yt(M)},[]),h=G(function(){var N=r.current;N||j();var M=ot(N);r.current=null,M&&(u.cancel(),M.removeAttribute(ta.contextId),M.removeEventListener("scroll",m,sa(N.scrollOptions)))},[m,u]),C=G(function(N){var M=r.current;M||j();var B=ot(M);B||j(),B.scrollTop+=N.y,B.scrollLeft+=N.x},[]),I=se(function(){return{getDimensionAndWatchScroll:p,getScrollWhileDragging:w,dragStopped:h,scroll:C}},[h,p,w,C]),P=se(function(){return{uniqueId:n,descriptor:s,callbacks:I}},[I,s,n]);je(function(){return c.current=P.descriptor,a.droppable.register(P),function(){r.current&&h(),a.droppable.unregister(P)}},[I,s,h,P,o,a.droppable]),je(function(){r.current&&o.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,o]),je(function(){r.current&&o.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,o])}function Gt(){}var la={width:0,height:0,margin:Is},nu=function(r){var t=r.isAnimatingOpenOnMount,n=r.placeholder,a=r.animate;return t||a==="close"?la:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},au=function(r){var t=r.isAnimatingOpenOnMount,n=r.placeholder,a=r.animate,o=nu({isAnimatingOpenOnMount:t,placeholder:n,animate:a});return{display:n.display,boxSizing:"border-box",width:o.width,height:o.height,marginTop:o.margin.top,marginRight:o.margin.right,marginBottom:o.margin.bottom,marginLeft:o.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:a!=="none"?Or.placeholder:null}};function ou(e){var r=y.useRef(null),t=G(function(){r.current&&(clearTimeout(r.current),r.current=null)},[]),n=e.animate,a=e.onTransitionEnd,o=e.onClose,i=e.contextId,s=y.useState(e.animate==="open"),c=s[0],g=s[1];y.useEffect(function(){return c?n!=="open"?(t(),g(!1),Gt):r.current?Gt:(r.current=setTimeout(function(){r.current=null,g(!1)}),t):Gt},[n,c,t]);var f=G(function(u){u.propertyName==="height"&&(a(),n==="close"&&o())},[n,o,a]),d=au({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return fe.createElement(e.placeholder.tagName,{style:d,"data-rbd-placeholder-context-id":i,onTransitionEnd:f,ref:e.innerRef})}var iu=fe.memo(ou),xn=fe.createContext(null),su=function(e){va(r,e);function r(){for(var n,a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}r.getDerivedStateFromProps=function(a,o){return a.shouldAnimate?a.on?{isVisible:!0,data:a.on,animate:"open"}:o.isVisible?{isVisible:!0,data:o.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!a.on,data:a.on,animate:"none"}};var t=r.prototype;return t.render=function(){if(!this.state.isVisible)return null;var a={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(a)},r}(fe.PureComponent),ca={dragging:5e3,dropAnimating:4500},lu=function(r,t){return t?Or.drop(t.duration):r?Or.snap:Or.fluid},cu=function(r,t){return r?t?Ur.opacity.drop:Ur.opacity.combining:null},du=function(r){return r.forceShouldAnimate!=null?r.forceShouldAnimate:r.mode==="SNAP"};function uu(e){var r=e.dimension,t=r.client,n=e.offset,a=e.combineWith,o=e.dropping,i=!!a,s=du(e),c=!!o,g=c?Vt.drop(n,i):Vt.moveTo(n),f={position:"fixed",top:t.marginBox.top,left:t.marginBox.left,boxSizing:"border-box",width:t.borderBox.width,height:t.borderBox.height,transition:lu(s,o),transform:g,opacity:cu(i,c),zIndex:c?ca.dropAnimating:ca.dragging,pointerEvents:"none"};return f}function gu(e){return{transform:Vt.moveTo(e.offset),transition:e.shouldAnimateDisplacement?null:"none"}}function pu(e){return e.type==="DRAGGING"?uu(e):gu(e)}function fu(e,r,t){t===void 0&&(t=ye);var n=window.getComputedStyle(r),a=r.getBoundingClientRect(),o=Ea(a,n),i=dt(o,t),s={client:o,tagName:r.tagName.toLowerCase(),display:n.display},c={x:o.marginBox.width,y:o.marginBox.height},g={descriptor:e,placeholder:s,displaceBy:c,client:o,page:i};return g}function mu(e){var r=hn("draggable"),t=e.descriptor,n=e.registry,a=e.getDraggableRef,o=e.canDragInteractiveElements,i=e.shouldRespectForcePress,s=e.isEnabled,c=se(function(){return{canDragInteractiveElements:o,shouldRespectForcePress:i,isEnabled:s}},[o,s,i]),g=G(function(m){var p=a();return p||j(),fu(t,p,m)},[t,a]),f=se(function(){return{uniqueId:r,descriptor:t,options:c,getDimension:g}},[t,g,c,r]),d=y.useRef(f),u=y.useRef(!0);je(function(){return n.draggable.register(d.current),function(){return n.draggable.unregister(d.current)}},[n.draggable]),je(function(){if(u.current){u.current=!1;return}var m=d.current;d.current=f,n.draggable.update(f,m)},[f,n.draggable])}function vu(e){e.preventDefault()}function hu(e){var r=y.useRef(null),t=G(function(V){r.current=V},[]),n=G(function(){return r.current},[]),a=vt(Ct),o=a.contextId,i=a.dragHandleUsageInstructionsId,s=a.registry,c=vt(xn),g=c.type,f=c.droppableId,d=se(function(){return{id:e.draggableId,index:e.index,type:g,droppableId:f}},[e.draggableId,e.index,g,f]),u=e.children,m=e.draggableId,p=e.isEnabled,w=e.shouldRespectForcePress,h=e.canDragInteractiveElements,C=e.isClone,I=e.mapped,P=e.dropAnimationFinished;if(!C){var N=se(function(){return{descriptor:d,registry:s,getDraggableRef:n,canDragInteractiveElements:h,shouldRespectForcePress:w,isEnabled:p}},[d,s,n,h,w,p]);mu(N)}var M=se(function(){return p?{tabIndex:0,role:"button","aria-describedby":i,"data-rbd-drag-handle-draggable-id":m,"data-rbd-drag-handle-context-id":o,draggable:!1,onDragStart:vu}:null},[o,i,m,p]),B=G(function(V){I.type==="DRAGGING"&&I.dropping&&V.propertyName==="transform"&&P()},[P,I]),z=se(function(){var V=pu(I),ee=I.type==="DRAGGING"&&I.dropping?B:null,K={innerRef:t,draggableProps:{"data-rbd-draggable-context-id":o,"data-rbd-draggable-id":m,style:V,onTransitionEnd:ee},dragHandleProps:M};return K},[o,M,m,I,B,t]),_=se(function(){return{draggableId:d.id,type:d.type,source:{index:d.index,droppableId:d.droppableId}}},[d.droppableId,d.id,d.index,d.type]);return u(z,I.snapshot,_)}var bo=function(e,r){return e===r},xo=function(e){var r=e.combine,t=e.destination;return t?t.droppableId:r?r.droppableId:null},bu=function(r){return r.combine?r.combine.draggableId:null},xu=function(r){return r.at&&r.at.type==="COMBINE"?r.at.combine.draggableId:null};function yu(){var e=xe(function(a,o){return{x:a,y:o}}),r=xe(function(a,o,i,s,c){return{isDragging:!0,isClone:o,isDropAnimating:!!c,dropAnimation:c,mode:a,draggingOver:i,combineWith:s,combineTargetFor:null}}),t=xe(function(a,o,i,s,c,g,f){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:g,mode:o,offset:a,dimension:i,forceShouldAnimate:f,snapshot:r(o,s,c,g,null)}}}),n=function(o,i){if(o.isDragging){if(o.critical.draggable.id!==i.draggableId)return null;var s=o.current.client.offset,c=o.dimensions.draggables[i.draggableId],g=ke(o.impact),f=xu(o.impact),d=o.forceShouldAnimate;return t(e(s.x,s.y),o.movementMode,c,i.isClone,g,f,d)}if(o.phase==="DROP_ANIMATING"){var u=o.completed;if(u.result.draggableId!==i.draggableId)return null;var m=i.isClone,p=o.dimensions.draggables[i.draggableId],w=u.result,h=w.mode,C=xo(w),I=bu(w),P=o.dropDuration,N={duration:P,curve:dn.drop,moveTo:o.newHomeClientOffset,opacity:I?Ur.opacity.drop:null,scale:I?Ur.scale.drop:null};return{mapped:{type:"DRAGGING",offset:o.newHomeClientOffset,dimension:p,dropping:N,draggingOver:C,combineWith:I,mode:h,forceShouldAnimate:null,snapshot:r(h,m,C,I,N)}}}return null};return n}function yo(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var wu={mapped:{type:"SECONDARY",offset:ye,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:yo(null)}};function Cu(){var e=xe(function(i,s){return{x:i,y:s}}),r=xe(yo),t=xe(function(i,s,c){return s===void 0&&(s=null),{mapped:{type:"SECONDARY",offset:i,combineTargetFor:s,shouldAnimateDisplacement:c,snapshot:r(s)}}}),n=function(s){return s?t(ye,s,!0):null},a=function(s,c,g,f){var d=g.displaced.visible[s],u=!!(f.inVirtualList&&f.effected[s]),m=bt(g),p=m&&m.draggableId===s?c:null;if(!d){if(!u)return n(p);if(g.displaced.invisible[s])return null;var w=Sr(f.displacedBy.point),h=e(w.x,w.y);return t(h,p,!0)}if(u)return n(p);var C=g.displacedBy.point,I=e(C.x,C.y);return t(I,p,d.shouldAnimate)},o=function(s,c){if(s.isDragging)return s.critical.draggable.id===c.draggableId?null:a(c.draggableId,s.critical.draggable.id,s.impact,s.afterCritical);if(s.phase==="DROP_ANIMATING"){var g=s.completed;return g.result.draggableId===c.draggableId?null:a(c.draggableId,g.result.draggableId,g.impact,g.afterCritical)}return null};return o}var Su=function(){var r=yu(),t=Cu(),n=function(o,i){return r(o,i)||t(o,i)||wu};return n},Eu={dropAnimationFinished:Za},Iu=Ca(Su,Eu,null,{context:vn,pure:!0,areStatePropsEqual:bo})(hu);function wo(e){var r=vt(xn),t=r.isUsingCloneFor;return t===e.draggableId&&!e.isClone?null:fe.createElement(Iu,e)}function Nu(e){var r=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,t=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return fe.createElement(wo,H({},e,{isClone:!1,isEnabled:r,canDragInteractiveElements:t,shouldRespectForcePress:n}))}function Du(e){var r=y.useContext(Ct);r||j();var t=r.contextId,n=r.isMovementAllowed,a=y.useRef(null),o=y.useRef(null),i=e.children,s=e.droppableId,c=e.type,g=e.mode,f=e.direction,d=e.ignoreContainerClipping,u=e.isDropDisabled,m=e.isCombineEnabled,p=e.snapshot,w=e.useClone,h=e.updateViewportMaxScroll,C=e.getContainerForClone,I=G(function(){return a.current},[]),P=G(function(K){a.current=K},[]);G(function(){return o.current},[]);var N=G(function(K){o.current=K},[]),M=G(function(){n()&&h({maxScroll:no()})},[n,h]);tu({droppableId:s,type:c,mode:g,direction:f,isDropDisabled:u,isCombineEnabled:m,ignoreContainerClipping:d,getDroppableRef:I});var B=fe.createElement(su,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},function(K){var le=K.onClose,T=K.data,$=K.animate;return fe.createElement(iu,{placeholder:T,onClose:le,innerRef:N,animate:$,contextId:t,onTransitionEnd:M})}),z=se(function(){return{innerRef:P,placeholder:B,droppableProps:{"data-rbd-droppable-id":s,"data-rbd-droppable-context-id":t}}},[t,s,B,P]),_=w?w.dragging.draggableId:null,V=se(function(){return{droppableId:s,type:c,isUsingCloneFor:_}},[s,_,c]);function ee(){if(!w)return null;var K=w.dragging,le=w.render,T=fe.createElement(wo,{draggableId:K.draggableId,index:K.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function($,ge){return le($,ge,K)});return Oo.createPortal(T,C())}return fe.createElement(xn.Provider,{value:V},i(z,p),ee())}var Ut=function(r,t){return r===t.droppable.type},da=function(r,t){return t.draggables[r.draggable.id]},Au=function(){var r={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t=H({},r,{shouldAnimatePlaceholder:!1}),n=xe(function(i){return{draggableId:i.id,type:i.type,source:{index:i.index,droppableId:i.droppableId}}}),a=xe(function(i,s,c,g,f,d){var u=f.descriptor.id,m=f.descriptor.droppableId===i;if(m){var p=d?{render:d,dragging:n(f.descriptor)}:null,w={isDraggingOver:c,draggingOverWith:c?u:null,draggingFromThisWith:u,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!1,snapshot:w,useClone:p}}if(!s)return t;if(!g)return r;var h={isDraggingOver:c,draggingOverWith:u,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!0,snapshot:h,useClone:null}}),o=function(s,c){var g=c.droppableId,f=c.type,d=!c.isDropDisabled,u=c.renderClone;if(s.isDragging){var m=s.critical;if(!Ut(f,m))return t;var p=da(m,s.dimensions),w=ke(s.impact)===g;return a(g,d,w,w,p,u)}if(s.phase==="DROP_ANIMATING"){var h=s.completed;if(!Ut(f,h.critical))return t;var C=da(h.critical,s.dimensions);return a(g,d,xo(h.result)===g,ke(h.impact)===g,C,u)}if(s.phase==="IDLE"&&s.completed&&!s.shouldFlush){var I=s.completed;if(!Ut(f,I.critical))return t;var P=ke(I.impact)===g,N=!!(I.impact.at&&I.impact.at.type==="COMBINE"),M=I.critical.droppable.id===g;return P?N?r:t:M?r:t}return t};return o},Pu={updateViewportMaxScroll:Ll};function ku(){return document.body||j(),document.body}var ju={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:ku},Co=Ca(Au,Pu,null,{context:vn,pure:!0,areStatePropsEqual:bo})(Du);Co.defaultProps=ju;const Ru=({elements:e,onReorder:r,onSelect:t,selectedElement:n})=>{const a=o=>{if(!o.destination)return;const i=Array.from(e),[s]=i.splice(o.source.index,1);i.splice(o.destination.index,0,s),r(i)};return l.jsx("div",{className:"bg-white ",children:l.jsx(Hd,{onDragEnd:a,children:l.jsx(Co,{droppableId:"layers",children:o=>l.jsxs("div",{...o.droppableProps,ref:o.innerRef,className:"space-y-2",children:[e.map((i,s)=>l.jsx(Nu,{draggableId:i.id,index:s,children:c=>l.jsxs("div",{ref:c.innerRef,...c.draggableProps,className:`flex items-center p-2 rounded cursor-pointer ${n===i.id?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>t(i.id),children:[l.jsx("div",{...c.dragHandleProps,className:"mr-2",children:l.jsx(ti,{size:16})}),i.type==="image"?l.jsx(it,{size:16,className:"mr-2"}):l.jsx(Tr,{size:16,className:"mr-2"}),l.jsx("span",{className:"text-sm truncate",children:i.type==="text"?i.content.substring(0,20):`Imagen ${s+1}`})]})},i.id)),o.placeholder]})})})})};function Tu({currentLayoutId:e,onLayoutChange:r}){const[t,n]=y.useState("all"),a={all:{name:"Todos",layouts:we},hero:{name:"Hero",layouts:we.filter(o=>o.category==="hero")},editorial:{name:"Editorial",layouts:we.filter(o=>o.category==="editorial")},storytelling:{name:"Historia",layouts:we.filter(o=>o.category==="storytelling")},minimal:{name:"Minimal",layouts:we.filter(o=>o.category==="minimal")},creative:{name:"Creativo",layouts:we.filter(o=>o.category==="creative")},classic:{name:"Clásico",layouts:we.filter(o=>o.category==="classic")}};return Object.keys(a).filter(o=>o==="all"||a[o].layouts.length>0),l.jsxs("div",{className:"w-full",children:[l.jsx("div",{className:"grid grid-cols-2  gap-3 overflow-x-hidden custom-scroll",children:a[t].layouts.map(o=>l.jsxs("div",{className:`relative group cursor-pointer transition-all duration-200 
                                 hover:shadow-md hover:scale-102
                        `,onClick:()=>r(o.id),children:[l.jsxs("div",{className:"aspect-square relative bg-white rounded-lg p-2 border border-gray-200",children:[l.jsx("div",{className:`w-full h-full grid ${o.template}`,style:{gap:"2px",padding:"4px"},children:Array.from({length:o.cells}).map((i,s)=>{var c,g;return l.jsx("div",{className:`bg-gradient-to-br from-purple-100 to-purple-200 ${(g=(c=o.cellStyles)==null?void 0:c[s])!=null&&g.includes("rounded")?"rounded":"rounded-sm"}`,style:{minHeight:"8px"}},s)})}),e===o.id&&l.jsx("div",{className:"absolute top-1/2 right-1/2 translate-x-1/2 -translate-y-1/2 w-5 h-5 bg-purple-600 rounded-full flex items-center justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),l.jsxs("div",{className:"mt-2 text-center",children:[l.jsx("h4",{className:"text-xs font-medium text-gray-900 truncate",children:o.name}),o.description&&l.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:o.description}),l.jsx("div",{className:"flex items-center justify-center mt-1 space-x-2",children:l.jsxs("span",{className:"text-xs text-gray-400",children:[o.cells," ",o.cells===1?"celda":"celdas"]})})]})]},o.id))}),a[t].layouts.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No hay layouts disponibles en esta categoría."})})]})}const Bu=({selectedMask:e,onSelect:r,availableMasks:t=[],selectedImage:n})=>{var s,c;const[a,o]=y.useState("Básicas"),i={};return ua.forEach(g=>{i[g.category]||(i[g.category]=[]),(t.includes(g.id)||g.id==="none")&&i[g.category].push(g)}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"grid grid-cols-2 gap-1 bg-gray-100 p-1 rounded-lg",children:Object.keys(i).slice(0,2).map(g=>i[g].length>0&&l.jsx("button",{onClick:()=>o(g),className:`py-1.5 px-2 text-xs rounded-md transition font-medium ${a===g?"bg-white text-purple-700 shadow-sm":"text-gray-600 hover:text-purple-600"}`,children:g},g))}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:(s=i[a])==null?void 0:s.slice(0,6).map(g=>l.jsxs("div",{onClick:()=>r(g.id),className:`cursor-pointer border rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-all ${e===g.id?"ring-2 ring-purple-500 border-purple-300":"border-gray-200"}`,children:[l.jsx("div",{className:"aspect-square bg-white flex items-center justify-center p-1",children:n!=null&&n.content?l.jsx("img",{src:n.content,alt:g.name,className:`w-full h-full object-cover ${g.class}`}):l.jsx("div",{className:`w-full h-full bg-gray-200 ${g.class}`})}),l.jsx("p",{className:"text-center text-[10px] text-gray-700 p-1 truncate",children:g.name})]},g.id))}),((c=i[a])==null?void 0:c.length)>6&&l.jsxs("button",{className:"w-full py-2 text-xs text-purple-600 hover:text-purple-700 border border-purple-200 rounded-lg hover:bg-purple-50 transition",children:["Ver más máscaras (",i[a].length-6," más)"]})]})},Ou=[{name:"Arial",value:"Arial"},{name:"Times New Roman",value:"'Times New Roman'"},{name:"Helvetica",value:"Helvetica"},{name:"Courier New",value:"'Courier New'"},{name:"Georgia",value:"Georgia"},{name:"Verdana",value:"Verdana"},{name:"Impact",value:"Impact"},{name:"Roboto",value:"'Roboto', sans-serif"},{name:"Open Sans",value:"'Open Sans', sans-serif"},{name:"Lato",value:"'Lato', sans-serif"},{name:"Pacifico (Cursiva)",value:"'Pacifico', cursive"},{name:"Lobster (Estilo Poster)",value:"'Lobster', cursive"},{name:"Indie Flower (Manuscrita)",value:"'Indie Flower', cursive"},{name:"Permanent Marker (Rotulador)",value:"'Permanent Marker', cursive"},{name:"Dancing Script (Elegante)",value:"'Dancing Script', cursive"},{name:"Shadows Into Light (Dibujada)",value:"'Shadows Into Light', cursive"},{name:"Amatic SC (Minimalista)",value:"'Amatic SC', cursive"},{name:"Handlee (Natural)",value:"'Handlee', cursive"},{name:"Caveat (Caligráfica)",value:"'Caveat', cursive"},{name:"Kalam (Pincel)",value:"'Kalam', cursive"}],Mu=["8px","9px","10px","11px","12px","14px","16px","18px","20px","22px","24px","28px","32px","36px","42px","48px","64px","72px"],Lu=[{label:"Normal",value:"none"},{label:"MAYÚSCULAS",value:"uppercase"},{label:"minúsculas",value:"lowercase"},{label:"Capitalizado",value:"capitalize"}],Fu=[{color:"#000000",name:"Negro"},{color:"#ffffff",name:"Blanco"},{color:"#f43f5e",name:"Rojo"},{color:"#22c55e",name:"Verde"},{color:"#3b82f6",name:"Azul"},{color:"#eab308",name:"Amarillo"},{color:"#06b6d4",name:"Cian"},{color:"#d946ef",name:"Magenta"},{color:"#6b7280",name:"Gris"},{color:"#a855f7",name:"Púrpura"},{color:"#ec4899",name:"Rosa"},{color:"#f97316",name:"Naranja"},{color:"#0f172a",name:"Azul oscuro"},{color:"#7c2d12",name:"Marrón"},{color:"#14532d",name:"Verde oscuro"},{color:"#4c1d95",name:"Violeta"},{color:"#1e293b",name:"Gris oscuro"},{color:"#fef3c7",name:"Crema"}],Gu=[{color:"transparent",name:"Transparente"},{color:"#ffffff",name:"Blanco"},{color:"#f8fafc",name:"Gris claro"},{color:"#f1f5f9",name:"Plata"},{color:"#fef3c7",name:"Crema"},{color:"#ffedd5",name:"Melocotón"},{color:"#fee2e2",name:"Rosa claro"},{color:"#dbeafe",name:"Azul claro"},{color:"#dcfce7",name:"Verde claro"},{color:"#f3e8ff",name:"Lavanda"}],Uu=[{label:"Ninguno",value:"none"},{label:"Sólido",value:"solid"},{label:"Punteado",value:"dotted"},{label:"Discontinuo",value:"dashed"},{label:"Doble",value:"double"},{label:"Acanalado",value:"groove"}],zu=({element:e,onUpdate:r,onClose:t})=>{var me,he,ve,Y,Ne,Se,De,$e,Xe,Ge,Re,Je,Qe,We,Ze,_e,Ve,pr,He,be,qe,Nr,Hr,Wr,Dr,Vr,qr,fr,mr,vr,Ue,er,Kr,Ke,rr,hr,Yr,Xr,Jr,lr,Qr;const[n,a]=y.useState(!1),[o,i]=y.useState(!1),[s,c]=y.useState(!1),[g,f]=y.useState(!1),[d,u]=y.useState(!1),[m,p]=y.useState(!1),[w,h]=y.useState(!1),[C,I]=y.useState(!1),[P,N]=y.useState("basic"),[M,B]=y.useState(((me=e==null?void 0:e.style)==null?void 0:me.color)||"#000000"),[z,_]=y.useState(((he=e==null?void 0:e.style)==null?void 0:he.backgroundColor)||"transparent"),V=y.useRef(null),ee=y.useRef(null),K=y.useRef(null),le=y.useRef(null),T=y.useRef(null),$=y.useRef(null),ge=y.useRef(null);y.useEffect(()=>{function D(re){V.current&&!V.current.contains(re.target)&&a(!1),ee.current&&!ee.current.contains(re.target)&&i(!1),K.current&&!K.current.contains(re.target)&&f(!1),le.current&&!le.current.contains(re.target)&&u(!1),T.current&&!T.current.contains(re.target)&&p(!1),$.current&&!$.current.contains(re.target)&&c(!1),ge.current&&!ge.current.contains(re.target)&&h(!1)}return document.addEventListener("mousedown",D),()=>{document.removeEventListener("mousedown",D)}},[]);const k=(D,re)=>{r({style:{...e==null?void 0:e.style,[D]:re}})},X=(D,re,Te)=>{var Ye;r({style:{...e==null?void 0:e.style,[D]:((Ye=e==null?void 0:e.style)==null?void 0:Ye[D])===re?Te:re}})},ce=(D,re)=>{k(D,re)};if(!e)return null;const J=({active:D,onClick:re,icon:Te,title:Ye,className:br=""})=>l.jsx("button",{type:"button",className:`p-1.5 rounded-sm transition-colors ${D?"bg-gray-200 text-gray-900":"text-gray-700 hover:bg-gray-100"} ${br}`,onClick:re,title:Ye,children:Te}),oe=({onClick:D,icon:re,text:Te,isOpen:Ye,title:br})=>l.jsxs("button",{type:"button",className:`flex items-center gap-1 px-2 py-1.5 rounded-md border ${Ye?"bg-gray-100 border-gray-300":"border-gray-200 hover:bg-gray-50"}`,onClick:D,title:br,children:[re&&l.jsx("span",{className:"flex-shrink-0",children:re}),Te&&l.jsx("span",{className:"text-sm truncate",children:Te}),l.jsx(Uo,{className:"h-3.5 w-3.5 opacity-70"})]});return l.jsx("div",{className:"  bg-white  rounded-lg shadow-sm px-4  border-gray-200  z-50 transition-all duration-200",children:l.jsxs("div",{className:"w-full ",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("h3",{className:"text-sm font-medium flex items-center gap-1.5",children:[l.jsx(Tr,{className:"h-4 w-4"}),"Formato de texto"]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{className:"p-1 rounded-md hover:bg-gray-100",onClick:()=>I(!C),title:C?"Modo compacto":"Modo expandido",children:C?l.jsx(mi,{className:"h-4 w-4"}):l.jsx(fi,{className:"h-4 w-4"})}),l.jsx("button",{className:"p-1 rounded-md hover:bg-gray-100",onClick:t,title:"Cerrar",children:l.jsx(Fo,{className:"h-4 w-4"})})]})]}),C&&l.jsxs("div",{className:"flex border-b mb-2",children:[l.jsx("button",{className:`px-3 py-1.5 text-sm font-medium ${P==="basic"?"border-b-2 border-primary customtext-primary":"customtext-neutral-dark"}`,onClick:()=>N("basic"),children:"Básico"}),l.jsx("button",{className:`px-3 py-1.5 text-sm font-medium ${P==="paragraph"?"border-b-2 border-primary customtext-primary":"customtext-neutral-dark"}`,onClick:()=>N("paragraph"),children:"Párrafo"}),l.jsx("button",{className:`px-3 py-1.5 text-sm font-medium ${P==="advanced"?"border-b-2 border-primary customtext-primary":"customtext-neutral-dark"}`,onClick:()=>N("advanced"),children:"Avanzado"})]}),(P==="basic"||!C)&&l.jsxs("div",{className:"flex flex-wrap gap-1.5 items-center",children:[l.jsx("div",{className:"relative",ref:K,children:l.jsx("select",{className:"px-2 py-1 border rounded-md text-sm",value:((ve=e.style)==null?void 0:ve.fontFamily)||"Arial",onChange:D=>{k("fontFamily",D.target.value)},children:Ou.map(D=>l.jsx("option",{value:D.value,style:{fontFamily:D.value},children:D.name},D.value))})}),l.jsxs("div",{className:"relative",ref:le,children:[l.jsx(oe,{onClick:()=>u(!d),text:((Y=e.style)==null?void 0:Y.fontSize)||"16px",isOpen:d,title:"Tamaño de fuente"}),d&&l.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-[9999] max-h-60 overflow-y-auto w-24",children:Mu.map(D=>l.jsx("button",{className:"w-full text-left px-3 py-1.5 hover:bg-gray-100 text-sm",onClick:()=>{k("fontSize",D),u(!1)},children:D},D))})]}),l.jsxs("div",{className:"flex items-center gap-0.5 border rounded-md",children:[l.jsx(J,{active:((Ne=e.style)==null?void 0:Ne.fontWeight)==="bold",onClick:()=>X("fontWeight","bold","normal"),icon:l.jsx(Zo,{className:"h-4 w-4"}),title:"Negrita"}),l.jsx(J,{active:((Se=e.style)==null?void 0:Se.fontStyle)==="italic",onClick:()=>X("fontStyle","italic","normal"),icon:l.jsx(di,{className:"h-4 w-4"}),title:"Cursiva"}),l.jsx(J,{active:((De=e.style)==null?void 0:De.textDecoration)==="underline",onClick:()=>X("textDecoration","underline","none"),icon:l.jsx(Ei,{className:"h-4 w-4"}),title:"Subrayado"}),l.jsx(J,{active:(($e=e.style)==null?void 0:$e.textDecoration)==="line-through",onClick:()=>X("textDecoration","line-through","none"),icon:l.jsx(wi,{className:"h-4 w-4"}),title:"Tachado"})]}),l.jsxs("div",{className:"flex items-center gap-0.5 border rounded-md",children:[l.jsx(J,{active:((Xe=e.style)==null?void 0:Xe.textAlign)==="left",onClick:()=>k("textAlign","left"),icon:l.jsx(Jo,{className:"h-4 w-4"}),title:"Alinear a la izquierda"}),l.jsx(J,{active:((Ge=e.style)==null?void 0:Ge.textAlign)==="center",onClick:()=>k("textAlign","center"),icon:l.jsx(Yo,{className:"h-4 w-4"}),title:"Centrar"}),l.jsx(J,{active:((Re=e.style)==null?void 0:Re.textAlign)==="right",onClick:()=>k("textAlign","right"),icon:l.jsx(Qo,{className:"h-4 w-4"}),title:"Alinear a la derecha"}),l.jsx(J,{active:((Je=e.style)==null?void 0:Je.textAlign)==="justify",onClick:()=>k("textAlign","justify"),icon:l.jsx(Xo,{className:"h-4 w-4"}),title:"Justificar"})]}),l.jsxs("div",{className:"relative",ref:V,children:[l.jsxs("button",{className:"flex items-center gap-1 px-2 py-1.5 rounded-md border border-gray-200 hover:bg-gray-50",onClick:()=>a(!n),title:"Color de texto",children:[l.jsx("div",{className:"w-4 h-4 rounded-sm border",style:{backgroundColor:M}}),l.jsx(Go,{className:"h-4 w-4"})]}),n&&l.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-[9999] p-3 w-64",children:l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs font-medium",children:"Color personalizado"}),l.jsx("div",{className:"w-6 h-6 rounded-md border",style:{backgroundColor:M}})]}),l.jsx("input",{type:"color",value:M,onChange:D=>{B(D.target.value),k("color",D.target.value)},className:"w-full h-8 cursor-pointer"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-medium mb-1.5",children:"Colores predefinidos"}),l.jsx("div",{className:"grid grid-cols-6 gap-1.5",children:Fu.map(D=>l.jsx("button",{type:"button",className:`w-8 h-8 rounded-md cursor-pointer border transition-all hover:scale-110 ${M===D.color?"ring-2 ring-offset-1 ring-blue-500":""}`,style:{backgroundColor:D.color},onClick:()=>{B(D.color),k("color",D.color)},title:D.name},D.color))})]})]})})]}),l.jsxs("div",{className:"relative",ref:ee,children:[l.jsxs("button",{className:"flex items-center gap-1 px-2 py-1.5 rounded-md border border-gray-200 hover:bg-gray-50",onClick:()=>i(!o),title:"Color de fondo",children:[l.jsx("div",{className:"w-4 h-4 rounded-sm border",style:{backgroundColor:z,backgroundImage:z==="transparent"?"linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc), linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc)":"none",backgroundSize:"8px 8px",backgroundPosition:"0 0, 4px 4px"}}),l.jsx(vi,{className:"h-4 w-4"})]}),o&&l.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-[9999] p-3 w-64",children:l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs font-medium",children:"Color de fondo personalizado"}),l.jsx("div",{className:"w-6 h-6 rounded-md border",style:{backgroundColor:z,backgroundImage:z==="transparent"?"linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc), linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc)":"none",backgroundSize:"8px 8px",backgroundPosition:"0 0, 4px 4px"}})]}),l.jsx("input",{type:"color",value:z==="transparent"?"#ffffff":z,onChange:D=>{_(D.target.value),k("backgroundColor",D.target.value)},className:"w-full h-8 cursor-pointer"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-medium mb-1.5",children:"Fondos predefinidos"}),l.jsx("div",{className:"grid grid-cols-5 gap-1.5",children:Gu.map(D=>l.jsx("button",{type:"button",className:`w-10 h-10 rounded-md cursor-pointer border transition-all hover:scale-110 ${z===D.color?"ring-2 ring-offset-1 ring-blue-500":""}`,style:{backgroundColor:D.color,backgroundImage:D.color==="transparent"?"linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc), linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc)":"none",backgroundSize:"8px 8px",backgroundPosition:"0 0, 4px 4px"},onClick:()=>{_(D.color),k("backgroundColor",D.color)},title:D.name},D.color))})]})]})})]}),l.jsxs("div",{className:"relative",ref:T,children:[l.jsx("button",{className:"flex items-center gap-1 px-2 py-1.5 rounded-md border border-gray-200 hover:bg-gray-50",onClick:()=>p(!m),title:"Transformación de texto",children:l.jsx(ei,{className:"h-4 w-4"})}),m&&l.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-[9999] w-48",children:Lu.map(D=>{var re;return l.jsx("button",{className:`w-full text-left px-3 py-1.5 hover:bg-gray-100 text-sm ${((re=e.style)==null?void 0:re.textTransform)===D.value?"bg-gray-100":""}`,style:{textTransform:D.value},onClick:()=>{k("textTransform",D.value),p(!1)},children:D.label},D.value)})})]}),l.jsxs("div",{className:"relative",ref:ge,children:[l.jsx("button",{className:"flex items-center gap-1 px-2 py-1.5 rounded-md border border-gray-200 hover:bg-gray-50",onClick:()=>h(!w),title:"Encabezados",children:l.jsx(Tr,{className:"h-4 w-4"})}),w&&l.jsxs("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-10 w-48",children:[l.jsxs("button",{className:"w-full text-left px-3 py-1.5 hover:bg-gray-100 text-sm flex items-center gap-2",onClick:()=>{k("fontSize","32px"),k("fontWeight","bold"),h(!1)},children:[l.jsx(ni,{className:"h-4 w-4"})," ","Encabezado 1"]}),l.jsxs("button",{className:"w-full text-left px-3 py-1.5 hover:bg-gray-100 text-sm flex items-center gap-2",onClick:()=>{k("fontSize","24px"),k("fontWeight","bold"),h(!1)},children:[l.jsx(ai,{className:"h-4 w-4"})," ","Encabezado 2"]}),l.jsxs("button",{className:"w-full text-left px-3 py-1.5 hover:bg-gray-100 text-sm flex items-center gap-2",onClick:()=>{k("fontSize","20px"),k("fontWeight","bold"),h(!1)},children:[l.jsx(oi,{className:"h-4 w-4"})," ","Encabezado 3"]}),l.jsxs("button",{className:"w-full text-left px-3 py-1.5 hover:bg-gray-100 text-sm flex items-center gap-2",onClick:()=>{k("fontSize","16px"),k("fontWeight","bold"),h(!1)},children:[l.jsx(ii,{className:"h-4 w-4"})," ","Encabezado 4"]}),l.jsxs("button",{className:"w-full text-left px-3 py-1.5 hover:bg-gray-100 text-sm flex items-center gap-2",onClick:()=>{k("fontSize","16px"),k("fontWeight","normal"),h(!1)},children:[l.jsx(Tr,{className:"h-4 w-4"})," Párrafo normal"]})]})]}),l.jsxs("div",{className:"flex items-center gap-0.5 border rounded-md",children:[l.jsx(J,{active:((Qe=e.style)==null?void 0:Qe.verticalAlign)==="super",onClick:()=>X("verticalAlign","super","baseline"),icon:l.jsx(Si,{className:"h-4 w-4"}),title:"Superíndice"}),l.jsx(J,{active:((We=e.style)==null?void 0:We.verticalAlign)==="sub",onClick:()=>X("verticalAlign","sub","baseline"),icon:l.jsx(Ci,{className:"h-4 w-4"}),title:"Subíndice"})]})]}),C&&P==="paragraph"&&l.jsxs("div",{className:"flex flex-wrap gap-2 items-center mt-2",children:[l.jsxs("div",{className:"flex items-center gap-0.5 border rounded-md",children:[l.jsx(J,{active:((Ze=e.style)==null?void 0:Ze.listStyleType)==="disc",onClick:()=>{var D;return k("listStyleType",((D=e.style)==null?void 0:D.listStyleType)==="disc"?"none":"disc")},icon:l.jsx(gi,{className:"h-4 w-4"}),title:"Lista con viñetas"}),l.jsx(J,{active:((_e=e.style)==null?void 0:_e.listStyleType)==="decimal",onClick:()=>{var D;return k("listStyleType",((D=e.style)==null?void 0:D.listStyleType)==="decimal"?"none":"decimal")},icon:l.jsx(ui,{className:"h-4 w-4"}),title:"Lista numerada"})]}),l.jsxs("div",{className:"flex items-center gap-0.5 border rounded-md",children:[l.jsx(J,{onClick:()=>{var re;const D=Number.parseInt(((re=e.style)==null?void 0:re.textIndent)||"0");k("textIndent",`${D+20}px`)},icon:l.jsx(ci,{className:"h-4 w-4"}),title:"Aumentar sangría"}),l.jsx(J,{onClick:()=>{var re;const D=Number.parseInt(((re=e.style)==null?void 0:re.textIndent)||"0");D>=20&&k("textIndent",`${D-20}px`)},icon:l.jsx(li,{className:"h-4 w-4"}),title:"Disminuir sangría"})]}),l.jsxs("div",{className:"flex items-center gap-2 border rounded-md p-2",children:[l.jsx("span",{className:"text-xs font-medium",children:"Altura de línea:"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(An,{className:"h-3 w-3 text-gray-500"}),l.jsx("input",{type:"range",min:"1",max:"3",step:"0.1",value:Number.parseFloat(((Ve=e.style)==null?void 0:Ve.lineHeight)||"1.5"),onChange:D=>ce("lineHeight",D.target.value),className:"w-24"}),l.jsx(Pn,{className:"h-3 w-3 text-gray-500"})]}),l.jsx("span",{className:"text-xs",children:((pr=e.style)==null?void 0:pr.lineHeight)||"1.5"})]}),l.jsxs("div",{className:"flex items-center gap-2 border rounded-md p-2",children:[l.jsx("span",{className:"text-xs font-medium",children:"Espaciado:"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(An,{className:"h-3 w-3 text-gray-500"}),l.jsx("input",{type:"range",min:"-2",max:"10",step:"1",value:Number.parseInt(((He=e.style)==null?void 0:He.letterSpacing)||"0"),onChange:D=>ce("letterSpacing",`${D.target.value}px`),className:"w-24"}),l.jsx(Pn,{className:"h-3 w-3 text-gray-500"})]}),l.jsx("span",{className:"text-xs",children:((be=e.style)==null?void 0:be.letterSpacing)||"0px"})]}),l.jsxs("div",{className:"flex items-center gap-0.5 border rounded-md",children:[l.jsx(J,{active:((qe=e.style)==null?void 0:qe.fontStyle)==="italic"&&((Nr=e.style)==null?void 0:Nr.paddingLeft)==="20px"&&((Hr=e.style)==null?void 0:Hr.borderLeft)==="4px solid #ccc",onClick:()=>{var D,re,Te;((D=e.style)==null?void 0:D.fontStyle)==="italic"&&((re=e.style)==null?void 0:re.paddingLeft)==="20px"&&((Te=e.style)==null?void 0:Te.borderLeft)==="4px solid #ccc"?(k("fontStyle","normal"),k("paddingLeft","0"),k("borderLeft","none")):(k("fontStyle","italic"),k("paddingLeft","20px"),k("borderLeft","4px solid #ccc"))},icon:l.jsx(bi,{className:"h-4 w-4"}),title:"Formato de cita"}),l.jsx(J,{active:((Wr=e.style)==null?void 0:Wr.fontFamily)==="'Courier New', monospace"&&((Dr=e.style)==null?void 0:Dr.backgroundColor)==="#f5f5f5"&&((Vr=e.style)==null?void 0:Vr.padding)==="2px 4px",onClick:()=>{var D,re;((D=e.style)==null?void 0:D.fontFamily)==="'Courier New', monospace"&&((re=e.style)==null?void 0:re.backgroundColor)==="#f5f5f5"?(k("fontFamily","Arial, sans-serif"),k("backgroundColor","transparent"),k("padding","0")):(k("fontFamily","'Courier New', monospace"),k("backgroundColor","#f5f5f5"),k("padding","2px 4px"))},icon:l.jsx(ri,{className:"h-4 w-4"}),title:"Formato de código"})]})]}),C&&P==="advanced"&&l.jsxs("div",{className:"flex flex-wrap gap-2 items-center mt-2",children:[l.jsxs("div",{className:"relative",ref:$,children:[l.jsxs("button",{className:"flex items-center gap-1 px-2 py-1.5 rounded-md border border-gray-200 hover:bg-gray-50",onClick:()=>c(!s),title:"Opciones de borde",children:[l.jsx(yi,{className:"h-4 w-4"}),l.jsx("span",{className:"text-sm",children:"Bordes"})]}),s&&l.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-[9999] p-3 w-64",children:l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-medium block mb-1",children:"Estilo de borde"}),l.jsx("select",{className:"w-full p-1.5 border rounded-md text-sm",value:((qr=e.style)==null?void 0:qr.borderStyle)||"none",onChange:D=>k("borderStyle",D.target.value),children:Uu.map(D=>l.jsx("option",{value:D.value,children:D.label},D.value))})]}),((fr=e.style)==null?void 0:fr.borderStyle)&&((mr=e.style)==null?void 0:mr.borderStyle)!=="none"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-medium block mb-1",children:"Ancho de borde"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"range",min:"1",max:"10",step:"1",value:Number.parseInt(((vr=e.style)==null?void 0:vr.borderWidth)||"1"),onChange:D=>k("borderWidth",`${D.target.value}px`),className:"flex-1"}),l.jsx("span",{className:"text-xs",children:((Ue=e.style)==null?void 0:Ue.borderWidth)||"1px"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-medium block mb-1",children:"Color de borde"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"color",value:((er=e.style)==null?void 0:er.borderColor)||"#000000",onChange:D=>k("borderColor",D.target.value),className:"w-8 h-8"}),l.jsx("div",{className:"grid grid-cols-5 gap-1 flex-1",children:["#000000","#cccccc","#ff0000","#0000ff","#00ff00"].map(D=>l.jsx("button",{type:"button",className:"w-6 h-6 rounded-sm border",style:{backgroundColor:D},onClick:()=>k("borderColor",D)},D))})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-medium block mb-1",children:"Radio de borde"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"range",min:"0",max:"50",step:"1",value:Number.parseInt(((Kr=e.style)==null?void 0:Kr.borderRadius)||"0"),onChange:D=>k("borderRadius",`${D.target.value}px`),className:"flex-1"}),l.jsx("span",{className:"text-xs",children:((Ke=e.style)==null?void 0:Ke.borderRadius)||"0px"})]})]})]})]})})]}),l.jsxs("div",{className:"flex items-center gap-2 border rounded-md p-2",children:[l.jsx("span",{className:"text-xs font-medium",children:"Sombra:"}),l.jsx("button",{className:`px-2 py-1 text-xs rounded ${(rr=e.style)!=null&&rr.textShadow?"bg-blue-100 text-blue-700":"bg-gray-100"}`,onClick:()=>{var D;(D=e.style)!=null&&D.textShadow?k("textShadow",""):k("textShadow","1px 1px 2px rgba(0,0,0,0.3)")},children:(hr=e.style)!=null&&hr.textShadow?"Quitar":"Añadir"}),((Yr=e.style)==null?void 0:Yr.textShadow)&&l.jsxs("select",{className:"text-xs p-1 border rounded",value:(Xr=e.style)==null?void 0:Xr.textShadow,onChange:D=>k("textShadow",D.target.value),children:[l.jsx("option",{value:"1px 1px 2px rgba(0,0,0,0.3)",children:"Suave"}),l.jsx("option",{value:"2px 2px 4px rgba(0,0,0,0.4)",children:"Medio"}),l.jsx("option",{value:"3px 3px 6px rgba(0,0,0,0.5)",children:"Fuerte"}),l.jsx("option",{value:"0 0 5px rgba(0,0,255,0.5)",children:"Resplandor azul"}),l.jsx("option",{value:"0 0 5px rgba(255,0,0,0.5)",children:"Resplandor rojo"})]})]}),l.jsxs("div",{className:"flex items-center gap-2 border rounded-md p-2",children:[l.jsx("span",{className:"text-xs font-medium",children:"Opacidad:"}),l.jsx("div",{className:"flex items-center gap-1",children:l.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:Number.parseFloat(((Jr=e.style)==null?void 0:Jr.opacity)||"1"),onChange:D=>ce("opacity",D.target.value),className:"w-24"})}),l.jsxs("span",{className:"text-xs",children:[Math.round(Number.parseFloat(((lr=e.style)==null?void 0:lr.opacity)||"1")*100),"%"]})]}),l.jsx("div",{className:"flex items-center gap-1",children:l.jsxs("button",{className:`flex items-center gap-1 px-2 py-1.5 rounded-md border ${((Qr=e.style)==null?void 0:Qr.backgroundColor)==="#ffff00"?"bg-yellow-100":"bg-white hover:bg-gray-50"}`,onClick:()=>{var D;((D=e.style)==null?void 0:D.backgroundColor)==="#ffff00"?k("backgroundColor","transparent"):k("backgroundColor","#ffff00")},title:"Resaltar texto",children:[l.jsx(si,{className:"h-4 w-4"}),l.jsx("span",{className:"text-sm",children:"Resaltar"})]})}),l.jsxs("div",{className:"flex items-center gap-0.5 border rounded-md ml-auto",children:[l.jsx(J,{onClick:()=>{alert("Función deshacer (implementar)")},icon:l.jsx(ga,{className:"h-4 w-4"}),title:"Deshacer"}),l.jsx(J,{onClick:()=>{alert("Función rehacer (implementar)")},icon:l.jsx(xi,{className:"h-4 w-4"}),title:"Rehacer"})]})]})]})})},$u=({currentSize:e,onSizeChange:r,presetData:t,workspaceDimensions:n})=>((()=>{if(t!=null&&t.canvas_config){const o=typeof t.canvas_config=="string"?JSON.parse(t.canvas_config):t.canvas_config;let i=o.width,s=o.height;return{width:i,height:s,unit:"cm"}}return null})(),l.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 h-full items-center",children:n&&l.jsx("div",{className:"text-sm customtext-neutral-dark font-medium ml-2",children:n.originalWidth&&l.jsxs("div",{children:["Dimensiones: ",n.originalWidth," cm x",n.originalHeight," cm"]})})})),Hu=async(e,r,t)=>{var n;try{console.log("📤 [SAVE] Subiendo imagen al backend:",r);const[a,o]=e.split(","),i=((n=a.match(/data:image\/(\w+)/))==null?void 0:n[1])||"png",s=new FormData,c=atob(o),g=new Array(c.length);for(let p=0;p<c.length;p++)g[p]=c.charCodeAt(p);const f=new Uint8Array(g),d=new Blob([f],{type:`image/${i}`});s.append("image",d,`element_${r}.${i}`),s.append("project_id",t),s.append("element_id",r);const u=await fetch("/api/canvas/projects/upload-image",{method:"POST",headers:{Accept:"application/json"},credentials:"include",body:s});if(!u.ok)throw new Error("Error al subir imagen al servidor");const m=await u.json();return console.log("✅ [SAVE] Imagen subida exitosamente:",m.url),m.url}catch(a){throw console.error("❌ [SAVE] Error subiendo imagen:",a),a}},Wu=async(e,r)=>{var o,i;console.log("🔄 [SAVE] Procesando imágenes para guardado...");const t=[];let n=0,a=0;for(const s of e)for(const c of s.cells||[])for(const g of c.elements||[])g.type==="image"&&((o=g.content)!=null&&o.startsWith("data:image/"))&&n++;console.log(`📊 [SAVE] Total de imágenes base64 a procesar: ${n}`);for(const s of e){const c={...s};c.cells=[];for(const g of s.cells||[]){const f={...g};f.elements=[];for(const d of g.elements||[]){const u={...d};if(d.type==="image"&&((i=d.content)!=null&&i.startsWith("data:image/")))try{const m=await Hu(d.content,d.id,r);u.content=m,u.isUploaded=!0,a++,console.log(`✅ [SAVE] Imagen ${a}/${n} procesada`)}catch(m){console.error("❌ [SAVE] Error procesando imagen:",d.id,m),u.uploadError=m.message}f.elements.push(u)}c.cells.push(f)}t.push(c)}return console.log(`✅ [SAVE] Procesamiento completado: ${a}/${n} imágenes subidas`),t},Xt=async(e,r,t,n,a,o,i=!1)=>{try{if(!(r!=null&&r.id))throw new Error("No se encontró el ID del proyecto");console.log(`💾 [SAVE] Iniciando ${i?"auto-guardado":"guardado manual"}...`);let s=e;i||(s=await Wu(e,r.id));const c={pages:s,projectInfo:{id:r.id,item_id:t==null?void 0:t.id,title:t==null?void 0:t.title,preset_id:n==null?void 0:n.id},workspace:{width:a.width,height:a.height,scale:a.scale},meta:{savedAt:new Date().toISOString(),version:"2.0",isAutoSave:i,totalPages:e.length}},g=i?"save-progress":"save",f=await fetch(`/api/canvas/projects/${r.id}/${g}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({design_data:c,thumbnails:o})});if(!f.ok){const u=await f.json().catch(()=>({}));throw new Error(u.message||"Error al guardar el proyecto")}const d=await f.json();return console.log(`✅ [SAVE] ${i?"Auto-guardado":"Guardado"} exitoso:`,d),{success:!0,data:d}}catch(s){return console.error(`❌ [SAVE] Error en ${i?"auto-guardado":"guardado"}:`,s),{success:!1,error:s.message}}},Vu=(e,r,t,n,a,o)=>{const[i,s]=y.useState(!1),[c,g]=y.useState(null),[f,d]=y.useState(null),u=async(p=!1)=>{if(i)return console.log("⏳ [SAVE] Ya hay un guardado en progreso..."),!1;try{s(!0),d(null);const w=await Xt(e,r,t,n,a,o,p);return w.success?(g(new Date),p||Me.success("✅ Proyecto guardado exitosamente")):(d(w.error),p||Me.error(`❌ Error al guardar: ${w.error}`)),w.success}catch(w){return console.error("❌ [SAVE] Error inesperado:",w),d(w.message),p||Me.error(`❌ Error inesperado: ${w.message}`),!1}finally{s(!1)}},m=()=>{u(!1)};return y.useEffect(()=>{if(!(r!=null&&r.id)||e.length===0)return;const p=setInterval(()=>{u(!0)},3e4);return()=>clearInterval(p)},[e,r==null?void 0:r.id,a]),{isSaving:i,lastSaved:c,saveError:f,saveProject:u,handleManualSave:m}},qu=(e,r,t,n,a,o)=>{const[i,s]=y.useState("saved"),[c,g]=y.useState(null),[f,d]=y.useState(null),[u,m]=y.useState(null),[p,w]=y.useState(!1),[h,C]=y.useState(navigator.onLine),I=y.useRef(null),P=y.useRef(null),N=y.useRef(null),M=y.useRef(!1),B=y.useRef(null),z=15e3,_=2e3,V=5e3,ee=y.useCallback((k,X)=>{try{const ce={pages:k.map(J=>{var oe;return{id:J.id,layout:J.layout,cells:((oe=J.cells)==null?void 0:oe.map(me=>{var he;return{id:me.id,elements:((he=me.elements)==null?void 0:he.map(ve=>{var Y;return{id:ve.id,type:ve.type,content:ve.type==="image"&&((Y=ve.content)!=null&&Y.startsWith("data:image/"))?`[IMAGE_${ve.content.length}]`:ve.content,position:ve.position,size:ve.size,style:ve.style,filters:ve.filters,rotation:ve.rotation}}))||[]}}))||[]}})||[],workspace:{width:X==null?void 0:X.width,height:X==null?void 0:X.height}};return btoa(JSON.stringify(ce)).substring(0,32)}catch(ce){return console.warn("⚠️ [AUTO-SAVE] Error generando hash:",ce),Date.now().toString()}},[]),K=y.useCallback(()=>`album_editor_autosave_${(r==null?void 0:r.id)||"draft"}`,[r==null?void 0:r.id]),le=y.useCallback(k=>{try{const X=K(),ce={...k,savedAt:Date.now(),version:"2.1"};return localStorage.setItem(X,JSON.stringify(ce)),console.log("💾 [AUTO-SAVE] Guardado en localStorage"),!0}catch(X){return console.error("❌ [AUTO-SAVE] Error guardando en localStorage:",X),!1}},[K]),T=y.useCallback(()=>{var k;try{const X=K(),ce=localStorage.getItem(X);if(ce){const J=JSON.parse(ce);return console.log("📂 [AUTO-SAVE] Datos encontrados en localStorage:",{pages:(k=J.pages)==null?void 0:k.length,savedAt:new Date(J.savedAt).toLocaleString()}),J}}catch(X){console.error("❌ [AUTO-SAVE] Error cargando desde localStorage:",X)}return null},[K]),$=y.useCallback(async(k=!1)=>{if(M.current&&!k){console.log("⏳ [AUTO-SAVE] Guardado en progreso, saltando...");return}if(!(r!=null&&r.id)||!e||e.length===0){console.log("⚠️ [AUTO-SAVE] Datos insuficientes para guardar");return}const X=ee(e,a);if(!k&&X===N.current){console.log("📊 [AUTO-SAVE] Sin cambios detectados, saltando guardado");return}try{M.current=!0,s("saving"),m(null);const ce={pages:e,projectInfo:{id:r.id,item_id:t==null?void 0:t.id,title:t==null?void 0:t.title,preset_id:n==null?void 0:n.id},workspace:a,meta:{savedAt:new Date().toISOString(),version:"2.1",contentHash:X}};if(le(ce),h){const J=await Xt(e,r,t,n,a,o,!0);if(J.success)N.current=X,d(new Date),s("saved"),w(!1),console.log("✅ [AUTO-SAVE] Guardado exitoso en base de datos");else throw new Error(J.error)}else console.log("� [AUTO-SAVE] Sin conexión, solo guardado en localStorage"),s("pending"),w(!0)}catch(ce){console.error("❌ [AUTO-SAVE] Error:",ce),m(ce.message),s("error"),h&&(B.current=setTimeout(()=>{console.log("🔄 [AUTO-SAVE] Reintentando guardado..."),$(!0)},V))}finally{M.current=!1}},[e,r,t,n,a,o,ee,le,h]),ge=y.useCallback(async()=>{try{s("saving");const k=await Xt(e,r,t,n,a,o,!1);if(k.success){const X=ee(e,a);N.current=X,g(new Date),s("saved"),w(!1),Me.success("💾 Proyecto guardado exitosamente"),console.log("✅ [MANUAL-SAVE] Guardado manual exitoso")}else m(k.error),s("error"),Me.error(`❌ Error al guardar: ${k.error}`);return k.success}catch(k){return console.error("❌ [MANUAL-SAVE] Error:",k),m(k.message),s("error"),Me.error(`❌ Error inesperado: ${k.message}`),!1}},[e,r,t,n,a,o,ee]);return y.useEffect(()=>{if(!(r!=null&&r.id)||!e||e.length===0)return;const k=ee(e,a);return N.current&&k!==N.current?(console.log("🔄 [AUTO-SAVE] Cambios detectados, programando guardado..."),w(!0),s("pending"),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{$()},_)):N.current||(N.current=k),()=>{P.current&&clearTimeout(P.current)}},[e,a,r==null?void 0:r.id,ee,$]),y.useEffect(()=>{if(r!=null&&r.id)return I.current&&clearInterval(I.current),I.current=setInterval(()=>{p&&(console.log("⏰ [AUTO-SAVE] Auto-save periódico activado"),$())},z),()=>{I.current&&clearInterval(I.current)}},[r==null?void 0:r.id,p,$]),y.useEffect(()=>{const k=()=>{console.log("🌐 [AUTO-SAVE] Conexión restaurada"),C(!0),p&&setTimeout(()=>$(!0),1e3)},X=()=>{console.log("📴 [AUTO-SAVE] Conexión perdida"),C(!1)};return window.addEventListener("online",k),window.addEventListener("offline",X),()=>{window.removeEventListener("online",k),window.removeEventListener("offline",X)}},[p,$]),y.useEffect(()=>{const k=X=>{if(p){const ce={pages:e,projectInfo:{id:r.id},workspace:a,meta:{savedAt:new Date().toISOString()}};return le(ce),X.preventDefault(),X.returnValue="¿Estás seguro de salir? Hay cambios sin guardar.","¿Estás seguro de salir? Hay cambios sin guardar."}};return window.addEventListener("beforeunload",k),()=>window.removeEventListener("beforeunload",k)},[p,e,r==null?void 0:r.id,a,le]),y.useEffect(()=>()=>{P.current&&clearTimeout(P.current),I.current&&clearInterval(I.current),B.current&&clearTimeout(B.current)},[]),{saveStatus:i,lastSaved:c,lastAutoSaved:f,saveError:u,hasUnsavedChanges:p,isOnline:h,saveManually:ge,performAutoSave:()=>$(!0),loadFromLocalStorage:T,getStorageKey:K,autoSaveInterval:z,debounceDelay:_}},Ku=({saveStatus:e,lastSaved:r,lastAutoSaved:t,hasUnsavedChanges:n,isOnline:a,saveError:o,onManualSave:i,className:s=""})=>{const c=d=>{if(!d)return null;const m=new Date-d,p=Math.floor(m/(1e3*60)),w=Math.floor(m/1e3);if(w<30)return"hace unos segundos";if(p<1)return`hace ${w}s`;if(p<60)return`hace ${p}m`;const h=Math.floor(p/60);return h<24?`hace ${h}h`:d.toLocaleDateString()},f=(()=>{if(!a)return{icon:l.jsx(kn,{className:"w-4 h-4"}),color:"text-orange-500",bg:"bg-orange-50 border-orange-200",text:"Sin conexión",detail:"Guardado local activo"};switch(e){case"saving":return{icon:l.jsx(Vo,{className:"w-4 h-4 animate-spin"}),color:"text-blue-500",bg:"bg-blue-50 border-blue-200",text:"Guardando...",detail:"Sincronizando cambios"};case"saved":return{icon:l.jsx(pa,{className:"w-4 h-4"}),color:"text-green-500",bg:"bg-green-50 border-green-200",text:"Guardado",detail:t?`Auto-guardado ${c(t)}`:"Todo sincronizado"};case"error":return{icon:l.jsx(ma,{className:"w-4 h-4"}),color:"text-red-500",bg:"bg-red-50 border-red-200",text:"Error al guardar",detail:o||"Error desconocido"};case"pending":return{icon:l.jsx(Wo,{className:"w-4 h-4"}),color:"text-yellow-600",bg:"bg-yellow-50 border-yellow-200",text:n?"Cambios pendientes":"Pendiente",detail:"Esperando a guardar..."};default:return{icon:l.jsx($o,{className:"w-4 h-4"}),color:"text-gray-500",bg:"bg-gray-50 border-gray-200",text:"Listo",detail:"Sistema de guardado activo"}}})();return l.jsxs("div",{className:`relative group ${s}`,children:[l.jsxs("div",{className:`
                    inline-flex items-center gap-2 px-3 py-2 rounded-lg border-2 
                    transition-all duration-200 cursor-pointer
                    ${f.bg} ${f.color}
                    hover:shadow-md
                `,onClick:()=>e!=="saving"&&(i==null?void 0:i()),children:[f.icon,l.jsx("span",{className:"text-sm font-medium",children:f.text}),n&&e!=="saving"&&l.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),l.jsx("div",{className:"flex items-center",children:a?l.jsx(Ii,{className:"w-3 h-3 text-green-500"}):l.jsx(kn,{className:"w-3 h-3 text-orange-500"})})]}),l.jsxs("div",{className:`
                absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2
                bg-gray-900 text-white text-xs rounded-lg px-3 py-2 shadow-lg
                opacity-0 group-hover:opacity-100 pointer-events-none
                transition-opacity duration-200 z-50 whitespace-nowrap
            `,children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"font-medium",children:f.text}),l.jsx("div",{className:"text-gray-300",children:f.detail}),r&&l.jsxs("div",{className:"text-gray-400 text-xs",children:["Último guardado manual: ",c(r)]}),l.jsxs("div",{className:"text-gray-400 text-xs",children:[a?"🌐 En línea":"📴 Sin conexión",e!=="saving"&&" • Click para guardar"]})]}),l.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]}),e==="saving"&&l.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-blue-200 rounded-b-lg overflow-hidden",children:l.jsx("div",{className:"h-full bg-blue-500 animate-pulse"})})]})},Yu=({isOpen:e,onClose:r,savedProgress:t,onLoadProgress:n,onDiscardProgress:a})=>{var f;const[o,i]=y.useState(!1);if(!e||!t)return null;const s=async()=>{i(!0);try{await n(t),r()}catch(d){console.error("Error cargando progreso:",d)}finally{i(!1)}},c=async()=>{i(!0);try{await a(),r()}catch(d){console.error("Error descartando progreso:",d)}finally{i(!1)}},g=d=>{const u=new Date(d),p=new Date-u,w=Math.floor(p/(1e3*60)),h=Math.floor(w/60),C=Math.floor(h/24);return w<1?"hace unos segundos":w<60?`hace ${w} minutos`:h<24?`hace ${h} horas`:C===1?"ayer":C<7?`hace ${C} días`:u.toLocaleDateString()};return l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-auto",children:[l.jsxs("div",{className:"flex items-center gap-3 p-6 border-b border-gray-200",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(ga,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Progreso Guardado Encontrado"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Se encontró un trabajo sin finalizar"})]})]}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(_o,{className:"w-4 h-4 text-gray-400 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Guardado automáticamente"}),l.jsx("div",{className:"text-xs text-gray-500",children:g(t.savedAt)})]})]}),t.pages&&l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(Ho,{className:"w-4 h-4 text-gray-400 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm text-gray-700",children:[t.pages.length," páginas en progreso"]}),l.jsx("div",{className:"text-xs text-gray-500",children:((f=t.meta)==null?void 0:f.version)||"Versión no especificada"})]})]})]}),l.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(ma,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-sm text-amber-800",children:[l.jsx("div",{className:"font-medium mb-1",children:"¿Qué te gustaría hacer?"}),l.jsx("div",{className:"text-amber-700",children:"Puedes continuar desde donde lo dejaste o comenzar un nuevo diseño."})]})]})})]}),l.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200",children:[l.jsxs("button",{onClick:s,disabled:o,className:`flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2.5 rounded-lg font-medium \r
                                 flex items-center justify-center gap-2 transition-colors disabled:opacity-50`,children:[o?l.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):l.jsx(pa,{className:"w-4 h-4"}),"Continuar Editando"]}),l.jsxs("button",{onClick:c,disabled:o,className:`flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2.5 rounded-lg font-medium \r
                                 flex items-center justify-center gap-2 transition-colors disabled:opacity-50`,children:[l.jsx(fa,{className:"w-4 h-4"}),"Comenzar de Nuevo"]})]}),l.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",disabled:o,children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},zt=fe.memo(({pageId:e,thumbnail:r,altText:t,type:n})=>{if(r)return l.jsx("img",{src:r,alt:t,className:"w-full h-full object-contain",loading:"lazy",style:{transition:"opacity 0.2s ease-in-out",imageRendering:"optimizeQuality"}});const a=n==="cover"||n==="final"?$t:()=>l.jsx("div",{className:"grid grid-cols-2 gap-0.5 w-8 h-8",children:Array.from({length:4}).map((o,i)=>l.jsx("div",{className:"bg-gray-300 rounded-sm"},i))});return l.jsx("div",{className:"w-full h-full flex items-center justify-center",children:l.jsx("div",{className:`${n==="cover"?"text-purple-300":n==="final"?"text-green-300":"text-gray-300"}`,children:l.jsx(a,{})})})});function Ug(){var D,re,Te,Ye,br,yn;const[e,r]=y.useState(null),[t,n]=y.useState(null),[a,o]=y.useState(null),[i,s]=y.useState(null),[c,g]=y.useState(!0),[f,d]=y.useState(null);y.useEffect(()=>{(async()=>{var b;try{const S=new URLSearchParams(window.location.search).get("project");if(!S){d("No se encontró el ID del proyecto en la URL"),g(!1);return}console.log("� Cargando proyecto con ID:",S);const E=await fetch(`/api/canvas/projects/${S}`,{headers:{"X-CSRF-TOKEN":((b=document.querySelector('meta[name="csrf-token"]'))==null?void 0:b.content)||""}});if(!E.ok)throw new Error("Error al cargar el proyecto");const R=await E.json();console.log("✅ Datos del proyecto cargados:",R),r(R.project),n(R.item),o(R.canvasPreset),s(R.initialProject),g(!1)}catch(x){console.error("❌ Error cargando proyecto:",x),d(x.message),g(!1)}})()},[]),y.useEffect(()=>{e&&t&&a&&(console.log("🔍 Editor datos cargados exitosamente:"),console.log("📦 project:",e),console.log("🎯 item:",t),console.log("🎨 canvasPreset:",a),console.log("📄 initialProject:",i))},[e,t,a,i]),y.useEffect(()=>{if(i&&t&&a){if(console.log("🔄 Actualizando estados del editor con datos del proyecto"),i.pages&&Array.isArray(i.pages)){console.log("🔧 Recreando páginas con backgrounds actualizados...");const v=i.pages.map(b=>{let x=null,S=a.background_color||"#ffffff";return b.type==="cover"?t.cover_image?(x=`/storage/images/item/${t.cover_image}`,console.log("🖼️ [UPDATE] Cover page - usando cover_image:",x)):console.log("🎨 [UPDATE] Cover page - usando background_color:",S):b.type==="content"?t.content_image?(x=`/storage/images/item/${t.content_image}`,console.log("🖼️ [UPDATE] Content page - usando content_image:",x)):console.log("🎨 [UPDATE] Content page - usando background_color:",S):(b.type==="final"||b.type==="contraportada")&&(t.back_cover_image?(x=`/storage/images/item/${t.back_cover_image}`,console.log("🖼️ [UPDATE] Final page - usando back_cover_image:",x)):console.log("🎨 [UPDATE] Final page - usando background_color:",S)),{...b,backgroundImage:x,backgroundColor:S}});console.log("✅ Páginas actualizadas con backgrounds:",v),w(v),T([JSON.stringify(v)]),ge(0)}else{console.log("🆕 No hay páginas existentes, creando nuevas...");const v=Dr(a,t);w(v),T([JSON.stringify(v)]),ge(0)}typeof i.currentPage=="number"&&C(i.currentPage),i.workspaceSize&&P(i.workspaceSize)}},[i,t,a]);const[u,m]=y.useState(Dn.Local.get(`${At.APP_CORRELATIVE}_cart`)??[]);y.useEffect(()=>{Dn.Local.set(`${At.APP_CORRELATIVE}_cart`,u)},[u]);const[p,w]=y.useState([]),[h,C]=y.useState(0),[I,P]=y.useState("preset"),[N,M]=y.useState(null),[B,z]=y.useState(null),[_,V]=y.useState("elements"),[ee,K]=y.useState("basic"),[le,T]=y.useState([JSON.stringify(p)]),[$,ge]=y.useState(0),[k,X]=y.useState(!1),[ce,J]=y.useState(null),[oe,me]=y.useState({}),he=y.useRef(),ve=()=>{if(a!=null&&a.width&&(a!=null&&a.height)){let O=a.width,F=a.height,Z=O*37.8,q=F*37.8;if(Z&&q){const te=window.innerWidth*.6,W=window.innerHeight*.7,A=te/Z,Q=W/q,U=Math.min(A,Q,1);return{width:Math.round(Z*U),height:Math.round(q*U),originalWidth:O,originalHeight:F,scale:U,unit:"cm",originalWidthPx:Math.round(Z),originalHeightPx:Math.round(q)}}}if(a!=null&&a.extra_settings)try{const O=typeof a.extra_settings=="string"?JSON.parse(a.extra_settings):a.extra_settings;if(O!=null&&O.canvas_config){const F=O.canvas_config;let Z=F.width,q=F.height,te=Z*37.8,W=q*37.8;if(te&&W){const A=window.innerWidth*.6,Q=window.innerHeight*.7,U=A/te,ie=Q/W,ue=Math.min(U,ie,1);return{width:Math.round(te*ue),height:Math.round(W*ue),originalWidth:Z,originalHeight:q,scale:ue,unit:"cm",originalWidthPx:Math.round(te),originalHeightPx:Math.round(W)}}}}catch(O){console.warn("Error parsing extra_settings:",O)}const v={square:{width:600,height:600},landscape:{width:1280,height:720},portrait:{width:600,height:800},wide:{width:1200,height:600},tall:{width:540,height:960},preset:{width:800,height:600}},b=v[I]||v.preset,x=window.innerWidth*.6,S=window.innerHeight*.7,E=x/b.width,R=S/b.height,L=Math.min(E,R,1);return{width:Math.round(b.width*L),height:Math.round(b.height*L),originalWidth:b.width,originalHeight:b.height,scale:L,unit:"px"}},[Y,Ne]=y.useState({width:800,height:600}),Se=y.useCallback(async(v={type:"thumbnail"})=>{if(!p[h])return null;try{let b=document.querySelector(`#page-${p[h].id}`);if(!b)return console.warn("❌ THUMBNAIL: No se encontró el elemento de página específico"),null;console.log("📸 [THUMBNAIL-FIX] Elemento workspace encontrado:",b),console.log("📸 [THUMBNAIL-FIX] Dimensiones del elemento:",{offsetWidth:b.offsetWidth,offsetHeight:b.offsetHeight,style_width:b.style.width,style_height:b.style.height,background:getComputedStyle(b).backgroundColor,backgroundImage:getComputedStyle(b).backgroundImage}),console.log("📐 [THUMBNAIL-FIX] Dimensiones del workspace desde BD:",Y);const x=p[h];console.log("📸 [THUMBNAIL-FIX] Datos de la página actual:",{id:x==null?void 0:x.id,type:x==null?void 0:x.type,backgroundImage:x==null?void 0:x.backgroundImage,backgroundColor:x==null?void 0:x.backgroundColor});const S=v.type==="pdf",E=S?3:1,R=S?1:.9,L=getComputedStyle(b);let O=(x==null?void 0:x.backgroundColor)||"#ffffff";L.backgroundColor&&L.backgroundColor!=="rgba(0, 0, 0, 0)"&&(O=L.backgroundColor),console.log("🎨 [THUMBNAIL-FIX] Background detectado:",O);const F={scale:E,useCORS:!0,allowTaint:!1,backgroundColor:O,width:Y.width,height:Y.height,x:0,y:0,scrollX:0,scrollY:0,foreignObjectRendering:!1,removeContainer:!1,logging:!1,imageTimeout:15e3,onclone:async te=>{console.log("🔍 [THUMBNAIL-FIX] Iniciando proceso de clonado para elemento de página específico..."),[".toolbar",".ui-element",".floating",".overlay",".modal",".popover",".text-toolbar",".element-selector",".element-controls",".resize-handle",".sidebar",".panel",".btn",".button",".control",".menu",".dropdown",".tooltip",".pointer-events-none",'[data-exclude-thumbnail="true"]'].forEach(A=>{try{te.querySelectorAll(A).forEach(U=>U.remove())}catch(Q){console.warn("Error removing selector:",A,Q)}});try{const A=te.querySelector(`#page-${p[h].id}`);console.log("🖼️ [THUMBNAIL-FIX] Elemento de página clonado encontrado:",A),A&&(A.style.width=Y.width+"px",A.style.height=Y.height+"px",A.style.position="relative",A.style.overflow="hidden",x!=null&&x.backgroundImage&&(console.log("🖼️ [THUMBNAIL-FIX] Aplicando backgroundImage de página:",x.backgroundImage),A.style.backgroundImage=`url(${x.backgroundImage})`,A.style.backgroundSize="cover",A.style.backgroundPosition="center",A.style.backgroundRepeat="no-repeat"),x!=null&&x.backgroundColor&&(console.log("🎨 [THUMBNAIL-FIX] Aplicando backgroundColor de página:",x.backgroundColor),A.style.backgroundColor=x.backgroundColor),console.log("🎨 [THUMBNAIL-FIX] Dimensiones del elemento de página aplicadas:",{width:A.style.width,height:A.style.height,backgroundColor:A.style.backgroundColor,backgroundImage:A.style.backgroundImage}))}catch(A){console.error("❌ [THUMBNAIL-FIX] Error configurando elemento de página:",A)}try{console.log("🔧 [ADVANCED-THUMBNAIL] Iniciando pre-procesamiento avanzado de imágenes...");const A=new Map;b.querySelectorAll('[data-element-type="image"] img, .workspace-image, img').forEach((ne,Be)=>{if(ne.complete&&ne.naturalWidth>0){const Ae=(ne.closest('[data-element-type="image"]')||ne.parentElement).getBoundingClientRect(),cr=ne.getBoundingClientRect();A.set(ne.src,{src:ne.src,naturalWidth:ne.naturalWidth,naturalHeight:ne.naturalHeight,containerWidth:Ae.width,containerHeight:Ae.height,objectFit:getComputedStyle(ne).objectFit||"cover",objectPosition:getComputedStyle(ne).objectPosition||"center",crossOrigin:ne.crossOrigin}),console.log(`📊 [ADVANCED-THUMBNAIL] Imagen ${Be} datos capturados:`,A.get(ne.src))}});const U=async(ne,Be,Ee,Ae,cr)=>new Promise(Zr=>{try{const Ar=Be/Ee,Et=Ae/cr;let _r,et,It,Nt,wn,Cn;Et>Ar?(Cn=Ee,wn=Ee*Et,et=cr,_r=cr*Ar,It=(Ae-_r)/2,Nt=0):(wn=Be,Cn=Be/Et,_r=Ae,et=Ae/Ar,It=0,Nt=(cr-et)/2);const rt=te.createElement("canvas");rt.width=Be,rt.height=Ee;const So=rt.getContext("2d"),Pr=new Image;Pr.crossOrigin="anonymous",Pr.onload=()=>{try{So.drawImage(Pr,It,Nt,_r,et,0,0,Be,Ee);const Dt=rt.toDataURL("image/png",.9);ne.src=Dt,ne.style.objectFit="fill",ne.style.objectPosition="center",ne.style.width="100%",ne.style.height="100%",console.log("✅ [ADVANCED-THUMBNAIL] Imagen pre-procesada con object-fit cover simulado"),Zr()}catch(Dt){console.warn("⚠️ [ADVANCED-THUMBNAIL] Error en canvas processing:",Dt),Zr()}},Pr.onerror=()=>{console.warn("⚠️ [ADVANCED-THUMBNAIL] Error cargando imagen temporal"),Zr()},Pr.src=ne.src}catch(Ar){console.warn("⚠️ [ADVANCED-THUMBNAIL] Error en simulateObjectFitCover:",Ar),Zr()}}),ie=te.querySelectorAll('[data-element-type="image"] img, .workspace-image, img'),ue=[];ie.forEach((ne,Be)=>{if(ne.src&&A.has(ne.src)){const Ee=A.get(ne.src),Ae=ne.closest('[data-element-type="image"]')||ne.parentElement;if(Ae&&(Ae.style.overflow="hidden",Ae.style.position="relative"),Ee.objectFit==="cover"||ne.classList.contains("object-cover")||ne.classList.contains("workspace-image")){console.log(`🔄 [ADVANCED-THUMBNAIL] Procesando imagen ${Be} con pre-procesamiento...`);const cr=U(ne,Ee.containerWidth,Ee.containerHeight,Ee.naturalWidth,Ee.naturalHeight);ue.push(cr)}else ne.style.width="100%",ne.style.height="100%",ne.style.objectFit="fill"}}),ue.length>0&&(console.log(`⏳ [ADVANCED-THUMBNAIL] Esperando procesamiento de ${ue.length} imágenes...`),await Promise.all(ue),console.log("✅ [ADVANCED-THUMBNAIL] Todas las imágenes pre-procesadas exitosamente"));const pe=te.createElement("style");pe.textContent=`
                            /* CORRECCIÓN THUMBNAIL: Estructura del elemento de página */
                            #page-${p[h].id} {
                                width: ${Y.width}px !important;
                                height: ${Y.height}px !important;
                                position: relative !important;
                                overflow: hidden !important;
                                box-sizing: border-box !important;
                            }
                            
                            /* Imágenes ya pre-procesadas - mantener dimensiones */
                            img {
                                width: 100% !important;
                                height: 100% !important;
                                object-fit: fill !important; /* fill porque ya están recortadas */
                                object-position: center !important;
                                display: block !important;
                            }
                            
                            /* Contenedores de imagen */
                            [data-element-type="image"] {
                                overflow: hidden !important;
                                position: relative !important;
                            }
                            
                            [data-element-type="image"] > div {
                                width: 100% !important;
                                height: 100% !important;
                                overflow: hidden !important;
                            }
                            
                            /* Backgrounds de página */
                            #page-${p[h].id} {
                                background-size: cover !important;
                                background-position: center !important;
                                background-repeat: no-repeat !important;
                            }
                            
                            /* Resetear estilos que puedan interferir */
                            img {
                                max-width: none !important;
                                max-height: none !important;
                                border: none !important;
                                outline: none !important;
                            }
                        `,te.head.appendChild(pe),console.log("✅ [ADVANCED-THUMBNAIL] CSS para imágenes pre-procesadas aplicado"),console.log("🎯 [ADVANCED-THUMBNAIL] Pre-procesamiento avanzado completado - listo para html2canvas")}catch(A){console.error("❌ [ADVANCED-THUMBNAIL] Error en pre-procesamiento avanzado:",A);const Q=te.createElement("style");Q.textContent=`
                            img { object-fit: cover !important; object-position: center !important; }
                            [data-element-type="image"] { overflow: hidden !important; }
                        `,te.head.appendChild(Q)}console.log("✅ [THUMBNAIL-FIX] Proceso de clonado completado - elemento de página con dimensiones exactas")}};console.log("📸 [THUMBNAIL-FIX] Iniciando captura de elemento de página con dimensiones exactas de BD:",F);const Z=await In(b,F);if(!Z)throw new Error("html2canvas no devolvió un canvas válido para el elemento de página");if(Z.width===0||Z.height===0)throw new Error("Canvas del elemento de página tiene dimensiones inválidas");const q=Z.toDataURL("image/png",R);if(!q||q==="data:,")throw new Error("No se pudo generar dataURL del elemento de página");return console.log("✅ [THUMBNAIL-FIX] Captura de elemento de página exitosa para página:",p[h].id,"Tipo:",v.type),console.log("📊 [THUMBNAIL-FIX] Canvas del elemento de página generado:",{width:Z.width,height:Z.height,expectedWidth:Y.width*E,expectedHeight:Y.height*E,dataUrlLength:q.length,workspaceBackground:O}),S?Z:q}catch(b){console.error("❌ [THUMBNAIL-FIX] Error capturando elemento de página:",b);try{console.log("🔄 [THUMBNAIL-FIX] Intentando fallback con canvas de elemento de página...");const x=document.createElement("canvas"),S=v.type==="pdf"?3:1;x.width=Y.width*S,x.height=Y.height*S;const E=x.getContext("2d"),R=workspaceBackground||(currentPageData==null?void 0:currentPageData.backgroundColor)||"#ffffff";if(E.fillStyle=R,E.fillRect(0,0,x.width,x.height),E.fillStyle=R==="#ffffff"||R.includes("white")?"#374151":"#666666",E.font=`${14*S}px Arial`,E.textAlign="center",E.fillText("Página "+(h+1),x.width/2,x.height/2),console.log("🔄 [THUMBNAIL-FIX] Fallback creado con dimensiones exactas:",{width:x.width,height:x.height,expectedDimensions:Y,background:R}),v.type==="pdf")return x;{const L=x.toDataURL("image/png",.8);return console.log("✅ [DEBUG] Fallback thumbnail creado"),L}}catch(x){return console.error("❌ [DEBUG] Error en fallback:",x),null}}},[h,p]),De=y.useCallback(async()=>{if(!p[h])return;const v=await Se({type:"thumbnail"});v&&(me(b=>({...b,[p[h].id]:v})),console.log("🖼️ Thumbnail generated for page:",p[h].id))},[Se,h,p]);y.useCallback(()=>{clearTimeout(he.current),he.current=setTimeout(()=>{p[h]&&!oe[p[h].id]&&De()},1200)},[De,p,h,oe]);const $e=y.useCallback(()=>{p[h]&&!oe[p[h].id]&&setTimeout(()=>{De()},300)},[De,p,h,oe]),Xe=y.useCallback(async(v=h,b={width:400,height:300})=>{var x,S;if(!p[v])return null;try{console.log(`🔍 Generando thumbnail de alta calidad para página ${v+1}`);const E=h;v!==h&&(C(v),await new Promise(F=>setTimeout(F,100)));const R=document.querySelector(`#page-${p[v].id}`);if(!R)return console.warn("Workspace element not found for page:",p[v].id),null;const L={scale:2,useCORS:!0,allowTaint:!1,backgroundColor:((x=p[v])==null?void 0:x.backgroundColor)||"#ffffff",width:R.offsetWidth,height:R.offsetHeight,removeContainer:!0,logging:!1,onclone:F=>{[".toolbar",".ui-element",".floating",".overlay",".modal",".popover",".text-toolbar",".element-selector",".element-controls",".resize-handle",".sidebar",".panel",".btn",".button",".control",".menu",".dropdown",".tooltip",".pointer-events-none",'[data-exclude-thumbnail="true"]'].forEach(A=>{F.querySelectorAll(A).forEach(U=>U.remove())});const q=F.querySelector(`#page-${p[v].id}`);if(q){const A=p[v];A!=null&&A.backgroundImage&&(console.log("🖼️ [HIGH-QUALITY] Aplicando backgroundImage al clon:",A.backgroundImage),q.style.backgroundImage=`url(${A.backgroundImage})`,q.style.backgroundSize="cover",q.style.backgroundPosition="center",q.style.backgroundRepeat="no-repeat"),A!=null&&A.backgroundColor&&(console.log("🎨 [HIGH-QUALITY] Aplicando backgroundColor al clon:",A.backgroundColor),q.style.backgroundColor=A.backgroundColor)}try{const A=R.querySelectorAll("img"),Q=new Map;A.forEach((ie,ue)=>{const pe=getComputedStyle(ie);Q.set(ue,{objectFit:pe.objectFit,objectPosition:pe.objectPosition,width:pe.width,height:pe.height,borderRadius:pe.borderRadius,transform:pe.transform})}),F.querySelectorAll("img").forEach((ie,ue)=>{const pe=Q.get(ue);pe&&(ie.style.objectFit=pe.objectFit||"cover",ie.style.objectPosition=pe.objectPosition||"center",ie.style.width=pe.width,ie.style.height=pe.height,ie.style.borderRadius=pe.borderRadius,ie.style.transform=pe.transform,console.log(`🖼️ [HIGH-QUALITY] Imagen ${ue} - Estilos aplicados:`,{objectFit:ie.style.objectFit,objectPosition:ie.style.objectPosition,width:ie.style.width,height:ie.style.height}))})}catch(A){console.warn("Error preservando estilos de imágenes:",A),F.querySelectorAll("img").forEach(U=>{U.style.objectFit="cover",U.style.objectPosition="center",U.style.width||(U.style.width="100%"),U.style.height||(U.style.height="100%")})}F.querySelectorAll('[class*="text-"], p, span, div, h1, h2, h3, h4, h5, h6, [contenteditable]').forEach(A=>{const Q=A.className;Q&&(A.className=Q);const U=getComputedStyle?getComputedStyle(A):null;U&&(U.fontFamily&&U.fontFamily!=="Arial"&&(A.style.fontFamily=U.fontFamily),U.fontSize&&(A.style.fontSize=U.fontSize),U.fontWeight&&(A.style.fontWeight=U.fontWeight),U.fontStyle&&(A.style.fontStyle=U.fontStyle))});const W=F.createElement("style");W.textContent=`
                        /* Preservar fuentes originales y NO forzar Arial */
                        * { 
                            -webkit-font-smoothing: antialiased !important;
                            -moz-osx-font-smoothing: grayscale !important;
                        }
                        
                        /* CRÍTICO: Asegurar que las imágenes mantengan cover */
                        img {
                            object-fit: cover !important;
                            object-position: center !important;
                        }
                        
                        /* CRÍTICO: Asegurar que los backgrounds de página se mantengan en cover */
                        [id^="page-"] {
                            background-size: cover !important;
                            background-position: center !important;
                            background-repeat: no-repeat !important;
                        }
                        
                        /* Asegurar que los elementos de texto mantengan sus fuentes */
                        [class*="text-"], p, span, div, h1, h2, h3, h4, h5, h6 {
                            font-family: inherit !important;
                        }
                    `,F.head.appendChild(W)}},O=await In(R,L);if(b.width!==O.width||b.height!==O.height){const F=document.createElement("canvas");F.width=b.width,F.height=b.height;const Z=F.getContext("2d"),q=O.width/O.height,te=b.width/b.height;let W,A,Q=0,U=0;q>te?(W=b.width,A=b.width/q,U=(b.height-A)/2):(A=b.height,W=b.height*q,Q=(b.width-W)/2),Z.fillStyle=((S=p[v])==null?void 0:S.backgroundColor)||"#ffffff",Z.fillRect(0,0,b.width,b.height),Z.drawImage(O,Q,U,W,A);const ie=F.toDataURL("image/png",.9);return v!==E&&C(E),ie}return v!==E&&C(E),O.toDataURL("image/png",.9)}catch(E){return console.error("❌ Error generando thumbnail de alta calidad:",E),null}},[p,h,C]);y.useEffect(()=>{const v=ve();Ne(v)},[a,I]),y.useEffect(()=>{const v=()=>{const b=ve();Ne(b)};return window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[a,I]),y.useEffect(()=>{if(p[h]&&!oe[p[h].id]){const v=setTimeout(()=>{$e()},400);return()=>clearTimeout(v)}},[h]),y.useEffect(()=>{const v=`${Y.width}x${Y.height}`,b=sessionStorage.getItem("lastWorkspaceDimensions");b&&b!==v&&p.length>0&&(console.log("🔄 Dimensiones del workspace cambiaron, limpiando miniaturas"),me({}),setTimeout(()=>{p[h]&&$e()},800)),sessionStorage.setItem("lastWorkspaceDimensions",v)},[Y.width,Y.height]);const[Ge,Re]=y.useState(!1),[Je,Qe]=y.useState({elementId:null,cellId:null}),[We,Ze]=y.useState(!1),[_e,Ve]=y.useState(!1),[pr,He]=y.useState(null),be=qu(p,e,t,a,Y,oe);Vu(p,e,t,a,{width:800,height:600},oe);const qe=()=>`editor_progress_project_${e==null?void 0:e.id}`,Nr=y.useCallback(async()=>{var v,b,x,S;if(e!=null&&e.id)try{const E=be.loadFromLocalStorage(),R=await fetch(`/api/canvas/projects/${e.id}/load-progress`,{headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});let L=null;if(R.ok){const F=await R.json();F.success&&((v=F.data)!=null&&v.design_data)&&(L=F.data)}let O=null;if(E&&L){const F=new Date(E.savedAt).getTime(),Z=new Date(L.saved_at).getTime();O=F>Z?E:L}else E?O=E:L&&(O=L);O&&(((b=O.pages)==null?void 0:b.length)>0||((S=(x=O.design_data)==null?void 0:x.pages)==null?void 0:S.length)>0)&&(console.log("💾 [RECOVERY] Progreso encontrado, mostrando modal de recuperación"),He(O),Ve(!0))}catch(E){console.error("❌ [RECOVERY] Error verificando progreso guardado:",E)}},[e==null?void 0:e.id,be]),Hr=y.useCallback(async v=>{var b;try{console.log("📂 [RECOVERY] Cargando progreso guardado...");let x=[];if(v.pages?x=v.pages:(b=v.design_data)!=null&&b.pages&&(x=v.design_data.pages),x.length>0){w(x);const S=[JSON.stringify(x)];T(S),ge(0),setTimeout(()=>{me({})},100),Me.success("✅ Progreso cargado exitosamente"),console.log("✅ [RECOVERY] Progreso cargado:",x.length,"páginas")}}catch(x){console.error("❌ [RECOVERY] Error cargando progreso:",x),Me.error("Error al cargar el progreso guardado")}},[w,T,ge,me]),Wr=y.useCallback(async()=>{try{console.log("🗑️ [RECOVERY] Descartando progreso guardado...");const v=be.getStorageKey();localStorage.removeItem(v),Me.success("Progreso anterior eliminado"),console.log("✅ [RECOVERY] Progreso descartado exitosamente")}catch(v){console.error("❌ [RECOVERY] Error descartando progreso:",v)}},[be]);y.useEffect(()=>{e&&t&&a&&(console.log("✅ Todos los datos están disponibles, inicializando editor..."),console.log("📦 projectData:",a,e,t),(!(i!=null&&i.pages)||i.pages.length===0)&&(console.log("📝 No hay páginas iniciales, creando desde preset..."),Dr(a,t)))},[e,t,a,i]),y.useEffect(()=>{e!=null&&e.id&&!c&&p.length===0&&setTimeout(()=>{Nr()},500)},[e==null?void 0:e.id,c,p.length,Nr]);const Dr=(v,b)=>{try{console.log("Creating pages from preset:",v),console.log("Item data:",b),console.log("🖼️ Imágenes disponibles:"),console.log("   - Portada (cover_image):",b.cover_image),console.log("   - Contenido (content_image):",b.content_image),console.log("   - Contraportada (back_cover_image):",b.back_cover_image),console.log("   - Color de fondo del preset:",v.background_color);const x=[],S=b.pages||v.pages||20;console.log("📄 Total pages to create:",S);const E=b.cover_image?`/storage/images/item/${b.cover_image}`:null,R=b.cover_image?null:v.background_color||"#ffffff";console.log("🖼️ [COVER] cover_image:",b.cover_image),console.log("🖼️ [COVER] backgroundImage construida:",E),console.log("🎨 [COVER] backgroundColor:",R);const L={id:"page-cover",type:"cover",layout:"layout-1",backgroundImage:E,backgroundColor:R,cells:[{id:"cell-cover-1",elements:[{id:"cover-title",type:"text",content:b.name||"Mi Álbum Personalizado",position:{x:10,y:20},size:{width:80,height:15},style:{fontSize:"28px",fontFamily:"Arial",color:"#000000",fontWeight:"bold",textAlign:"center",backgroundColor:"transparent",padding:"8px"},zIndex:2},...b.image?[{id:"cover-image",type:"image",content:`/storage/images/item/${b.image}`,position:{x:25,y:40},size:{width:50,height:40},filters:{},mask:"none",zIndex:1}]:[]]}]};x.push(L);const O=b.content_image?`/storage/images/item/${b.content_image}`:null,F=b.content_image?null:v.background_color||"#ffffff";console.log("🖼️ [CONTENT] content_image:",b.content_image),console.log("🖼️ [CONTENT] backgroundImage construida:",O),console.log("🎨 [CONTENT] backgroundColor:",F);for(let W=1;W<=S;W++){const A={id:`page-content-${W}`,type:"content",pageNumber:W,layout:"layout-1",backgroundImage:O,backgroundColor:F,cells:[{id:`cell-content-${W}-1`,elements:[{id:`page-number-${W}`,type:"text",content:`Página ${W}`,position:{x:5,y:5},size:{width:20,height:8},style:{fontSize:"14px",fontFamily:"Arial",color:"#666666",textAlign:"left"},zIndex:1},{id:`content-area-${W}`,type:"text",content:"Haz clic para agregar contenido...",position:{x:10,y:20},size:{width:80,height:60},style:{fontSize:"16px",fontFamily:"Arial",color:"#999999",textAlign:"center"},zIndex:1}]}]};x.push(A)}const Z=b.back_cover_image?`/storage/images/item/${b.back_cover_image}`:null,q=b.back_cover_image?null:v.background_color||"#ffffff";console.log("🖼️ [FINAL] back_cover_image:",b.back_cover_image),console.log("🖼️ [FINAL] backgroundImage construida:",Z),console.log("🎨 [FINAL] backgroundColor:",q);const te={id:"page-final",type:"final",layout:"layout-1",backgroundImage:Z,backgroundColor:q,cells:[{id:"cell-final-1",elements:[]}]};x.push(te),console.log("✅ Created pages:",x),w(x),C(0),v.width&&v.height&&(console.log("📐 Canvas dimensions found, setting workspace to preset dimensions"),P("preset"))}catch(x){console.error("❌ Error creating pages:",x),d(x.message)}},Vr=()=>{if(p.length===0)return"Cargando...";const v=p[h];if(!v)return"Página";switch(v.type){case"cover":return"Portada";case"content":return`Página ${v.pageNumber}`;case"final":return"Contraportada";default:return`Página ${h+1}`}},qr=()=>{if(p.length===0)return!1;const v=p[h];return(v==null?void 0:v.type)==="content"},fr=y.useMemo(()=>({cover:p.filter(v=>v.type==="cover"),content:p.filter(v=>v.type==="content"),final:p.filter(v=>v.type==="final")}),[p]),mr=y.useCallback(()=>{if(!N||!B||p.length===0)return null;const v=p[h];if(!v)return null;const b=v.cells.find(x=>x.id===B);return b?b.elements.find(x=>x.id===N):null},[N,B,p,h]),vr=(v,b)=>{if(b){const x=p[h].cells.find(E=>E.id===b),S=x==null?void 0:x.elements.find(E=>E.id===v);if(S!=null&&S.locked){console.log("Elemento bloqueado, no se puede seleccionar");const E=document.createElement("div");E.className="fixed top-4 right-4 bg-amber-100 border border-amber-400 text-amber-700 px-4 py-2 rounded-lg z-50",E.textContent="Este elemento es parte del diseño base y no se puede editar",document.body.appendChild(E),setTimeout(()=>{document.body.contains(E)&&document.body.removeChild(E)},3e3);return}}if(b&&z(b),M(v),v){const x=p[h].cells.find(E=>E.id===(b||B)),S=x==null?void 0:x.elements.find(E=>E.id===v);(S==null?void 0:S.type)==="image"?(J(S),console.log(ce)):(S==null?void 0:S.type)==="text"?(Re(!0),Qe({elementId:v,cellId:b||B})):Re(!1)}else Re(!1),J(null)},Ue=()=>{if(p.length===0)return we[0];const v=p[h];return v?we.find(b=>b.id===v.layout)||we[0]:we[0]},er=y.useCallback(v=>{console.log("📝 [DEBUG] updatePages llamado para página:",h),w(v);const b=[...le.slice(0,$+1),JSON.stringify(v)];T(b),ge(b.length-1);try{const x=qe(),S={pages:v,currentPage:h,savedAt:Date.now()},E=JSON.stringify(S),R=Math.round(E.length/1024);if(R<2048)localStorage.setItem(x,E),console.log(`💾 Progreso guardado en localStorage (${R} KB)`);else{console.warn(`⚠️ Datos demasiado grandes para localStorage (${R} KB), saltando guardado local`);try{localStorage.removeItem(x)}catch(L){console.error("Error limpiando localStorage:",L)}}}catch(x){if(console.error("❌ Error guardando en localStorage:",x),x.name==="QuotaExceededError")try{const S=qe();localStorage.removeItem(S),console.log("🧹 localStorage limpiado debido a QuotaExceededError")}catch(S){console.error("Error limpiando localStorage:",S)}}if(v[h]){const x=v[h].id;console.log("�️ [DEBUG] Invalidando miniatura por cambios en página:",x),me(S=>{const E={...S};return delete E[x],console.log("🗑️ [DEBUG] Thumbnail eliminado, forzando regeneración"),E})}},[le,$,qe,h]);y.useEffect(()=>{try{const v=qe(),b={pages:p,currentPage:h,savedAt:Date.now()},x=JSON.stringify(b),S=Math.round(x.length/1024);S<2048?localStorage.setItem(v,x):console.warn(`⚠️ Datos demasiado grandes para localStorage (${S} KB), saltando guardado`)}catch(v){if(console.error("❌ Error guardando currentPage en localStorage:",v),v.name==="QuotaExceededError")try{const b=qe();localStorage.removeItem(b),console.log("🧹 localStorage limpiado debido a QuotaExceededError")}catch(b){console.error("Error limpiando localStorage:",b)}}},[h,p,qe]),y.useCallback(()=>{me({}),console.log("🧹 Thumbnails limpiados para liberar memoria"),setTimeout(()=>{p[h]&&(console.log("🔄 Forzando regeneración de thumbnail para página actual..."),De())},500)},[De,p,h]),y.useCallback(async()=>{console.log("🐛 [DEBUG] Generando thumbnail manualmente..."),console.log("🐛 [DEBUG] Página actual:",h),console.log("🐛 [DEBUG] Datos de la página:",p[h]);try{const v=await Se({type:"thumbnail"});console.log("🐛 [DEBUG] Resultado de captura:",v?"SUCCESS":"FAILED"),v&&(me(b=>({...b,[p[h].id]:v})),console.log("🐛 [DEBUG] Thumbnail guardado exitosamente"))}catch(v){console.error("🐛 [DEBUG] Error en debug thumbnail:",v)}},[Se,h,p]);const Kr=v=>{const b=we.find(R=>R.id===v);if(!b)return;const x=[...p],S=x[h],E=Array.from({length:b.cells}).map((R,L)=>S.cells[L]||{id:`cell-${S.id}-${L+1}`,elements:[]});x[h]={...S,layout:v,cells:E},er(x),M(null),z(null)},Ke=(v,b)=>{console.log("➕ [DEBUG] addElementToCell llamado:",{cellId:v,elementId:b.id,type:b.type});const x=[...p];for(let S=0;S<x[h].cells.length;S++)x[h].cells[S].id===v&&(x[h].cells[S].elements.push(b),console.log("✅ [DEBUG] Elemento añadido a celda. Total elementos en celda:",x[h].cells[S].elements.length));er(x),M(b.id),z(v),console.log("🎯 [DEBUG] Elemento añadido, thumbnail debería regenerarse")},rr=(v,b,x,S=!1)=>{const E=[...p],R=E[h].cells.findIndex(L=>L.id===v);if(R!==-1){if(S)E[h].cells[R].elements.push({...E[h].cells[R].elements.find(L=>L.id===b),...x}),console.log("🎯 [DEBUG] Elemento duplicado, thumbnail debería regenerarse");else{const L=E[h].cells[R].elements.findIndex(O=>O.id===b);L!==-1&&(E[h].cells[R].elements[L]={...E[h].cells[R].elements[L],...x},console.log("🎯 [DEBUG] Elemento actualizado, thumbnail debería regenerarse"))}er(E)}},hr=(v,b)=>{console.log("🎯 [DEBUG] Eliminando elemento, thumbnail debería regenerarse");const x=[...p],S=x[h].cells.findIndex(E=>E.id===v);S!==-1&&(x[h].cells[S].elements=x[h].cells[S].elements.filter(E=>E.id!==b),er(x),N===b&&M(null))},Yr=()=>{$>0&&(ge($-1),w(JSON.parse(le[$-1])),M(null),z(null))},Xr=()=>{$<le.length-1&&(ge($+1),w(JSON.parse(le[$+1])),M(null),z(null))},Jr=()=>{const b={id:`text-${Date.now()}`,type:"text",content:"Haz clic para editar",position:{x:.05,y:.05},size:{width:.4,height:.15},style:{fontSize:"16px",fontFamily:"Arial",color:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",textAlign:"left",backgroundColor:"transparent",padding:"8px",borderRadius:"0px",border:"none",opacity:1}};B?Ke(B,b):console.log("Selecciona una celda primero")},lr=y.useMemo(()=>{var E;const v=p[h];if(!v)return null;const b=((E=v.cells)==null?void 0:E.flatMap(R=>R.elements||[]))||[],x=b.map(R=>({id:R.id,type:R.type,position:R.position,size:R.size}));return{pageId:v.id,elementsCount:b.length,contentHash:JSON.stringify(x).substring(0,100),backgroundImage:v.backgroundImage,backgroundColor:v.backgroundColor,layout:v.layout}},[p,h]);y.useEffect(()=>{if(p.length===0||c||!lr){console.log("🔍 [DEBUG] Saltando generación de thumbnail:",{pagesLength:p.length,isLoading:c,hasKey:!!lr});return}let v=!1;const b=async()=>{try{const S=p[h];if(!S||!S.id){console.log("🔍 [DEBUG] No hay página actual válida");return}const E=S.id;if(console.log("🔄 [DEBUG] Forzando regeneración de miniatura para página:",E),console.log("🔍 [DEBUG] Clave de generación completa:",lr),me(L=>{const O={...L};return delete O[E],O}),await new Promise(L=>setTimeout(L,100)),v){console.log("🚫 [DEBUG] Generación cancelada");return}console.log("📸 [DEBUG] Capturando workspace...");const R=await Se();R&&!v?(console.log("✅ [DEBUG] Miniatura capturada, aplicando..."),me(L=>({...L,[E]:R})),console.log("✅ [DEBUG] Miniatura regenerada exitosamente para:",E)):console.warn("⚠️ [DEBUG] No se pudo generar miniatura para:",E)}catch(S){v||console.error("❌ [DEBUG] Error regenerando miniatura:",S)}},x=setTimeout(()=>{console.log("⏰ [DEBUG] Ejecutando generación de thumbnail después del debounce"),b()},500);return()=>{v=!0,clearTimeout(x)}},[h,lr,c,Se]),y.useEffect(()=>{if(p.length===0||c)return;const v=async()=>{const x=p.filter(S=>!oe[S.id]);if(x.length!==0){console.log("🔄 Generando miniaturas en segundo plano para",x.length,"páginas");for(const S of x)try{const E=document.createElement("canvas");E.width=200,E.height=150;const R=E.getContext("2d");if(R.fillStyle=S.backgroundColor||"#ffffff",R.fillRect(0,0,200,150),S.backgroundImage)try{const O=new Image;O.crossOrigin="anonymous",await new Promise((F,Z)=>{O.onload=F,O.onerror=Z,O.src=S.backgroundImage}),R.drawImage(O,0,0,200,150)}catch(O){console.warn("No se pudo cargar imagen de fondo para miniatura:",O)}S.cells&&S.cells.forEach(O=>{O.elements&&O.elements.forEach(F=>{var Z;F.type==="text"&&F.content&&(R.fillStyle=((Z=F.style)==null?void 0:Z.color)||"#000000",R.font="12px Arial",R.fillText(F.content.substring(0,20)+(F.content.length>20?"...":""),10,30))})});const L=E.toDataURL("image/jpeg",.7);me(O=>({...O,[S.id]:L})),console.log("✅ Miniatura de fondo generada para:",S.id),await new Promise(O=>setTimeout(O,300))}catch(E){console.error("❌ Error generando miniatura de fondo para:",S.id,E)}}},b=setTimeout(()=>{v()},2e3);return()=>clearTimeout(b)},[p,oe,c]);const Qr=async()=>{var v;console.log("🛒 === INICIO addAlbumToCart ===");try{if(console.log("📊 Estado actual:",{itemData:t,presetData:a,cartLength:u==null?void 0:u.length,pagesLength:p==null?void 0:p.length}),!t||!a)return console.error("❌ Faltan datos necesarios para crear el álbum"),console.log("itemData:",t),console.log("presetData:",a),Me.error("Error: Datos del álbum incompletos"),!1;console.log("🆔 Generando project_id único...");const b=Date.now(),x=e==null?void 0:e.id;console.log("🆔 Project ID generado:",x),window.currentProjectId=x,window.albumProjectId=x,console.log("📦 Creando producto del álbum...");let S=a.cover_image;oe&&oe["page-cover"]&&(S=oe["page-cover"]);let E=S;S&&S.startsWith("data:image/")&&S.length>1e5&&(console.log("🖼️ Thumbnail muy grande, usando imagen del preset"),E=a.cover_image||"/assets/img/default-album.jpg");const R={...t,project_id:x,quantity:1,type:"custom_album"};console.log("📦 Producto del álbum creado:",R),console.log("💾 Creando registro en canvas_projects...");try{const F={id:x,name:t.name||"Álbum Personalizado",item_id:t.id,canvas_preset_id:a.id,design_data:{pages:p,workspace:{width:Y.width,height:Y.height,scale:Y.scale},itemData:t,presetData:a,createdAt:new Date().toISOString()},status:"draft"},Z=await fetch("/api/canvas/create-project",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":((v=document.querySelector('meta[name="csrf-token"]'))==null?void 0:v.getAttribute("content"))||""},credentials:"include",body:JSON.stringify(F)});if(Z.ok){const q=await Z.json();console.log("✅ Proyecto creado en canvas_projects:",q)}else console.warn("⚠️ No se pudo crear el proyecto en canvas_projects:",Z.statusText)}catch(F){console.warn("⚠️ Error creando proyecto en canvas_projects:",F)}console.log("🛒 Agregando producto al carrito...");const L=structuredClone(u),O=L.findIndex(F=>F.id==R.id);return O==-1?(L.push({...R,quantity:1}),console.log("➕ Producto agregado como nuevo item")):(L[O].quantity++,console.log("📈 Cantidad incrementada para producto existente")),m(L),console.log("✅ Carrito actualizado:",L.length,"items"),Me.success("Álbum agregado al carrito",{description:`${R.name} se ha añadido al carrito.`,icon:l.jsx(Ko,{className:"h-5 w-5 text-green-500"}),duration:3e3,position:"bottom-center"}),window.dispatchEvent(new CustomEvent("cartUpdated",{detail:{cart:L,action:"add",product:R}})),console.log("🛒 === FIN addAlbumToCart EXITOSO ==="),!0}catch(b){return console.error("❌ === ERROR EN addAlbumToCart ==="),console.error("Error completo:",b),console.error("Stack trace:",b.stack),console.error("Mensaje del error:",b.message),Me.error("Error al agregar al carrito",{description:`Error específico: ${b.message}`,duration:5e3,position:"bottom-center"}),!1}};return window.finalizeAlbumDesign=async()=>{console.log("🚀 Iniciando finalización del diseño del álbum...");try{if(!p||p.length===0)throw new Error("No hay páginas para finalizar");const b={pages:(q=>q.map(te=>({id:te.id,type:te.type,pageNumber:te.pageNumber,layout:te.layout,cells:te.cells.map(W=>({id:W.id,elements:W.elements.map(A=>{const Q={id:A.id,type:A.type,position:A.position,zIndex:A.zIndex||1};if(A.type==="image"){if(A.content.startsWith("data:image/")){const U=btoa(A.content.substring(0,100)).substring(0,20);Q.content=`[BASE64_IMAGE_${U}]`,Q.contentType=A.content.split(";")[0].split(":")[1],Q.originalSize=A.content.length}else Q.content=A.content;if(A.filters){const U=Object.entries(A.filters).filter(([ie,ue])=>ue!==0&&ue!==!1&&ue!==null).reduce((ie,[ue,pe])=>(ie[ue]=pe,ie),{});Object.keys(U).length>0&&(Q.filters=U)}A.mask&&A.mask!=="none"&&(Q.mask=A.mask),A.size&&(Q.size=A.size),A.locked&&(Q.locked=A.locked)}else if(A.type==="text"&&(Q.content=A.content,A.style)){const U=Object.entries(A.style).filter(([ie,ue])=>!(ie==="fontSize"&&ue==="16px"||ie==="color"&&ue==="#000000"||ie==="fontFamily"&&ue==="Arial")).reduce((ie,[ue,pe])=>(ie[ue]=pe,ie),{});Object.keys(U).length>0&&(Q.style=U)}return Q})}))})))(p),projectInfo:{id:e==null?void 0:e.id,item_id:t==null?void 0:t.id,title:t==null?void 0:t.title,preset_id:a==null?void 0:a.id},presetInfo:{id:a==null?void 0:a.id,name:a==null?void 0:a.name,cover_image:a==null?void 0:a.cover_image,content_image:a==null?void 0:a.content_image,back_cover_image:a==null?void 0:a.back_cover_image},workspace:{width:Y.width,height:Y.height,scale:Y.scale},meta:{finalizedAt:new Date().toISOString(),version:"1.3"}},x=JSON.stringify({design_data:b}),S=Math.round(x.length/1024),E=Math.round(S/1024*100)/100;console.log(`Tamaño del payload: ${S} KB (${E} MB)`);let R=0,L=0;p.forEach(q=>{var te;(te=q.cells)==null||te.forEach(W=>{var A;(A=W.elements)==null||A.forEach(Q=>{Q.type==="image"&&Q.content&&Q.content.startsWith("data:image/")&&(R++,L+=Q.content.length)})})});const O=Math.round(L/(1024*1024)*100)/100;if(console.log(`Imágenes base64 encontradas: ${R}, Tamaño total: ${O} MB`),S>1024&&!confirm(`El diseño contiene ${R} imágenes (${O} MB en imágenes). Payload completo: ${E} MB. Esto podría causar problemas al guardarlo. ¿Desea continuar de todos modos?`))return!1;const F=await fetch(`/api/canvas/projects/${e.id}/save`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:x});if(!F.ok){let q="Error al finalizar el diseño";try{q=(await F.json()).message||q}catch{F.status===413?q="El diseño es demasiado grande para ser guardado. Intente simplificar las imágenes.":F.status>=500&&(q="Error del servidor. Intente nuevamente más tarde.")}throw new Error(q)}const Z=await F.json();return console.log("✅ Diseño finalizado exitosamente en el servidor"),console.log("📄 Respuesta del servidor:",Z),!0}catch(v){console.error("Error al finalizar diseño:",v);let b=v.message;return v.message.includes("Failed to fetch")?b="Error de conexión. Verifique su conexión a internet e intente nuevamente.":(v.message.includes("NetworkError")||v.message.includes("net::"))&&(b="Error de red. Intente nuevamente más tarde."),alert("Error al finalizar el diseño: "+b),!1}},window.generateAlbumPDF=async()=>{console.log("🖨️ === INICIO generateAlbumPDF ===");try{const{jsPDF:v}=await Eo(async()=>{const{jsPDF:W}=await import("./jspdf.es.min-CHaihsQY.js").then(A=>A.j);return{jsPDF:W}},__vite__mapDeps([0,1,2,3,4]));let b=(a==null?void 0:a.width)||21,x=(a==null?void 0:a.height)||29.7;const S=b*28.35,E=x*28.35;console.log("📏 Dimensiones PDF:",{widthCm:b,heightCm:x,widthPt:S,heightPt:E});const R=new v({orientation:S>E?"landscape":"portrait",unit:"pt",format:[S,E],compress:!0}),L=p.length;let O=0;const F=document.createElement("div");F.id="pdf-progress",F.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",F.innerHTML=`
                <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
                    <h3 class="text-lg font-semibold mb-4">Generando PDF de alta calidad...</h3>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="pdf-progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <p class="text-sm text-gray-600 mt-2">
                        <span id="current-page">0</span> de ${L} páginas procesadas
                    </p>
                </div>
            `,document.body.appendChild(F);const Z=W=>{const A=W/L*100;document.getElementById("pdf-progress-bar").style.width=`${A}%`,document.getElementById("current-page").textContent=W};for(let W=0;W<p.length;W++){const A=p[W];console.log(`🔄 Procesando página ${W+1}/${L}: ${A.id}`);const Q=h;C(W),await new Promise(U=>setTimeout(U,500));try{const U=await Se({type:"pdf"});if(U){const ie=U.width/U.height,ue=S/E;let pe,ne,Be=0,Ee=0;ie>ue?(pe=S,ne=S/ie,Ee=(E-ne)/2):(ne=E,pe=E*ie,Be=(S-pe)/2);const Ae=U.toDataURL("image/jpeg",.95);W>0&&R.addPage([S,E]),R.addImage(Ae,"JPEG",Be,Ee,pe,ne),console.log(`✅ Página ${W+1} agregada al PDF`)}else console.warn(`⚠️ No se pudo capturar la página ${W+1}`),W>0&&R.addPage([S,E]),R.setFontSize(12),R.text(`Error al renderizar página ${W+1}`,S/2,E/2,{align:"center"})}catch(U){console.error(`❌ Error procesando página ${W+1}:`,U),W>0&&R.addPage([S,E]),R.setFontSize(12),R.text(`Error al procesar página ${W+1}`,S/2,E/2,{align:"center"})}O++,Z(O),await new Promise(U=>setTimeout(U,200))}C(originalCurrentPage);const q=`${(t==null?void 0:t.name)||"album"}_${new Date().toISOString().split("T")[0]}.pdf`;R.save(q),document.body.removeChild(F),console.log("✅ PDF generado exitosamente:",q);const te=document.createElement("div");return te.className="fixed top-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg z-50",te.innerHTML=`
                <div class="flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    <span>PDF de alta calidad generado: ${q}</span>
                </div>
            `,document.body.appendChild(te),setTimeout(()=>{document.body.contains(te)&&document.body.removeChild(te)},5e3),q}catch(v){console.error("❌ Error generando PDF:",v);const b=document.getElementById("pdf-progress");b&&document.body.removeChild(b);const x=document.createElement("div");throw x.className="fixed top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg z-50",x.innerHTML=`
                <div class="flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                    </svg>
                    <span>Error al generar PDF: ${v.message}</span>
                </div>
            `,document.body.appendChild(x),setTimeout(()=>{document.body.contains(x)&&document.body.removeChild(x)},7e3),v}},window.generateHighQualityThumbnail=Xe,window.captureCurrentWorkspace=Se,l.jsxs(Ao,{backend:Po,className:"!h-screen !w-screen overflow-hidden",children:[c?l.jsx("div",{className:"h-screen bg-gray-100 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-semibold customtext-neutral-dark mb-2",children:"Cargando Editor"}),l.jsx("p",{className:"customtext-neutral-dark",children:"Preparando tu álbum personalizado..."})]})}):f?l.jsx("div",{className:"h-screen bg-gray-100 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center max-w-md",children:[l.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Error"}),l.jsx("p",{className:"customtext-neutral-dark mb-4",children:f}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("button",{onClick:()=>window.location.reload(),className:"w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Reintentar"}),l.jsx("button",{onClick:()=>window.history.back(),className:"w-full px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"Volver"})]})]})}):p.length===0?l.jsx("div",{className:"h-screen bg-gray-100 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center max-w-md",children:[l.jsx("h2",{className:"text-xl font-semibold customtext-neutral-dark mb-2",children:"Inicializando Editor"}),l.jsx("p",{className:"customtext-neutral-dark mb-4",children:"Generando páginas del álbum..."}),l.jsx("div",{className:"animate-pulse flex space-x-4",children:l.jsxs("div",{className:"flex-1 space-y-2 py-1",children:[l.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"h-4 bg-gray-300 rounded"}),l.jsx("div",{className:"h-4 bg-gray-300 rounded w-5/6"})]})]})})]})}):l.jsxs("div",{className:"h-screen w-screen overflow-hidden bg-gray-50 font-paragraph",children:[l.jsx(zo,{isOpen:We,onRequestClose:()=>Ze(!1),pages:p.map(v=>({...v,layout:we.find(b=>b.id===v.layout)||we[0]})),workspaceDimensions:Y,getCurrentLayout:v=>v?we.find(b=>b.id===v.layout)||we[0]:we[0],presetData:a,pageThumbnails:oe,addAlbumToCart:Qr,projectData:e,itemData:t}),l.jsx("header",{className:"fixed top-0 left-0 right-0 h-16 border-b bg-primary shadow-sm flex items-center px-4 z-10",children:l.jsxs("div",{className:"container mx-auto flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:`/assets/resources/logo.png?v=${crypto.randomUUID()}`,alt:At.APP_NAME,className:"h-7 object-contain object-center invert brightness-0"}),l.jsx("div",{className:"h-6 w-px bg-white/20"}),l.jsx("h1",{className:"text-lg font-bold text-white truncate hidden sm:block",children:(e==null?void 0:e.name)||"Álbum Sin Título"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"bg-white/10 rounded-full px-4 py-1.5 flex items-center gap-2",children:[l.jsx("span",{className:"h-2 w-2 rounded-full bg-secondary animate-pulse"}),l.jsx("p",{className:"text-sm text-white font-medium",children:Vr()})]}),l.jsx("div",{className:"text-xs text-white/70 hidden sm:block",children:p.length>0&&`${p.length} páginas total`}),qr()?l.jsx("span",{className:"bg-white/10 text-white/80 px-2 py-2 rounded-md text-xs font-medium flex items-center gap-1",children:l.jsx(hi,{className:"h-3 w-3"})}):l.jsx("span",{className:"bg-white/10 text-white/80 px-2 py-2 rounded-md text-xs font-medium flex items-center gap-1",children:l.jsx(pi,{className:"h-3 w-3"})})]}),l.jsxs("div",{className:"flex gap-3 items-center",children:[l.jsx(Ku,{saveStatus:be.saveStatus,lastSaved:be.lastSaved,lastAutoSaved:be.lastAutoSaved,hasUnsavedChanges:be.hasUnsavedChanges,isOnline:be.isOnline,saveError:be.saveError,onManualSave:be.saveManually}),l.jsx(tr,{variant:"secondary",size:"sm",onClick:()=>Ze(!0),icon:l.jsx($t,{className:"h-4 w-4"}),children:"Vista de Álbum"}),!1]})]})}),l.jsxs("div",{className:"flex w-full h-full pt-16",children:[l.jsxs("aside",{className:"w-64 bg-white border-r flex flex-col",children:[l.jsx("div",{className:"p-3 border-b",children:l.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-md",children:[l.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded-md transition ${_==="elements"?"bg-white shadow-sm text-purple-700":"customtext-neutral-dark hover:bg-white/50"}`,onClick:()=>V("elements"),children:"Elementos"}),l.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded-md transition ${_==="filters"?"bg-white shadow-sm text-purple-700":"customtext-neutral-dark hover:bg-white/50"}`,onClick:()=>V("filters"),children:"Filtros"})]})}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-3 custom-scroll",children:[_==="elements"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-xs uppercase customtext-neutral-dark mb-2",children:"Layouts"}),l.jsx(Tu,{currentLayoutId:(D=p[h])==null?void 0:D.layout,onLayoutChange:Kr})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-xs uppercase customtext-neutral-dark mb-2",children:"Capas"}),l.jsx(Ru,{elements:((re=p[h].cells.find(v=>v.id===B))==null?void 0:re.elements)||[],onReorder:v=>{const b=[...p],x=b[h].cells.findIndex(S=>S.id===B);x!==-1&&(b[h].cells[x].elements=v,er(b))},onSelect:vr,selectedElement:N})]})]}),_==="filters"&&l.jsx("div",{className:"space-y-3 max-h-full",children:(()=>{const v=mr();return v?l.jsxs(l.Fragment,{children:[v.type==="image"&&l.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(it,{className:"h-4 w-4 text-purple-600"}),l.jsx("span",{className:"text-sm font-medium",children:"Imagen seleccionada"})]}),l.jsx("div",{className:"w-full h-16 rounded-md overflow-hidden bg-gray-200",children:l.jsx("img",{src:v.content,alt:"",className:"w-full h-full object-cover"})})]}),v.type==="image"&&l.jsxs("div",{className:"border-t pt-3",children:[l.jsx("h3",{className:"font-medium text-xs uppercase customtext-neutral-dark mb-2",children:"Máscaras"}),l.jsx(Bu,{selectedMask:v.mask||"none",onSelect:b=>{rr(B,N,{mask:b})},availableMasks:ua.map(b=>b.id),selectedImage:v})]}),l.jsxs("div",{className:"border-t pt-3",children:[l.jsx("h3",{className:"font-medium text-xs uppercase customtext-neutral-dark mb-2",children:"Filtros y efectos"}),l.jsx("div",{className:"",children:l.jsx(ko,{filters:v.filters||{},onFilterChange:b=>{rr(B,N,{filters:b})},selectedElement:v})})]})]}):l.jsxs("div",{className:"text-center py-8 px-2",children:[l.jsx("div",{className:"bg-gray-100 p-4 rounded-lg mb-3",children:l.jsx(it,{className:"h-6 w-6 text-gray-400 mx-auto"})}),l.jsx("h3",{className:"text-sm font-medium customtext-neutral-dark",children:"Selecciona un elemento"}),l.jsx("p",{className:"text-xs customtext-neutral-dark mt-1",children:"Para aplicar filtros y efectos, primero selecciona una imagen o texto en el lienzo"})]})})()})]})]}),l.jsxs("main",{className:"flex-1 flex flex-col h-full",children:[l.jsx("div",{className:"bg-white border-b px-4 py-2 flex items-center justify-between",children:Ge?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(tr,{variant:"ghost",size:"sm",onClick:()=>Re(!1),className:"h-8 px-2",icon:l.jsx(qo,{className:"h-4 w-4"}),children:"Volver"}),l.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"})]}),l.jsx("div",{className:"flex-1 flex justify-start",children:l.jsx(zu,{element:mr(),onUpdate:v=>{rr(Je.cellId,Je.elementId,v)},onClose:()=>Re(!1)})})]}):l.jsx(l.Fragment,{children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"flex space-x-1",children:[l.jsx(tr,{variant:"ghost",size:"sm",onClick:Yr,disabled:$<=0,className:"h-8 px-2",icon:l.jsx(jo,{className:"h-4 w-4"}),children:"Deshacer"}),l.jsx(tr,{variant:"ghost",size:"sm",onClick:Xr,disabled:$>=le.length-1,className:"h-8 px-2",icon:l.jsx(Ro,{className:"h-4 w-4"}),children:"Rehacer"})]}),l.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),l.jsxs("div",{className:"flex space-x-1",children:[l.jsx(tr,{variant:"ghost",size:"sm",onClick:()=>{const v=document.createElement("input");v.type="file",v.accept="image/*",v.onchange=b=>{if(b.target.files&&b.target.files[0]){const S={id:`img-${Date.now()}`,type:"image",content:"",position:{x:.1,y:.1},size:{width:.3,height:.3},filters:{brightness:100,contrast:100,saturation:100,tint:0,hue:0,blur:0,scale:1,rotate:0,opacity:100,blendMode:"normal"},mask:"none"},E=new FileReader;E.onload=R=>{var L,O;(L=R.target)!=null&&L.result&&(S.content=R.target.result,B?Ke(B,S):(O=p[h])!=null&&O.cells[0]&&Ke(p[h].cells[0].id,S))},E.readAsDataURL(b.target.files[0])}},v.click()},className:"h-8 px-2",icon:l.jsx(it,{className:"h-4 w-4"}),children:"Imagen"}),l.jsx(tr,{variant:"ghost",size:"sm",onClick:Jr,className:"h-8 px-2",icon:l.jsx(Tr,{className:"h-4 w-4"}),children:"Texto"})]}),l.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),N&&l.jsxs("div",{className:"flex space-x-1",children:[l.jsx(tr,{variant:"ghost",size:"sm",onClick:()=>{if(N&&B){const v=mr();if(v){const b={...v,id:`${v.type}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:{x:v.position.x+.05,y:v.position.y+.05}};Ke(B,b)}}},className:"h-8 px-2",icon:l.jsx(Mo,{className:"h-4 w-4"}),children:"Duplicar"}),l.jsx(tr,{variant:"ghost",size:"sm",onClick:()=>{N&&B&&hr(B,N)},className:"h-8 px-2 text-red-600 hover:text-white",icon:l.jsx(fa,{className:"h-4 w-4"}),children:"Eliminar"})]}),l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx($u,{currentSize:I,onSizeChange:P,presetData:a,workspaceDimensions:Y})})]})})}),l.jsx("div",{className:"flex-1 flex items-center justify-center p-6 overflow-hidden bg-gray-100",children:k?l.jsx("div",{className:"bg-white rounded-lg shadow-lg",children:l.jsx("div",{className:"overflow-hidden",style:{width:Y.width,height:Y.height},children:l.jsx("div",{id:`page-${p[h].id}`,className:`grid ${Ue().template} gap-6`,style:{width:"100%",height:"100%"},children:p[h].cells.map((v,b)=>{var x;return l.jsx(En,{id:v.id,elements:v.elements.filter(S=>!S.locked),workspaceSize:Y,cellStyle:(x=Ue().cellStyles)==null?void 0:x[p[h].cells.indexOf(v)],selectedElement:B===v.id?N:null,onSelectElement:vr,onAddElement:(S,E)=>Ke(E,S),onUpdateElement:(S,E,R)=>rr(v.id,S,E,R),onDeleteElement:S=>hr(v.id,S),availableMasks:Ue().maskCategories.flatMap(S=>S.masks)},v.id)})})})}):l.jsxs("div",{id:`page-${p[h].id}`,className:" shadow-xl overflow-hidden",style:{width:Y.width,height:Y.height,position:"relative",backgroundColor:((Te=p[h])==null?void 0:Te.backgroundColor)||"#ffffff",backgroundImage:(Ye=p[h])!=null&&Ye.backgroundImage?`url(${p[h].backgroundImage})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:["                                        ",(()=>{const v=p[h];if(console.log("🖼️ [WORKSPACE] Renderizando background para página:",v==null?void 0:v.type),console.log("🖼️ [WORKSPACE] backgroundImage:",v==null?void 0:v.backgroundImage),console.log("🖼️ [WORKSPACE] backgroundColor:",v==null?void 0:v.backgroundColor),v!=null&&v.backgroundImage){const b=window.location.origin+v.backgroundImage;console.log("🔗 [WORKSPACE] URL completa de la imagen:",b),console.log("🔗 [WORKSPACE] URL relativa:",v.backgroundImage),fetch(v.backgroundImage,{method:"HEAD"}).then(x=>{x.ok?console.log("✅ [WORKSPACE] Imagen existe en el servidor"):console.error("❌ [WORKSPACE] Imagen NO existe en el servidor. Status:",x.status)}).catch(x=>{console.error("❌ [WORKSPACE] Error verificando imagen:",x)})}return v!=null&&v.backgroundImage?(console.log("🎨 [WORKSPACE] Aplicando imagen de fondo:",v.backgroundImage),l.jsx("img",{src:v.backgroundImage,alt:"background",className:"absolute inset-0 w-full h-full object-cover pointer-events-none",style:{zIndex:1},onLoad:()=>{var b,x,S,E;console.log("✅ [WORKSPACE] Imagen de fondo cargada exitosamente"),console.log("📐 [WORKSPACE] Dimensiones de la imagen cargada:",(x=(b=arguments[0])==null?void 0:b.target)==null?void 0:x.naturalWidth,"x",(E=(S=arguments[0])==null?void 0:S.target)==null?void 0:E.naturalHeight)},onError:b=>{console.error("❌ [WORKSPACE] Error cargando imagen de fondo:",b),console.error("❌ [WORKSPACE] URL que falló:",b.target.src),console.error("❌ [WORKSPACE] Error details:",b.target.error)}})):v!=null&&v.backgroundColor?(console.log("🎨 [WORKSPACE] Aplicando color de fondo:",v.backgroundColor),l.jsx("div",{className:"absolute inset-0 w-full h-full pointer-events-none",style:{backgroundColor:v.backgroundColor,zIndex:1}})):(console.log("⚪ [WORKSPACE] Sin fondo personalizado, usando fondo por defecto"),null)})(),l.jsx("div",{className:`grid ${Ue().template}`,style:{position:"relative",zIndex:10,width:"100%",height:"100%",boxSizing:"border-box",gap:((br=Ue().style)==null?void 0:br.gap)||"16px",padding:((yn=Ue().style)==null?void 0:yn.padding)||"16px"},children:p[h].cells.map(v=>{var b;return l.jsx(En,{id:v.id,elements:v.elements.filter(x=>!x.locked),workspaceSize:Y,cellStyle:(b=Ue().cellStyles)==null?void 0:b[p[h].cells.indexOf(v)],selectedElement:B===v.id?N:null,onSelectElement:vr,onAddElement:(x,S)=>Ke(S,x),onUpdateElement:(x,S,E)=>rr(v.id,x,S,E),onDeleteElement:x=>hr(v.id,x),availableMasks:Ue().maskCategories.flatMap(x=>x.masks)},v.id)})})]})})]}),l.jsxs("aside",{className:"w-52 bg-white border-l flex flex-col h-full",children:[l.jsx("div",{className:"p-4 border-b bg-gray-50",children:l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("h3",{className:"font-medium text-sm text-gray-700 flex items-center gap-1.5",children:[l.jsx($t,{className:"h-4 w-4 text-purple-600"}),"Páginas"]}),l.jsxs("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded-full border",children:[p.length," total"]})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto p-3 custom-scroll",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-xs font-medium text-gray-500 mb-2 flex items-center",children:[l.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-purple-400 mr-1.5"}),"Portada"]}),fr.cover.map((v,b)=>l.jsx("div",{className:`relative group flex flex-col cursor-pointer  transition-all duration-200 transform 
                            ${h===p.indexOf(v)?"ring-2 ring-purple-400 scale-[1.02] shadow-md":"hover:bg-gray-50 border border-transparent hover:border-gray-200"}
                            mb-2`,onClick:()=>C(p.indexOf(v)),children:l.jsxs("div",{className:"relative bg-purple-50  overflow-hidden border aspect-[4/3] ",children:[l.jsx(zt,{pageId:v.id,thumbnail:oe[v.id],altText:"Portada",type:"cover"}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2 pt-6 group-hover:opacity-100 opacity-80 transition-opacity",children:l.jsx("span",{className:"text-[10px] text-white font-medium block",children:"Portada"})})]})},v.id))]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-xs font-medium text-gray-500 mb-2 flex items-center",children:[l.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-400 mr-1.5"}),"Páginas de contenido"]}),l.jsx("div",{className:"space-y-2",children:fr.content.map((v,b)=>l.jsx("div",{className:`relative group flex flex-col cursor-pointer  transition-all duration-200 transform 
                                ${h===p.indexOf(v)?"ring-2 ring-purple-400 scale-[1.02] shadow-md":"hover:bg-gray-50 border border-transparent hover:border-gray-200"}
                                mb-1`,onClick:()=>C(p.indexOf(v)),children:l.jsxs("div",{className:"relative  overflow-hidden border aspect-[4/3]",children:[l.jsx(zt,{pageId:v.id,thumbnail:oe[v.id],altText:`Página ${v.pageNumber}`,type:"content"}),l.jsx("div",{className:"absolute top-1 left-1 bg-white/90 rounded-full h-5 w-5 flex items-center justify-center text-[10px] font-bold shadow-sm",children:v.pageNumber}),l.jsx("div",{className:"absolute top-1 right-1 bg-blue-500 text-white text-[9px] px-1.5 py-0.5 rounded-full opacity-80 group-hover:opacity-100",children:"Editable"})]})},v.id))})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-xs font-medium text-gray-500 mb-2 flex items-center",children:[l.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-400 mr-1.5"}),"Contraportada"]}),fr.final.map((v,b)=>l.jsx("div",{className:`relative group flex flex-col cursor-pointer  transition-all duration-200 transform 
                            ${h===p.indexOf(v)?"ring-2 ring-purple-400 scale-[1.02] shadow-md":"hover:bg-gray-50 border border-transparent hover:border-gray-200"}
                            mb-2`,onClick:()=>C(p.indexOf(v)),children:l.jsxs("div",{className:"relative  overflow-hidden border mb-1 aspect-[4/3]",children:[l.jsx(zt,{pageId:v.id,thumbnail:oe[v.id],altText:"Contraportada",type:"final"}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2 pt-6 group-hover:opacity-100 opacity-80 transition-opacity",children:l.jsx("span",{className:"text-[10px] text-white font-medium block",children:"Contraportada"})})]})},v.id))]})]})})]})]})]}),l.jsx(Lo,{}),l.jsx(Yu,{isOpen:_e,onClose:()=>Ve(!1),savedProgress:pr,onLoadProgress:Hr,onDiscardProgress:Wr})]})}export{Ug as default};
