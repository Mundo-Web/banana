import{j as c}from"./AboutSimple-Cf8x2fCZ.js";import{r as s}from"./index-BH53Isel.js";import{F as Me}from"./EditorMain-rmOX089k.js";import{e as Oe}from"./index-BSWw-p5k.js";import{c as $}from"./createLucideIcon-Cy5Ya80P.js";import{C as Re}from"./copy-6OEekgvq.js";import{T as Ee}from"./trash-2-DK1wnsDn.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=$("CircleDot",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=$("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=$("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),He=s.createContext({dragDropManager:void 0});function v(e,t,...n){if(Fe()&&t===void 0)throw new Error("invariant requires an error message argument");if(!e){let r;if(t===void 0)r=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let i=0;r=new Error(t.replace(/%s/g,function(){return n[i++]})),r.name="Invariant Violation"}throw r.framesToPop=1,r}}function Fe(){return typeof process<"u"&&!0}const I=typeof window<"u"?s.useLayoutEffect:s.useEffect;function $e(e,t,n){const[r,i]=s.useState(()=>t(e)),a=s.useCallback(()=>{const d=t(e);Oe(r,d)||(i(d),n&&n())},[r,e,n]);return I(a),[r,a]}function je(e,t,n){const[r,i]=$e(e,t,n);return I(function(){const d=e.getHandlerId();if(d!=null)return e.subscribeToStateChange(i,{handlerIds:[d]})},[e,i]),r}function ze(e,t,n){return je(t,e||(()=>({})),()=>n.reconnect())}function Ye(e,t){const n=[];return typeof e!="function"&&n.push(e),s.useMemo(()=>typeof e=="function"?e():e,n)}function Xe(e){return s.useMemo(()=>e.hooks.dragSource(),[e])}function Le(e){return s.useMemo(()=>e.hooks.dragPreview(),[e])}let H=!1,F=!1;class We{receiveHandlerId(t){this.sourceId=t}getHandlerId(){return this.sourceId}canDrag(){v(!H,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return H=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{H=!1}}isDragging(){if(!this.sourceId)return!1;v(!F,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return F=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{F=!1}}subscribeToStateChange(t,n){return this.internalMonitor.subscribeToStateChange(t,n)}isDraggingSource(t){return this.internalMonitor.isDraggingSource(t)}isOverTarget(t,n){return this.internalMonitor.isOverTarget(t,n)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(t){return this.internalMonitor.subscribeToOffsetChange(t)}canDragSource(t){return this.internalMonitor.canDragSource(t)}canDropOnTarget(t){return this.internalMonitor.canDropOnTarget(t)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(t){this.sourceId=null,this.internalMonitor=t.getMonitor()}}function dt(e,t,n){const r=n.getRegistry(),i=r.addTarget(e,t);return[i,()=>r.removeTarget(i)]}function qe(e,t,n){const r=n.getRegistry(),i=r.addSource(e,t);return[i,()=>r.removeSource(i)]}function ce(e,t,n,r){let i;if(i!==void 0)return!!i;if(e===t)return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;const a=Object.keys(e),d=Object.keys(t);if(a.length!==d.length)return!1;const y=Object.prototype.hasOwnProperty.bind(t);for(let h=0;h<a.length;h++){const f=a[h];if(!y(f))return!1;const T=e[f],P=t[f];if(i=void 0,i===!1||i===void 0&&T!==P)return!1}return!0}function ue(e){return e!==null&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Ae(e){if(typeof e.type=="string")return;const t=e.type.displayName||e.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}function Ue(e){return(t=null,n=null)=>{if(!s.isValidElement(t)){const a=t;return e(a,n),a}const r=t;return Ae(r),Ve(r,n?a=>e(a,n):e)}}function Be(e){const t={};return Object.keys(e).forEach(n=>{const r=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{const i=Ue(r);t[n]=()=>i}}),t}function de(e,t){typeof e=="function"?e(t):e.current=t}function Ve(e,t){const n=e.ref;return v(typeof n!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?s.cloneElement(e,{ref:r=>{de(n,r),de(t,r)}}):s.cloneElement(e,{ref:t})}class Je{receiveHandlerId(t){this.handlerId!==t&&(this.handlerId=t,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(t){this.dragSourceOptionsInternal=t}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(t){this.dragPreviewOptionsInternal=t}reconnect(){const t=this.reconnectDragSource();this.reconnectDragPreview(t)}reconnectDragSource(){const t=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return n&&this.disconnectDragSource(),this.handlerId?t?(n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=t,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,t,this.dragSourceOptions)),n):(this.lastConnectedDragSource=t,n):n}reconnectDragPreview(t=!1){const n=this.dragPreview,r=t||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),!!this.handlerId){if(!n){this.lastConnectedDragPreview=n;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=n,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,n,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!ce(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!ce(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(t){this.hooks=Be({dragSource:(n,r)=>{this.clearDragSource(),this.dragSourceOptions=r||null,ue(n)?this.dragSourceRef=n:this.dragSourceNode=n,this.reconnectDragSource()},dragPreview:(n,r)=>{this.clearDragPreview(),this.dragPreviewOptions=r||null,ue(n)?this.dragPreviewRef=n:this.dragPreviewNode=n,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=t}}function j(){const{dragDropManager:e}=s.useContext(He);return v(e!=null,"Expected drag drop context"),e}function Ke(e,t){const n=j(),r=s.useMemo(()=>new Je(n.getBackend()),[n]);return I(()=>(r.dragSourceOptions=e||null,r.reconnect(),()=>r.disconnectDragSource()),[r,e]),I(()=>(r.dragPreviewOptions=t||null,r.reconnect(),()=>r.disconnectDragPreview()),[r,t]),r}function Qe(){const e=j();return s.useMemo(()=>new We(e),[e])}class _e{beginDrag(){const t=this.spec,n=this.monitor;let r=null;return typeof t.item=="object"?r=t.item:typeof t.item=="function"?r=t.item(n):r={},r??null}canDrag(){const t=this.spec,n=this.monitor;return typeof t.canDrag=="boolean"?t.canDrag:typeof t.canDrag=="function"?t.canDrag(n):!0}isDragging(t,n){const r=this.spec,i=this.monitor,{isDragging:a}=r;return a?a(i):n===t.getSourceId()}endDrag(){const t=this.spec,n=this.monitor,r=this.connector,{end:i}=t;i&&i(n.getItem(),n),r.reconnect()}constructor(t,n,r){this.spec=t,this.monitor=n,this.connector=r}}function Ge(e,t,n){const r=s.useMemo(()=>new _e(e,t,n),[t,n]);return s.useEffect(()=>{r.spec=e},[e]),r}function Ze(e){return s.useMemo(()=>{const t=e.type;return v(t!=null,"spec.type must be defined"),t},[e])}function et(e,t,n){const r=j(),i=Ge(e,t,n),a=Ze(e);I(function(){if(a!=null){const[y,h]=qe(a,i,r);return t.receiveHandlerId(y),n.receiveHandlerId(y),h}},[r,t,n,i,a])}function tt(e,t){const n=Ye(e);v(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const r=Qe(),i=Ke(n.options,n.previewOptions);return et(n,r,i),[ze(n.collect,r,i),Xe(i),Le(i)]}const lt=(e,t=1)=>({fontFamily:(e==null?void 0:e.fontFamily)||"Arial",fontSize:`${(parseInt(e==null?void 0:e.fontSize)||16)*t}px`,fontWeight:(e==null?void 0:e.fontWeight)||"normal",fontStyle:(e==null?void 0:e.fontStyle)||"normal",textDecoration:(e==null?void 0:e.textDecoration)||"none",textAlign:(e==null?void 0:e.textAlign)||"left",color:(e==null?void 0:e.color)||"#000000",backgroundColor:(e==null?void 0:e.backgroundColor)||"transparent",padding:parseInt(e==null?void 0:e.padding)||0,lineHeight:(e==null?void 0:e.lineHeight)||"1.4"}),gt=async e=>{if(e==="Arial"||e==="sans-serif"||e==="serif")return Promise.resolve();try{return await new Me(e).load(null,1e4),Promise.resolve()}catch(t){return console.warn(`No se pudo cargar la fuente: ${e}`,t),Promise.resolve()}};function ht({element:e,isSelected:t,onSelect:n,onUpdate:r,onDelete:i,workspaceSize:a={width:800,height:600}}){var J,K,Q,_,G,Z,ee,te,ne,re,oe,ie,se,ae;const[d,y]=s.useState(!1),h=s.useRef(null),f=s.useRef(null),[{isDragging:T},P]=tt(()=>({type:"TEXT_ELEMENT",item:{id:e.id},collect:o=>({isDragging:!!o.isDragging()})})),[p,z]=s.useState(!1),[k,le]=s.useState({x:0,y:0}),[ge,S]=s.useState(!1),[Y,he]=s.useState({x:0,y:0}),[X,L]=s.useState({x:0,y:0}),[W,q]=s.useState(!1),[fe,pe]=s.useState(0),[A,U]=s.useState(!1),[ye,we]=s.useState(0),xe=()=>{y(!1)},ve=o=>{r({content:o.target.value})},Se=o=>{o.key==="Enter"&&y(!1)},De=o=>{if(!d){o.stopPropagation(),n(),pe(Date.now()),U(!1),z(!0);const l=o.currentTarget.parentElement.getBoundingClientRect(),u=e.position.x<=1?e.position.x*l.width:e.position.x,g=e.position.y<=1?e.position.y*l.height:e.position.y;le({x:o.clientX-u,y:o.clientY-g}),L({x:u,y:g}),document.body.style.cursor="grabbing"}},B=o=>{if(p&&f.current){const l=Date.now();if(l-ye<16)return;we(l),requestAnimationFrame(()=>{if(!f.current)return;const u=f.current.parentElement.getBoundingClientRect(),g=o.clientX-k.x,D=o.clientY-k.y,m=5;!A&&(Math.abs(g-X.x)>m||Math.abs(D-X.y)>m)&&U(!0);const M=u.width-f.current.offsetWidth,O=u.height-f.current.offsetHeight,w=5,R=Math.round(g/w)*w,E=Math.round(D/w)*w,C=Math.max(0,Math.min(R,M)),b=Math.max(0,Math.min(E,O));L({x:C,y:b});const x=C/u.width,N=b/u.height;r({position:{x,y:N}})})}},V=o=>{const u=Date.now()-fe<200&&!A;z(!1),document.body.style.cursor="",u&&t&&setTimeout(()=>{y(!0),setTimeout(()=>{h.current&&(h.current.focus(),h.current.select())},0)},50)},me=o=>{o.preventDefault(),o.stopPropagation(),he({x:o.clientX,y:o.clientY}),S(!0)},Ce=()=>{const o={...JSON.parse(JSON.stringify(e)),id:`text-${Date.now()}`,position:{x:e.position.x<=1?Math.min(e.position.x+.02,.9):e.position.x+10,y:e.position.y<=1?Math.min(e.position.y+.02,.9):e.position.y+10}};r(o,!0),S(!1)};s.useEffect(()=>(p&&(window.addEventListener("mousemove",B),window.addEventListener("mouseup",V)),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",V)}),[p,k]);const be=s.useCallback(o=>{f.current=o,P(o)},[P]),Ie=(J=e.style)!=null&&J.textShadow?`${e.style.textShadowX||0}px ${e.style.textShadowY||0}px ${e.style.textShadowBlur||0}px ${e.style.textShadowColor||"rgba(0,0,0,0.5)"}`:"none",Pe=(()=>{var l,u,g,D,m,M,O,w,R,E,C,b;const o={...e.style,position:"absolute",cursor:p?"grabbing":W&&!d?"grab":"pointer",textShadow:Ie,zIndex:e.zIndex||10,fontFamily:((l=e.style)==null?void 0:l.fontFamily)||"Arial",color:((u=e.style)==null?void 0:u.color)||"#000000",fontWeight:((g=e.style)==null?void 0:g.fontWeight)||"normal",fontStyle:((D=e.style)==null?void 0:D.fontStyle)||"normal",textDecoration:((m=e.style)==null?void 0:m.textDecoration)||"none",textAlign:((M=e.style)==null?void 0:M.textAlign)||"left",backgroundColor:((O=e.style)==null?void 0:O.backgroundColor)||"transparent",padding:((w=e.style)==null?void 0:w.padding)||"8px",borderRadius:((R=e.style)==null?void 0:R.borderRadius)||"0px",border:((E=e.style)==null?void 0:E.border)||"none",opacity:((C=e.style)==null?void 0:C.opacity)!==void 0?e.style.opacity:1,transition:p?"none":"all 0.15s ease-out",willChange:p?"transform":"auto",transform:p?"scale(1.02)":"scale(1)"};if(e.position.x<=1&&e.position.y<=1?(o.left=`${e.position.x*100}%`,o.top=`${e.position.y*100}%`):(o.left=`${e.position.x}px`,o.top=`${e.position.y}px`),(b=e.style)!=null&&b.fontSize){const x=parseFloat(e.style.fontSize);if(x&&a.width){const N=x/800*a.width;o.fontSize=`${Math.max(12,N)}px`}else o.fontSize=e.style.fontSize}else{const x=.02*a.width;o.fontSize=`${Math.max(12,x)}px`}return o})();return s.useEffect(()=>{var l,u;const o=(u=(l=e.style)==null?void 0:l.fontFamily)==null?void 0:u.replace(/'/g,"");if(o&&!document.fonts.check(`12px ${o}`)){const g=new FontFace(o,`local(${o})`);g.load().then(()=>document.fonts.add(g))}},[(K=e.style)==null?void 0:K.fontFamily]),c.jsxs("div",{ref:be,"data-element-type":"text","data-element-id":e.id,className:`
                ${t?"ring-2 ring-purple-500 shadow-lg":""} 
                ${T?"opacity-50":"opacity-100"}
                ${p?"ring-2 ring-blue-400 shadow-xl select-none":""}
                ${W&&!d?"ring-1 ring-gray-300":""}
                transition-all duration-150 ease-in-out
            `,style:{...Pe,userSelect:p?"none":"auto",pointerEvents:p?"none":"auto"},onClick:o=>{o.stopPropagation(),t||n()},onMouseDown:De,onContextMenu:me,onMouseEnter:()=>q(!0),onMouseLeave:()=>q(!1),children:[d?c.jsx("input",{ref:h,type:"text",value:e.content,onChange:ve,onBlur:xe,onKeyDown:Se,className:"w-full p-1 border border-gray-300 rounded bg-white",style:{fontFamily:(Q=e.style)==null?void 0:Q.fontFamily,fontSize:(_=e.style)==null?void 0:_.fontSize,fontWeight:(G=e.style)==null?void 0:G.fontWeight,fontStyle:(Z=e.style)==null?void 0:Z.fontStyle,textDecoration:(ee=e.style)==null?void 0:ee.textDecoration,color:(te=e.style)==null?void 0:te.color,textAlign:(ne=e.style)==null?void 0:ne.textAlign,minWidth:"100px"},autoFocus:!0}):c.jsx("div",{className:"p-2 rounded",style:{backgroundColor:((re=e.style)==null?void 0:re.backgroundColor)||"transparent",padding:((oe=e.style)==null?void 0:oe.padding)||"8px",borderRadius:((ie=e.style)==null?void 0:ie.borderRadius)||"0px",border:((se=e.style)==null?void 0:se.border)||"none",fontFamily:((ae=e.style)==null?void 0:ae.fontFamily)||"Arial"},children:e.content||"Editar texto"}),t&&c.jsx(c.Fragment,{children:c.jsx("div",{className:"absolute top-0 left-0 transform translate-x-[-100%] translate-y-[-100%] bg-white rounded-md p-1 shadow-sm border",style:{zIndex:9999},children:c.jsx(ke,{className:"h-3 w-3 text-gray-500"})})}),ge&&c.jsxs("div",{className:"fixed bg-white shadow-lg rounded-md py-1 w-48",style:{left:`${Y.x}px`,top:`${Y.y}px`,zIndex:9999},onClick:o=>o.stopPropagation(),children:[c.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{y(!0),S(!1)},children:[c.jsx(Ne,{className:"h-4 w-4"}),"Editar texto"]}),c.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:Ce,children:[c.jsx(Re,{className:"h-4 w-4"}),"Duplicar"]}),c.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{var o;r({style:{...e.style,opacity:Math.max(0,(((o=e.style)==null?void 0:o.opacity)||1)-.1)}}),S(!1)},children:[c.jsx(Te,{className:"h-4 w-4"}),"Reducir opacidad"]}),c.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{i(),S(!1)},children:[c.jsx(Ee,{className:"h-4 w-4"}),"Eliminar"]})]})]})}export{Te as C,He as D,Ne as T,ue as a,I as b,Ye as c,ze as d,tt as e,ht as f,lt as g,v as i,gt as l,dt as r,ce as s,j as u,Be as w};
