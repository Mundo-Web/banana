import{j as a}from"./AboutSimple-Cf8x2fCZ.js";import{r as c}from"./index-BH53Isel.js";import{I as L}from"./ItemsRest-CNHS84XX.js";import{S as i}from"./ProductCard-Ap6bpF1Q.js";import"./main-BvVILmTO.js";import"./BlogCarousel-CCgb3gK1.js";/* empty css               */import"./InfiniteCategory-BtlY-czj.js";import"./ProductMakita-Dhf5p5Ee.js";import"./ProductNavigation-WCvq3FtO.js";import{C as z}from"./HeaderSearch-DQabzt5o.js";import{i as N}from"./tippy-react.esm-GxPckcbS.js";/* empty css              */import D from"./ProductBananaLab-CxZGgUGo.js";import"./lodash-CblvOeJM.js";import{m as t}from"./proxy-BTYtmp9V.js";import{B as U}from"./brush-CV0tCVRD.js";import{H as K}from"./heart-ChuvJi-4.js";import"./index-yBjzXJbu.js";import"./BasicRest-b6WIUDlY.js";import"./index-Bx7_DjT0.js";import"./index-BrXtjC9y.js";import"./index-fNjTmf9T.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./eye-CKCH9ORv.js";import"./createLucideIcon-Cy5Ya80P.js";import"./PaymentModal-Bxx5p2o_.js";import"./index-Chjiymov.js";import"./CartItemRow-CuPy688Q.js";import"./Number2Currency-e57Tgsuk.js";import"./trash-2-DK1wnsDn.js";import"./minus-jyhodMPN.js";import"./plus-Bot15Khs.js";import"./index-CFtDjG4d.js";import"./CardProductBananaLab-C9n3gEQ_.js";import"./HeaderBananaLab-VQufZmAm.js";import"./shopping-bag-CoWGrL8C.js";import"./x-DBMwyD6F.js";import"./shopping-cart-CZEUxbmv.js";import"./arrow-right-DR00rP9v.js";import"./circle-check-big-D6DM3vPb.js";function Oe({session:k,item:e,data:J,setCart:u,cart:d,setFavorites:C,favorites:E}){var b,j,w,y;const x=new L,[S,_]=c.useState(!1),[p,g]=c.useState({url:e==null?void 0:e.image,type:"main"}),[f,I]=c.useState(1),$=s=>{let r=parseInt(s.target.value,10);(isNaN(r)||r<1)&&(r=1),r>10&&(r=10),I(r)},[T,Q]=c.useState(!1),[H,F]=c.useState([]),[m,P]=c.useState([]),[v,B]=c.useState([]);d==null||d.find(s=>s.id==(e==null?void 0:e.id)),c.useEffect(()=>{e!=null&&e.id&&(A(e),q(e),R(e),M(e))},[e]);const O={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.5}}},l={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5}}},h={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},R=async s=>{try{const r={id:s==null?void 0:s.id};if(!await x.updateViews(r))return}catch{return}},q=async s=>{try{const r={id:s==null?void 0:s.id},o=await x.verifyCombo(r);if(!o)return;const n=o[0].associated_items;F(Object.values(n))}catch{return}},A=async s=>{try{const r={id:s==null?void 0:s.id},o=await x.productsRelations(r);if(!o)return;P(Object.values(o))}catch{return}},M=async s=>{try{const r={slug:s==null?void 0:s.slug},o=await x.getVariations(r);if(!o)return;B(o.variants)}catch{return}};H.reduce((s,r)=>s+parseFloat(r.final_price),0);const V=s=>{const r=structuredClone(d),o=r.findIndex(n=>n.id==s.id);o==-1?r.push({...s,quantity:f}):r[o].quantity++,u(r),i.fire({title:"Producto agregado",text:`Se agreg√≥ ${s.name} al carrito`,icon:"success",timer:1500})};return a.jsxs(t.div,{initial:"hidden",animate:"visible",variants:O,className:"px-primary mx-auto py-4 md:py-6 xl:py-8 bg-white font-paragraph",children:[a.jsx(t.div,{variants:l,className:"bg-white rounded-xl p-4 md:p-8",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 xl:gap-20 2xl:gap-32",children:[a.jsx("div",{className:"space-y-6",children:a.jsxs(t.div,{variants:h,className:"flex flex-col gap-6",children:[a.jsx(t.div,{variants:l,className:"flex-1",children:a.jsx(t.img,{src:p.type==="main"?`/storage/images/item/${p.url}`:`/storage/images/item/${p.url}`,onError:s=>s.target.src="/api/cover/thumbnail/null",alt:"Product main",className:"w-full h-auto object-contain",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400,damping:10}})}),a.jsxs(t.div,{variants:l,className:"flex flex-row gap-2",children:[a.jsx(t.button,{onClick:()=>g({url:e==null?void 0:e.image,type:"main"}),whileHover:{scale:1.05},whileTap:{scale:.95},className:`w-16 h-16 rounded-lg p-1 border-2 ${p.url===(e==null?void 0:e.image)?"border-primary ":"border-gray-200"}`,children:a.jsx("img",{src:`/storage/images/item/${e==null?void 0:e.image}`,alt:"Main Thumbnail",className:"w-full h-full object-cover",onError:s=>s.target.src="/api/cover/thumbnail/null"})}),e==null?void 0:e.images.map((s,r)=>a.jsx(t.button,{onClick:()=>g({url:s.url,type:"gallery"}),whileHover:{scale:1.05},whileTap:{scale:.95},className:`w-16 h-16 border-2 rounded-lg p-1 ${p.url===s.url?"border-primary":"border-gray-200"}`,children:a.jsx("img",{src:`/storage/images/item/${s.url}`||"/api/cover/thumbnail/null",alt:`Thumbnail ${r+1}`,className:"w-full h-full object-cover",onError:o=>o.target.src="/api/cover/thumbnail/null"})},r))]})]})}),a.jsxs(t.div,{variants:h,className:"flex flex-col gap-2",children:[a.jsxs(t.div,{variants:l,className:"font-font-general",children:[(e==null?void 0:e.brand)&&a.jsxs("p",{className:"customtext-neutral-light text-sm 2xl:text-lg",children:["Marca:"," ",a.jsx("span",{className:"customtext-neutral-dark",children:e==null?void 0:e.brand.name})]}),a.jsx(t.h1,{className:"customtext-neutral-dark text-3xl lg:text-4xl 2xl:text-5xl font-bold mt-2",whileHover:{x:5},children:e==null?void 0:e.name})]}),a.jsxs(t.div,{variants:l,className:"flex flex-wrap customtext-neutral-light items-center gap-y-2 gap-x-8 text-sm font-font-general",children:[a.jsxs("span",{className:"customtext-neutral-light text-sm 2xl:text-base",children:["SKU:"," ",a.jsx("span",{className:"customtext-neutral-dark font-bold",children:e==null?void 0:e.sku})]}),a.jsxs("span",{className:"customtext-neutral-light text-sm 2xl:text-base",children:["Disponibilidad:"," ",a.jsx("span",{className:"customtext-neutral-dark font-bold",children:(e==null?void 0:e.stock)>0?"En stock":"Agotado"})]})]}),a.jsxs(t.div,{variants:l,className:"flex flex-col w-full xl:w-1/2 !font-font-general max-w-xl mt-5",children:[a.jsxs("p",{className:"text-sm 2xl:text-base customtext-neutral-light",children:["Precio:"," ",a.jsxs("span",{className:"line-through",children:["S/ ",e==null?void 0:e.price]})]}),a.jsxs("div",{className:"flex flex-row items-center gap-4 relative",children:[a.jsxs(t.span,{className:"text-[40px] font-bold customtext-neutral-dark",whileHover:{scale:1.05},children:["S/ ",e==null?void 0:e.final_price]}),a.jsxs(t.span,{className:"bg-[#F93232] text-white font-bold px-3 py-2 rounded-xl text-base",whileHover:{scale:1.1},whileTap:{scale:.9},children:["-",Number(e==null?void 0:e.discount_percent).toFixed(1),"%"]})]})]}),a.jsxs(t.div,{variants:l,className:"variants-selector flex flex-col gap-3",children:[a.jsx("h3",{className:"w-full block opacity-85 customtext-neutral-dark text-sm 2xl:text-base",children:"Colores"}),a.jsxs("div",{className:"flex gap-3 items-center justify-start w-full flex-wrap",children:[a.jsx(N,{content:e.color,children:a.jsx(t.a,{whileHover:{scale:1.1},whileTap:{scale:.9},className:`variant-option rounded-full object-fit-cover ${v.some(s=>s.slug===e.slug)?"":"active p-[2px] border-[1.5px] border-neutral-dark"}`,children:a.jsx("img",{className:"color-box rounded-full h-9 w-9 object-fit-cover",src:`/storage/images/item/${e.texture}`,onError:s=>s.target.src="/api/cover/thumbnail/null"})})}),v.map(s=>a.jsx(N,{content:s.color,children:a.jsx(t.a,{href:`/product/${s.slug}`,className:"variant-option rounded-full object-fit-cover",whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx("img",{className:"color-box rounded-full h-9 w-9 object-fit-cover",src:`/storage/images/item/${s.texture}`})})},s.slug))]})]}),a.jsx(t.div,{variants:l,className:"flex flex-col mt-8",children:a.jsx("div",{className:"flex items-center gap-4 mb-2",children:a.jsxs("div",{className:"flex items-center space-x-4 customtext-neutral-light text-sm 2xl:text-base",children:[a.jsx("span",{className:"opacity-85",children:"Cantidad"}),a.jsx(t.div,{className:"relative flex items-center border rounded-md px-2 py-1",whileHover:{scale:1.05},children:a.jsx("input",{type:"number",value:f,onChange:$,min:"1",max:"10",className:"w-10 py-1 customtext-neutral-dark text-center bg-transparent outline-none appearance-none"})})]})})}),a.jsxs(t.div,{variants:l,className:"flex flex-col",children:[a.jsxs(t.button,{onClick:async()=>{if(!k)i.fire({icon:"info",title:"Inicia sesi√≥n",text:"Necesitas iniciar sesi√≥n para usar el editor de dise√±o",confirmButtonText:"Iniciar sesi√≥n",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&(window.location.href="/login")});else{if(!e.canvas_preset_id){i.fire({icon:"warning",title:"Producto no compatible",text:"Este producto no tiene editor de dise√±o disponible."});return}try{i.fire({title:"Creando proyecto...",text:"Preparando tu editor personalizado",allowOutsideClick:!1,didOpen:()=>{i.showLoading()}});const s=document.querySelector('meta[name="csrf-token"]');if(!s)throw new Error("CSRF token no encontrado");console.log("üì¶ Enviando datos:",{item_id:e.id,canvas_preset_id:e.canvas_preset_id,name:`Proyecto ${e.name}`});const r=await fetch("/api/canvas/create-project",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":s.content},credentials:"same-origin",body:JSON.stringify({item_id:e.id,canvas_preset_id:e.canvas_preset_id,name:`Proyecto ${e.name}`})});if(console.log("üì° Respuesta del servidor:",r.status,r.statusText),r.ok){const o=await r.json();console.log("‚úÖ Proyecto creado exitosamente:",o),i.close(),window.location.href=`/canvas/editor?project=${o.id}`}else{let o="Error al crear el proyecto";try{const n=await r.json();o=n.error||n.message||o,console.error("‚ùå Error del servidor:",n)}catch(n){console.error("‚ùå Error al parsear respuesta de error:",n)}throw new Error(`${o} (C√≥digo: ${r.status})`)}}catch(s){console.error("‚ùå Error completo:",s),i.fire({icon:"error",title:"Error",text:s.message||"No se pudo crear el proyecto. Int√©ntalo de nuevo.",footer:"Si el problema persiste, contacta con soporte."})}}},className:"w-full flex gap-4 items-center justify-center font-paragraph text-base 2xl:text-lg bg-primary text-white py-3 font-semibold rounded-3xl hover:opacity-90 transition-all duration-300 mt-3",whileHover:{scale:1.02},whileTap:{scale:.98},children:["Crea y edita tu regalo",a.jsx(U,{width:20})]}),a.jsxs(t.button,{onClick:()=>{V(e)},className:"w-full flex gap-4 items-center justify-center font-paragraph text-base 2xl:text-lg bg-white border-2 border-primary customtext-primary py-3 font-semibold rounded-3xl hover:opacity-90 transition-all duration-300 mt-3",whileHover:{scale:1.02},whileTap:{scale:.98},children:["Lista de deseos",a.jsx(K,{width:20})]})]}),a.jsx(t.div,{variants:l,className:"w-full mt-5",children:a.jsxs(t.div,{className:"bg-[#F7F9FB] flex flex-row rounded-xl p-5 gap-3",whileHover:{y:-2},children:[a.jsx("img",{src:"/assets/img/salafabulosa/whatsapp.png",onError:s=>s.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-12 h-12 object-contain",loading:"lazy"}),a.jsx("div",{className:"customtext-neutral-dark font-font-general text-base 2xl:text-xl font-semibold",children:a.jsxs("p",{children:["¬øTienes dudas sobre este producto? Haz"," ",a.jsx("span",{className:"underline",children:"clic aqu√≠"})," ","y chatea con nosotros por WhatsApp"]})})]})})]})]})}),a.jsxs(t.div,{variants:l,className:"grid gap-10 lg:gap-20 md:grid-cols-2 bg-white rounded-xl p-4 sm:p-8 font-font-general",children:[((b=e==null?void 0:e.specifications)==null?void 0:b.length)>0&&a.jsxs(t.div,{variants:l,children:[a.jsx("h2",{className:"text-2xl font-bold customtext-neutral-dark mb-4 border-b pb-3",children:"Especificaciones"}),a.jsx("div",{className:"space-y-1",children:e.specifications.map((s,r)=>s.type==="general"&&a.jsxs(t.div,{className:`grid grid-cols-2 gap-4 p-3 ${r%2===0?"bg-[#F7F9FB]":"bg-white"}`,whileHover:{x:5},children:[a.jsx("div",{className:"customtext-neutral-light opacity-85",children:s.title}),a.jsx("div",{className:"customtext-neutral-dark",children:s.description})]},r))})]}),a.jsxs(t.div,{variants:l,className:"font-font-general",children:[((j=e==null?void 0:e.description)==null?void 0:j.replace(/<[^>]+>/g,""))&&a.jsx("h2",{className:"text-2xl font-bold customtext-neutral-dark mb-4 border-b pb-3",children:"Informaci√≥n adicional"}),a.jsxs(t.div,{className:`space-y-2 ${T?"":"max-h-[400px] overflow-hidden"}`,children:[((w=e==null?void 0:e.description)==null?void 0:w.replace(/<[^>]+>/g,""))&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xl font-semibold customtext-neutral-dark mb-4",children:"Acerca de este art√≠culo"}),a.jsx(t.div,{className:"customtext-neutral-dark",dangerouslySetInnerHTML:{__html:e==null?void 0:e.description},initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}})]}),((y=e==null?void 0:e.features)==null?void 0:y.length)>0&&a.jsx(t.div,{className:"pl-10",variants:h,children:a.jsx("ul",{className:"list-disc pl-5 space-y-2",children:e==null?void 0:e.features.map((s,r)=>a.jsx(t.li,{className:"customtext-neutral-dark",variants:l,children:s.feature},r))})})]})]})]}),m.length>0&&a.jsx(t.div,{className:"my-10",initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},children:a.jsx(D,{data:{title:"Productos relacionados",link_catalog:"/catalogo"},items:m,cart:d,setCart:u,setFavorites:C,favorites:E})}),a.jsx(z,{cart:d,setCart:u,modalOpen:S,setModalOpen:_})]})}export{Oe as default};
